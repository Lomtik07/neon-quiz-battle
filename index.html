<!DOCTYPE html>
<html lang="ru">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Neon Quiz Battle - Онлайн</title>
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css">
    <!-- Firebase SDK -->
    console.log("Используется локальная версия без Firebase");
    window.firebase = {
    initializeApp: function() { 
        console.log("Firebase отключен, используется локальная база");
        return {
            database: function() {
                return {
                    ref: function() {
                        return {
                            set: function(data) { 
                                console.log("Данные сохранены локально");
                                return Promise.resolve();
                            },
                            update: function(data) { 
                                return Promise.resolve();
                            },
                            once: function() {
                                return Promise.resolve({ val: function() { return null; } });
                            },
                            on: function() { /* заглушка */ },
                            remove: function() { return Promise.resolve(); }
                        };
                    }
                };
            },
            auth: function() {
                return {
                    onAuthStateChanged: function(callback) { 
                        // Ничего не делаем
                    },
                    signInWithEmailAndPassword: function() {
                        return Promise.reject(new Error("Firebase отключен"));
                    },
                    createUserWithEmailAndPassword: function() {
                        return Promise.reject(new Error("Firebase отключен"));
                    },
                    signOut: function() {
                        return Promise.resolve();
                    }
                };
            }
        };
    }
};

// Загружаем локальную базу
loadDB();
    <style>
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
            font-family: 'Arial', sans-serif;
        }

        body {
            background: linear-gradient(135deg, #0a0a0a 0%, #1a1a2e 100%);
            color: #fff;
            min-height: 100vh;
            overflow-x: hidden;
        }

        .container {
            max-width: 1200px;
            margin: 0 auto;
            padding: 20px;
        }

        header {
            text-align: center;
            padding: 30px 0;
            border-bottom: 2px solid #00f3ff;
            margin-bottom: 30px;
            position: relative;
        }

        h1 {
            font-size: 3.5rem;
            background: linear-gradient(90deg, #ff00ff, #00f3ff, #ff00ff);
            background-size: 200% auto;
            -webkit-background-clip: text;
            -webkit-text-fill-color: transparent;
            animation: neonGlow 3s linear infinite;
            text-shadow: 0 0 15px rgba(255, 0, 255, 0.7);
            letter-spacing: 2px;
        }

        @keyframes neonGlow {
            0% { background-position: 0% center; }
            100% { background-position: 200% center; }
        }

        .room-controls {
            display: flex;
            gap: 15px;
            justify-content: center;
            margin: 20px 0;
            flex-wrap: wrap;
        }

        .room-input {
            padding: 12px 20px;
            background: rgba(0, 0, 30, 0.8);
            border: 2px solid #00f3ff;
            border-radius: 10px;
            color: white;
            font-size: 1rem;
            width: 300px;
            max-width: 100%;
        }

        .room-btn {
            padding: 12px 30px;
            background: linear-gradient(90deg, #ff00ff, #00f3ff);
            border: none;
            border-radius: 10px;
            color: black;
            font-weight: bold;
            cursor: pointer;
            transition: all 0.3s;
            font-size: 1rem;
        }

        .room-btn:hover {
            transform: scale(1.05);
            box-shadow: 0 0 15px #ff00ff;
        }

        .room-code-display {
            background: rgba(0, 20, 40, 0.9);
            border: 2px solid #00ff9d;
            border-radius: 10px;
            padding: 15px;
            margin: 20px auto;
            text-align: center;
            max-width: 500px;
            display: none;
        }

        .code {
            font-size: 2.5rem;
            font-weight: bold;
            color: #00ff9d;
            letter-spacing: 10px;
            margin: 10px 0;
            text-shadow: 0 0 10px #00ff9d;
        }

        .share-buttons {
            display: flex;
            gap: 10px;
            justify-content: center;
            margin-top: 15px;
        }

        .share-btn {
            padding: 10px 20px;
            background: rgba(0, 0, 30, 0.8);
            border: 1px solid #ff00ff;
            border-radius: 8px;
            color: white;
            cursor: pointer;
            transition: all 0.3s;
        }

        .share-btn:hover {
            background: #ff00ff;
            color: black;
        }

        .status-bar {
            display: flex;
            justify-content: space-between;
            background: rgba(0, 0, 30, 0.7);
            border: 1px solid #00f3ff;
            border-radius: 10px;
            padding: 15px;
            margin-bottom: 20px;
            box-shadow: 0 0 15px rgba(0, 243, 255, 0.3);
        }

        .player-count, .game-status, .topic, .room-info {
            font-size: 1.2rem;
        }

        .highlight {
            color: #ff00ff;
            font-weight: bold;
            text-shadow: 0 0 10px #ff00ff;
        }

        .main-content {
            display: flex;
            gap: 20px;
            flex-wrap: wrap;
        }

        .left-panel, .right-panel {
            flex: 1;
            min-width: 300px;
            background: rgba(20, 20, 40, 0.8);
            border-radius: 15px;
            border: 1px solid #ff00ff;
            padding: 20px;
            box-shadow: 0 0 20px rgba(255, 0, 255, 0.2);
        }

        .panel-title {
            color: #00f3ff;
            margin-bottom: 15px;
            font-size: 1.5rem;
            text-align: center;
            border-bottom: 1px solid #00f3ff;
            padding-bottom: 10px;
        }

        .player-list {
            list-style: none;
            margin-top: 15px;
        }

        .player-item {
            display: flex;
            align-items: center;
            padding: 10px;
            margin-bottom: 10px;
            background: rgba(0, 243, 255, 0.1);
            border-radius: 8px;
            border-left: 4px solid #ff00ff;
            position: relative;
        }

        .player-icon {
            margin-right: 10px;
            color: #ff00ff;
        }

        .player-score {
            margin-left: auto;
            color: #00ff9d;
            font-weight: bold;
            margin-right: 10px;
        }

        .host-badge {
            background: #ff00ff;
            color: black;
            padding: 2px 8px;
            border-radius: 12px;
            font-size: 0.8rem;
            margin-left: 10px;
            font-weight: bold;
        }

        .kick-btn {
            background: rgba(255, 0, 0, 0.3);
            color: white;
            border: 1px solid #ff0000;
            border-radius: 5px;
            padding: 3px 8px;
            font-size: 0.8rem;
            cursor: pointer;
            margin-left: 5px;
            display: none;
        }

        .kick-btn:hover {
            background: rgba(255, 0, 0, 0.7);
        }

        .join-form {
            display: flex;
            flex-direction: column;
            gap: 15px;
            margin-top: 20px;
        }

        input, select, button {
            padding: 12px;
            border-radius: 8px;
            border: none;
            font-size: 1rem;
        }

        input, select {
            background: rgba(0, 0, 20, 0.8);
            color: white;
            border: 1px solid #00f3ff;
        }

        button:disabled {
            opacity: 0.5;
            cursor: not-allowed;
        }

        button:disabled:hover {
            transform: none;
            box-shadow: none;
        }

        .game-area {
            display: none;
            margin-top: 20px;
        }

        .question-box {
            background: rgba(0, 10, 30, 0.9);
            border-radius: 15px;
            padding: 25px;
            border: 2px solid #00f3ff;
            margin-bottom: 25px;
            box-shadow: 0 0 20px rgba(0, 243, 255, 0.4);
        }

        .question-text {
            font-size: 1.4rem;
            margin-bottom: 20px;
            line-height: 1.5;
            color: #ffffff;
        }

        .options-grid {
            display: grid;
            grid-template-columns: repeat(2, 1fr);
            gap: 15px;
            margin-top: 20px;
        }

        @media (max-width: 768px) {
            .options-grid {
                grid-template-columns: 1fr;
            }
        }

        .option {
            background: rgba(20, 20, 50, 0.8);
            padding: 15px;
            border-radius: 10px;
            cursor: pointer;
            transition: all 0.3s;
            border: 1px solid transparent;
            text-align: center;
            font-size: 1.1rem;
        }

        .option:hover:not(.disabled) {
            transform: translateY(-5px);
            border-color: #ff00ff;
            box-shadow: 0 5px 15px rgba(255, 0, 255, 0.4);
        }

        .option.disabled {
            cursor: not-allowed;
            opacity: 0.7;
        }

        .option.correct {
            background: rgba(0, 255, 157, 0.3);
            border-color: #00ff9d;
        }

        .option.incorrect {
            background: rgba(255, 0, 0, 0.3);
            border-color: #ff0000;
        }

        .timer {
            text-align: center;
            font-size: 1.8rem;
            color: #ff00ff;
            margin: 20px 0;
            font-weight: bold;
        }

        .results {
            display: none;
            text-align: center;
            padding: 20px;
            background: rgba(0, 20, 40, 0.9);
            border-radius: 15px;
            border: 2px solid #00ff9d;
            margin-top: 20px;
        }

        .correct-answer-box {
            background: rgba(0, 255, 157, 0.1);
            border: 2px solid #00ff9d;
            border-radius: 10px;
            padding: 15px;
            margin: 15px 0;
        }

        .correct-answer-text {
            color: #00ff9d;
            font-size: 1.3rem;
            margin: 10px 0;
            text-shadow: 0 0 10px #00ff9d;
        }

        .answer-stats {
            display: flex;
            justify-content: space-around;
            margin: 15px 0;
            padding: 10px;
            background: rgba(0, 0, 30, 0.5);
            border-radius: 10px;
        }

        .stat-item {
            text-align: center;
        }

        .stat-value {
            font-size: 1.5rem;
            font-weight: bold;
            color: #ff00ff;
        }

        .stat-label {
            font-size: 0.9rem;
            color: #aaa;
        }

        .scoreboard {
            margin-top: 20px;
        }

        .theme-selector {
            display: flex;
            flex-wrap: wrap;
            gap: 10px;
            margin-top: 15px;
            justify-content: center;
        }

        .theme-btn {
            padding: 8px 15px;
            border-radius: 20px;
            background: rgba(0, 0, 30, 0.8);
            border: 1px solid #ff00ff;
            color: white;
            cursor: pointer;
            transition: all 0.3s;
        }

        .theme-btn:hover {
            background: #ff00ff;
            color: black;
        }

        .active-theme {
            background: #ff00ff;
            color: black;
            font-weight: bold;
        }

        .notification {
            position: fixed;
            top: 20px;
            right: 20px;
            background: rgba(0, 20, 40, 0.95);
            border: 2px solid #00f3ff;
            border-radius: 10px;
            padding: 15px;
            display: none;
            z-index: 100;
            max-width: 300px;
            box-shadow: 0 0 20px rgba(0, 243, 255, 0.7);
        }

        .chat-container {
            margin-top: 20px;
            max-height: 300px;
            overflow-y: auto;
        }

        .chat-messages {
            height: 200px;
            overflow-y: auto;
            padding: 10px;
            background: rgba(0, 0, 20, 0.8);
            border-radius: 10px;
            margin-bottom: 10px;
            border: 1px solid #00f3ff;
        }

        .chat-input {
            display: flex;
            gap: 10px;
        }

        .message {
            padding: 8px;
            margin-bottom: 5px;
            border-radius: 8px;
            background: rgba(0, 243, 255, 0.1);
            border-left: 3px solid #ff00ff;
        }

        .message-sender {
            color: #ff00ff;
            font-weight: bold;
        }

        footer {
            text-align: center;
            margin-top: 30px;
            padding-top: 20px;
            border-top: 1px solid #00f3ff;
            color: #aaa;
            font-size: 0.9rem;
        }

        .pulse {
            animation: pulse 1.5s infinite;
        }

        @keyframes pulse {
            0% { opacity: 1; }
            50% { opacity: 0.6; }
            100% { opacity: 1; }
        }

        .loader {
            display: inline-block;
            width: 20px;
            height: 20px;
            border: 3px solid #ff00ff;
            border-radius: 50%;
            border-top-color: transparent;
            animation: spin 1s linear infinite;
            margin-right: 10px;
        }

        @keyframes spin {
            to { transform: rotate(360deg); }
        }

        .waiting-players {
            text-align: center;
            padding: 30px;
            color: #aaa;
        }

        .end-game-results {
            display: none;
            text-align: center;
            padding: 30px;
            background: rgba(0, 10, 30, 0.95);
            border-radius: 15px;
            border: 2px solid #ff00ff;
            margin-top: 20px;
        }

        .final-winner {
            color: #ff00ff;
            font-size: 2.5rem;
            margin: 20px 0;
            text-shadow: 0 0 15px #ff00ff;
        }

        .trophy-icon {
            font-size: 4rem;
            color: gold;
            margin: 20px 0;
        }

        .control-buttons {
            display: flex;
            gap: 10px;
            justify-content: center;
            margin-top: 20px;
        }

        .correct-players-list {
            margin-top: 10px;
            padding: 10px;
            background: rgba(0, 255, 157, 0.1);
            border-radius: 8px;
        }

        .correct-player {
            color: #00ff9d;
            margin: 5px 0;
        }

        /* Стили для авторизации и создания опросов */
        .auth-container {
            display: none;
            flex-direction: column;
            align-items: center;
            justify-content: center;
            padding: 40px;
            background: rgba(20, 20, 40, 0.9);
            border-radius: 15px;
            border: 2px solid #ff00ff;
            max-width: 500px;
            margin: 50px auto;
            box-shadow: 0 0 30px rgba(255, 0, 255, 0.3);
        }

        .auth-title {
            color: #00f3ff;
            font-size: 2rem;
            margin-bottom: 20px;
            text-align: center;
        }

        .auth-buttons {
            display: flex;
            flex-direction: column;
            gap: 15px;
            width: 100%;
            margin-top: 20px;
        }

        .auth-btn {
            padding: 15px;
            border-radius: 10px;
            border: 2px solid #00f3ff;
            background: rgba(0, 0, 30, 0.8);
            color: white;
            font-size: 1.1rem;
            cursor: pointer;
            transition: all 0.3s;
            display: flex;
            align-items: center;
            justify-content: center;
            gap: 10px;
        }

        .auth-btn:hover {
            background: linear-gradient(90deg, #ff00ff, #00f3ff);
            color: black;
            transform: scale(1.05);
        }

        .auth-input {
            width: 100%;
            padding: 12px;
            margin: 10px 0;
            background: rgba(0, 0, 20, 0.8);
            border: 2px solid #00f3ff;
            border-radius: 8px;
            color: white;
            font-size: 1rem;
        }

        .user-profile {
            display: none;
            align-items: center;
            gap: 10px;
            position: absolute;
            top: 20px;
            right: 20px;
            background: rgba(0, 20, 40, 0.9);
            padding: 10px 15px;
            border-radius: 10px;
            border: 2px solid #00ff9d;
        }

        .user-avatar {
            width: 40px;
            height: 40px;
            border-radius: 50%;
            border: 2px solid #ff00ff;
        }

        .user-name {
            color: white;
            font-weight: bold;
        }

        .logout-btn {
            background: rgba(255, 0, 0, 0.3);
            color: white;
            border: 1px solid #ff0000;
            border-radius: 5px;
            padding: 5px 10px;
            cursor: pointer;
            margin-left: 10px;
        }

        .logout-btn:hover {
            background: rgba(255, 0, 0, 0.7);
        }

        .create-quiz-btn {
            display: none;
            position: absolute;
            top: 20px;
            left: 20px;
            background: linear-gradient(90deg, #ff00ff, #00f3ff);
            color: black;
            padding: 10px 20px;
            border-radius: 10px;
            font-weight: bold;
            cursor: pointer;
            border: none;
            z-index: 100;
        }

        .create-quiz-btn:hover {
            transform: scale(1.05);
            box-shadow: 0 0 15px #ff00ff;
        }

        .quiz-creator-modal {
            display: none;
            position: fixed;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            background: rgba(0, 0, 0, 0.9);
            z-index: 1000;
            overflow-y: auto;
            padding: 20px;
        }

        .quiz-creator-content {
            max-width: 800px;
            margin: 50px auto;
            background: rgba(20, 20, 40, 0.95);
            border-radius: 15px;
            border: 2px solid #00f3ff;
            padding: 30px;
            box-shadow: 0 0 40px rgba(0, 243, 255, 0.5);
        }

        .quiz-form {
            display: flex;
            flex-direction: column;
            gap: 20px;
        }

        .form-group {
            margin-bottom: 15px;
        }

        .form-label {
            color: #00f3ff;
            margin-bottom: 5px;
            display: block;
            font-weight: bold;
        }

        .question-item {
            background: rgba(0, 0, 30, 0.8);
            border: 1px solid #ff00ff;
            border-radius: 10px;
            padding: 15px;
            margin-bottom: 15px;
            position: relative;
        }

        .remove-question-btn {
            position: absolute;
            top: 10px;
            right: 10px;
            background: rgba(255, 0, 0, 0.3);
            color: white;
            border: 1px solid #ff0000;
            border-radius: 5px;
            padding: 5px 10px;
            cursor: pointer;
        }

        .option-row {
            display: flex;
            align-items: center;
            gap: 10px;
            margin-bottom: 8px;
        }

        .correct-option {
            width: 20px;
            height: 20px;
            accent-color: #00ff9d;
        }

        .add-question-btn, .add-option-btn {
            background: rgba(0, 150, 255, 0.3);
            color: white;
            border: 1px solid #00aaff;
            border-radius: 5px;
            padding: 8px 15px;
            cursor: pointer;
            margin-top: 10px;
        }

        .add-question-btn:hover, .add-option-btn:hover {
            background: rgba(0, 150, 255, 0.7);
        }

        .quiz-preview {
            margin-top: 20px;
            padding: 20px;
            background: rgba(0, 10, 30, 0.8);
            border-radius: 10px;
            border: 1px solid #00ff9d;
        }

        .quiz-theme-selector {
            display: flex;
            gap: 10px;
            flex-wrap: wrap;
            margin-top: 10px;
        }

        .quiz-theme-btn {
            padding: 8px 15px;
            background: rgba(0, 0, 30, 0.8);
            border: 1px solid #ff00ff;
            color: white;
            border-radius: 20px;
            cursor: pointer;
        }

        .quiz-theme-btn.active {
            background: #ff00ff;
            color: black;
        }

        .user-quizzes-container {
            display: none;
            margin-top: 30px;
            padding: 20px;
            background: rgba(0, 10, 30, 0.9);
            border-radius: 15px;
            border: 2px solid #00ff9d;
        }

        .user-quizzes-list {
            display: grid;
            grid-template-columns: repeat(auto-fill, minmax(300px, 1fr));
            gap: 15px;
            margin-top: 20px;
        }

        .quiz-card {
            background: rgba(20, 20, 50, 0.8);
            border: 1px solid #ff00ff;
            border-radius: 10px;
            padding: 15px;
            transition: all 0.3s;
        }

        .quiz-card:hover {
            transform: translateY(-5px);
            box-shadow: 0 5px 15px rgba(255, 0, 255, 0.4);
        }

        .quiz-title {
            color: #00f3ff;
            font-size: 1.2rem;
            margin-bottom: 10px;
        }

        .quiz-stats {
            display: flex;
            justify-content: space-between;
            color: #aaa;
            font-size: 0.9rem;
            margin-top: 10px;
        }

        .quiz-actions {
            display: flex;
            gap: 10px;
            margin-top: 15px;
        }

        .quiz-action-btn {
            padding: 5px 10px;
            background: rgba(0, 0, 30, 0.8);
            border: 1px solid #00f3ff;
            color: white;
            border-radius: 5px;
            cursor: pointer;
            font-size: 0.9rem;
        }

        .quiz-action-btn:hover {
            background: #00f3ff;
            color: black;
        }

        /* Обновляем существующие стили */
        .room-controls {
            margin-top: 70px;
        }
    </style>
</head>
<body>
    <!-- Кнопка создания опроса -->
    <button id="createQuizBtn" class="create-quiz-btn" style="display: none;">
        <i class="fas fa-plus-circle"></i> СОЗДАТЬ ОПРОС
    </button>

    <!-- Профиль пользователя -->
    <div id="userProfile" class="user-profile" style="display: none;">
        <img id="userAvatar" class="user-avatar" src="" alt="Аватар">
        <div>
            <div class="user-name" id="userDisplayName"></div>
            <button id="logoutBtn" class="logout-btn">Выйти</button>
        </div>
    </div>

    <!-- Модальное окно создания опроса -->
    <div id="quizCreatorModal" class="quiz-creator-modal">
        <div class="quiz-creator-content">
            <h2 class="auth-title"><i class="fas fa-edit"></i> СОЗДАНИЕ ОПРОСА</h2>

            <div class="quiz-form">
                <div class="form-group">
                    <label class="form-label">Название опроса:</label>
                    <input type="text" id="quizTitle" class="auth-input" placeholder="Введите название опроса" maxlength="100">
                </div>

                <div class="form-group">
                    <label class="form-label">Тема:</label>
                    <div class="quiz-theme-selector">
                        <div class="quiz-theme-btn active" data-theme="custom">Своя</div>
                        <div class="quiz-theme-btn" data-theme="general">Общая</div>
                        <div class="quiz-theme-btn" data-theme="science">Наука</div>
                        <div class="quiz-theme-btn" data-theme="history">История</div>
                        <div class="quiz-theme-btn" data-theme="geography">География</div>
                        <div class="quiz-theme-btn" data-theme="entertainment">Кино и музыка</div>
                        <div class="quiz-theme-btn" data-theme="sports">Спорт</div>
                        <div class="quiz-theme-btn" data-theme="games">Игры</div>
                    </div>
                </div>

                <div id="questionsContainer">
                    <!-- Вопросы будут добавляться здесь -->
                    <div class="question-item" data-index="0">
                        <div class="form-group">
                            <label class="form-label">Вопрос 1:</label>
                            <input type="text" class="auth-input question-text" placeholder="Введите текст вопроса" maxlength="200">
                        </div>

                        <div class="options-container">
                            <div class="option-row">
                                <input type="radio" name="correct0" class="correct-option" value="0" checked>
                                <input type="text" class="auth-input option-input" placeholder="Вариант ответа 1" maxlength="100">
                                <button class="remove-option-btn" onclick="removeOption(this)">×</button>
                            </div>
                            <div class="option-row">
                                <input type="radio" name="correct0" class="correct-option" value="1">
                                <input type="text" class="auth-input option-input" placeholder="Вариант ответа 2" maxlength="100">
                                <button class="remove-option-btn" onclick="removeOption(this)">×</button>
                            </div>
                        </div>
                        <button class="add-option-btn" onclick="addOption(this)"><i class="fas fa-plus"></i> Добавить вариант</button>
                        <button class="remove-question-btn" onclick="removeQuestion(this)"><i class="fas fa-trash"></i> Удалить вопрос</button>
                    </div>
                </div>

                <button id="addQuestionBtn" class="add-question-btn"><i class="fas fa-plus-circle"></i> Добавить вопрос</button>

                <div class="quiz-preview">
                    <h3 style="color: #00f3ff;">Предпросмотр:</h3>
                    <div id="quizPreview"></div>
                </div>

                <div class="control-buttons" style="margin-top: 20px;">
                    <button id="saveQuizBtn" class="room-btn" style="background: #00ff9d;">
                        <i class="fas fa-save"></i> СОХРАНИТЬ ОПРОС
                    </button>
                    <button id="cancelQuizBtn" class="room-btn" style="background: rgba(255, 0, 0, 0.7);">
                        <i class="fas fa-times"></i> ОТМЕНА
                    </button>
                    <button id="publishQuizBtn" class="room-btn" style="background: #ff00ff;">
                        <i class="fas fa-globe"></i> ОПУБЛИКОВАТЬ
                    </button>
                </div>
            </div>
        </div>
    </div>

    <!-- Контейнер для пользовательских опросов -->
    <div id="userQuizzesContainer" class="user-quizzes-container">
        <h2 class="auth-title"><i class="fas fa-book"></i> МОИ ОПРОСЫ</h2>
        <div id="userQuizzesList" class="user-quizzes-list">
            <!-- Опросы будут загружаться здесь -->
        </div>
    </div>

    <div class="container">
        <header>
            <h1><i class="fas fa-gamepad"></i> NEON QUIZ BATTLE ONLINE</h1>
            <p style="margin-top: 10px; color: #aaa;">Онлайн-викторина в реальном времени с друзьями!</p>
        </header>

        <!-- Контейнер авторизации -->
        <div id="authContainer" class="auth-container">
            <h2 class="auth-title"><i class="fas fa-user-circle"></i> АВТОРИЗАЦИЯ</h2>
            <p style="color: #aaa; text-align: center; margin-bottom: 20px;">
                Войдите, чтобы создавать свои опросы, сохранять статистику и больше!
            </p>

            <div class="auth-buttons">
                <input type="email" id="emailInput" class="auth-input" placeholder="Email">
                <input type="password" id="passwordInput" class="auth-input" placeholder="Пароль">

                <button id="emailSignInBtn" class="auth-btn">
                    <i class="fas fa-envelope"></i> Войти по Email
                </button>
                <button id="emailSignUpBtn" class="auth-btn" style="background: rgba(0, 150, 255, 0.3);">
                    <i class="fas fa-user-plus"></i> Зарегистрироваться
                </button>

                <button id="continueAsGuest" class="auth-btn" style="background: rgba(100, 100, 100, 0.3);">
                    <i class="fas fa-user"></i> Продолжить как гость
                </button>
            </div>
        </div>

        <!-- ОСНОВНОЙ ИНТЕРФЕЙС ИГРЫ -->
        <div class="room-controls" style="display: none;">
            <input type="text" id="playerNameInput" class="room-input" placeholder="Введите ваше имя" value="Игрок">
            <button id="createRoomBtn" class="room-btn"><i class="fas fa-plus"></i> СОЗДАТЬ КОМНАТУ</button>
            <input type="text" id="roomCodeInput" class="room-input" placeholder="Введите код комнаты">
            <button id="joinRoomBtn" class="room-btn"><i class="fas fa-sign-in-alt"></i> ПРИСОЕДИНИТЬСЯ</button>
        </div>

        <div class="room-code-display" id="roomCodeDisplay">
            <h3>КОД КОМНАТЫ</h3>
            <div class="code" id="roomCode">XXXXXX</div>
            <p>Поделитесь этим кодом с друзьями</p>
            <div class="share-buttons">
                <button class="share-btn" onclick="copyRoomCode()"><i class="fas fa-copy"></i> Копировать</button>
                <button class="share-btn" onclick="shareRoomCode()"><i class="fas fa-share-alt"></i> Поделиться</button>
            </div>
        </div>

        <div class="status-bar">
            <div class="room-info">Комната: <span class="highlight" id="roomName">Не подключено</span></div>
            <div class="player-count">Игроков: <span class="highlight" id="onlineCount">0</span>/8</div>
            <div class="game-status">Статус: <span class="highlight" id="gameStatus">Ожидание</span></div>
            <div class="topic">Тема: <span class="highlight" id="currentTopic">Общая</span></div>
        </div>

        <div class="main-content" id="gameInterface" style="display: none;">
            <div class="left-panel">
                <h2 class="panel-title"><i class="fas fa-users"></i> Игроки в комнате</h2>
                <div class="waiting-players" id="waitingMessage">
                    <i class="fas fa-hourglass-half" style="font-size: 2rem; margin-bottom: 10px;"></i>
                    <p>Ожидание подключения других игроков...</p>
                    <p>Поделитесь кодом комнаты с друзьями!</p>
                </div>
                <ul class="player-list" id="playerList">
                    <!-- Игроки будут добавляться здесь -->
                </ul>

                <div class="theme-selector" id="themeSelector" style="display: none;">
                    <div class="panel-title">Выберите тему</div>
                    <div class="theme-btn active-theme" data-theme="general">Общая</div>
                    <div class="theme-btn" data-theme="science">Наука</div>
                    <div class="theme-btn" data-theme="history">История</div>
                    <div class="theme-btn" data-theme="geography">География</div>
                    <div class="theme-btn" data-theme="entertainment">Кино и музыка</div>
                    <div class="theme-btn" data-theme="sports">Спорт</div>
                    <div class="theme-btn" data-theme="games">Игры</div>
                </div>

                <div class="chat-container" id="chatContainer" style="display: none;">
                    <div class="panel-title"><i class="fas fa-comments"></i> Чат</div>
                    <div class="chat-messages" id="chatMessages">
                        <!-- Сообщения чата -->
                    </div>
                    <div class="chat-input">
                        <input type="text" id="chatInput" placeholder="Введите сообщение..." class="room-input">
                        <button id="sendMessageBtn" class="room-btn"><i class="fas fa-paper-plane"></i></button>
                    </div>
                </div>
            </div>

            <div class="right-panel">
                <div id="lobbyView">
                    <h2 class="panel-title"><i class="fas fa-door-open"></i> ЛОББИ</h2>
                    <div style="text-align: center; padding: 20px;">
                        <p id="hostMessage" style="display: none;">Вы создатель комнаты. Начните игру, когда все подключатся!</p>
                        <p id="guestMessage" style="display: none;">Ожидайте, пока создатель комнаты начнет игру...</p>

                        <button id="startGameBtn" class="room-btn" style="margin-top: 20px; display: none;">
                            <i class="fas fa-play"></i> НАЧАТЬ ИГРУ
                        </button>

                        <button id="readyBtn" class="room-btn" style="margin-top: 20px; display: none;">
                            <i class="fas fa-check"></i> ГОТОВ
                        </button>

                        <div class="control-buttons">
                            <button id="leaveRoomBtn" class="room-btn" style="background: rgba(255, 0, 0, 0.7);">
                                <i class="fas fa-sign-out-alt"></i> ПОКИНУТЬ КОМНАТУ
                            </button>
                            <button id="backToMainBtn" class="room-btn" style="background: rgba(0, 150, 255, 0.7);">
                                <i class="fas fa-home"></i> ГЛАВНОЕ МЕНЮ
                            </button>
                        </div>
                    </div>
                </div>

                <div class="game-area" id="gameArea">
                    <div class="question-box">
                        <div class="question-text" id="questionText">Здесь будет вопрос</div>
                        <div class="options-grid" id="optionsGrid">
                            <!-- Варианты ответов будут здесь -->
                        </div>
                    </div>

                    <div class="timer" id="timer">30</div>
                </div>

                <div class="results" id="results">
                    <h2 class="panel-title"><i class="fas fa-chart-bar"></i> РЕЗУЛЬТАТЫ РАУНДА</h2>

                    <div class="correct-answer-box">
                        <div style="color: #00f3ff; font-size: 1.1rem;">ПРАВИЛЬНЫЙ ОТВЕТ:</div>
                        <div class="correct-answer-text" id="correctAnswerText"></div>
                        <div id="correctPlayersContainer" style="display: none;">
                            <div style="margin-top: 10px; color: #aaa;">Правильно ответили:</div>
                            <div class="correct-players-list" id="correctPlayersList">
                                <!-- Список игроков, ответивших правильно -->
                            </div>
                        </div>
                    </div>

                    <div class="answer-stats">
                        <div class="stat-item">
                            <div class="stat-value" id="correctCount">0</div>
                            <div class="stat-label">Правильно</div>
                        </div>
                        <div class="stat-item">
                            <div class="stat-value" id="totalPlayersCount">0</div>
                            <div class="stat-label">Всего игроков</div>
                        </div>
                        <div class="stat-item">
                            <div class="stat-value" id="correctPercentage">0%</div>
                            <div class="stat-label">Процент верных</div>
                        </div>
                    </div>

                    <div class="scoreboard" id="scoreboard">
                        <!-- Таблица результатов будет здесь -->
                    </div>
                    <button id="nextRoundBtn" class="room-btn" style="margin-top: 20px; display: none;">
                        <i class="fas fa-forward"></i> СЛЕДУЮЩИЙ РАУНД
                    </button>
                    <button id="endGameBtn" class="room-btn" style="margin-top: 20px; display: none; background: rgba(255, 0, 0, 0.7);">
                        <i class="fas fa-flag-checkered"></i> ЗАВЕРШИТЬ ИГРУ
                    </button>
                </div>

                <div class="end-game-results" id="endGameResults">
                    <div class="trophy-icon">
                        <i class="fas fa-trophy"></i>
                    </div>
                    <h2 class="final-winner" id="finalWinnerName">ПОБЕДИТЕЛЬ ИГРЫ!</h2>
                    <div class="scoreboard" id="finalScoreboard">
                        <!-- Финальная таблица результатов -->
                    </div>
                    <div class="control-buttons">
                        <button id="playAgainBtn" class="room-btn">
                            <i class="fas fa-redo"></i> ИГРАТЬ ЕЩЕ
                        </button>
                        <button id="backToLobbyBtn" class="room-btn">
                            <i class="fas fa-door-open"></i> В ЛОББИ
                        </button>
                    </div>
                </div>
            </div>
        </div>

        <div class="notification" id="notification">
            <strong id="notificationTitle">Уведомление</strong>
            <p id="notificationText">Текст уведомления</p>
        </div>

        <footer>
            <p>Neon Quiz Battle Online &copy; 2023 | Онлайн-викторина с друзьями в реальном времени</p>
            <p style="margin-top: 5px; font-size: 0.8rem;">Работает на Firebase | Без скачиваний и регистрации</p>
        </footer>
    </div>

    <script>
        
        // Простая локальная база данных
const LocalDB = {
    users: [],
    quizzes: [],
    rooms: {},
    currentUser: null
};

// Загружаем данные из localStorage
function loadDB() {
    const saved = localStorage.getItem('quiz_app_data');
    if (saved) {
        const data = JSON.parse(saved);
        Object.assign(LocalDB, data);
    }
}

// Сохраняем данные в localStorage
function saveDB() {
    localStorage.setItem('quiz_app_data', JSON.stringify(LocalDB));
}

// Авторизация
function signInWithEmail() {
    const email = document.getElementById('emailInput').value || 'test@test.com';
    const password = document.getElementById('passwordInput').value || '123456';
    
    if (!email || !password) {
        showNotification('Ошибка', 'Заполните все поля', '#ff0000');
        return;
    }
    
    // Ищем пользователя
    const user = LocalDB.users.find(u => u.email === email && u.password === password);
    
    if (user) {
        LocalDB.currentUser = { ...user };
        delete LocalDB.currentUser.password; // Не храним пароль в памяти
        
        saveDB();
        showMainInterface();
        showNotification('Успех!', `Добро пожаловать, ${user.displayName}!`, '#00ff9d');
    } else {
        showNotification('Ошибка', 'Неверный email или пароль', '#ff0000');
    }
}

function signUpWithEmail() {
    const email = document.getElementById('emailInput').value || 'user@example.com';
    const password = document.getElementById('passwordInput').value || '123456';
    const displayName = email.split('@')[0];
    
    if (!email || !password) {
        showNotification('Ошибка', 'Заполните все поля', '#ff0000');
        return;
    }
    
    if (password.length < 6) {
        showNotification('Ошибка', 'Пароль должен быть не менее 6 символов', '#ff0000');
        return;
    }
    
    // Проверяем, существует ли пользователь
    if (LocalDB.users.find(u => u.email === email)) {
        showNotification('Ошибка', 'Пользователь с таким email уже существует', '#ff0000');
        return;
    }
    
    // Создаем нового пользователя
    const newUser = {
        id: 'user_' + Date.now(),
        email: email,
        password: password,
        displayName: displayName,
        createdAt: new Date().toISOString(),
        isGuest: false
    };
    
    LocalDB.users.push(newUser);
    LocalDB.currentUser = { ...newUser };
    delete LocalDB.currentUser.password;
    
    saveDB();
    showMainInterface();
    showNotification('Успех!', 'Регистрация завершена!', '#00ff9d');
}
        
        // Глобальные переменные игры
        const gameData = {
            user: null,
            isGuest: false,
            roomId: null,
            playerId: null,
            playerName: "Игрок",
            isHost: false,
            players: {},
            gameState: "lobby", // lobby, playing, results, endgame
            currentQuestion: 0,
            selectedTheme: "general",
            timer: 30,
            timerInterval: null,
            playerAnswers: {},
            playerReady: {},
            currentQuestionData: null,
            roundResults: {
                correctAnswer: "",
                correctPlayers: [],
                correctCount: 0,
                totalPlayers: 0
            },
            userQuizzes: [],
            customQuizzes: {}
        };

        // БОЛЬШАЯ база вопросов (более 70 вопросов!)
        const questions = {
            general: [
                { question: "Какая планета Солнечной системы самая горячая?", options: ["Венера", "Меркурий", "Марс", "Юпитер"], answer: 0 },
                { question: "Сколько цветов в радуге?", options: ["5", "6", "7", "8"], answer: 2 },
                { question: "Как называется самая длинная река в мире?", options: ["Амазонка", "Нил", "Янцзы", "Миссисипи"], answer: 0 },
                { question: "В каком году человек впервые полетел в космос?", options: ["1957", "1961", "1969", "1975"], answer: 1 },
                { question: "Какой химический элемент обозначается символом 'Au'?", options: ["Серебро", "Железо", "Золото", "Алюминий"], answer: 2 },
                { question: "Сколько континентов на Земле?", options: ["5", "6", "7", "8"], answer: 1 },
                { question: "Какое животное является символом России?", options: ["Медведь", "Орел", "Волк", "Тигр"], answer: 0 },
                { question: "Какой океан самый маленький?", options: ["Тихий", "Атлантический", "Индийский", "Северный Ледовитый"], answer: 3 },
                { question: "Сколько дней в високосном году?", options: ["365", "366", "364", "367"], answer: 1 },
                { question: "Как называется самая высокая гора в мире?", options: ["Килиманджаро", "Эверест", "Аконкагуа", "Монблан"], answer: 1 }
            ],
            science: [
                { question: "Какой газ наиболее распространен в атмосфере Земли?", options: ["Кислород", "Азот", "Углекислый газ", "Водород"], answer: 1 },
                { question: "Какая частица имеет положительный заряд?", options: ["Электрон", "Нейтрон", "Протон", "Нейтрино"], answer: 2 },
                { question: "Какой орган человека самый большой?", options: ["Печень", "Мозг", "Кожа", "Легкие"], answer: 2 },
                { question: "Сколько костей в теле взрослого человека?", options: ["206", "250", "300", "180"], answer: 0 },
                { question: "Какая планета известна своими кольцами?", options: ["Юпитер", "Сатурн", "Уран", "Нептун"], answer: 1 },
                { question: "Как называется процесс превращения воды в пар?", options: ["Конденсация", "Испарение", "Кристаллизация", "Сублимация"], answer: 1 },
                { question: "Какой металл жидкий при комнатной температуре?", options: ["Ртуть", "Золото", "Серебро", "Медь"], answer: 0 },
                { question: "Сколько хромосом у человека?", options: ["23", "46", "48", "52"], answer: 1 },
                { question: "Какая кислота содержится в желудке?", options: ["Соляная", "Серная", "Азотная", "Уксусная"], answer: 0 },
                { question: "Какой элемент самый распространенный во Вселенной?", options: ["Водород", "Гелий", "Кислород", "Углерод"], answer: 0 }
            ],
            history: [
                { question: "В каком году началась Вторая мировая война?", options: ["1937", "1939", "1941", "1945"], answer: 1 },
                { question: "Кто был первым президентом США?", options: ["Томас Джефферсон", "Джордж Вашингтон", "Авраам Линкольн", "Джон Адамс"], answer: 1 },
                { question: "Как звали первого человека в космосе?", options: ["Нил Армстронг", "Юрий Гагарин", "Валентина Терешкова", "Алан Шепард"], answer: 1 },
                { question: "В каком году пала Берлинская стена?", options: ["1987", "1989", "1991", "1993"], answer: 1 },
                { question: "Кто написал 'Войну и мир'?", options: ["Ф. Достоевский", "Л. Толстой", "А. Чехов", "И. Тургенев"], answer: 1 },
                { question: "Когда произошла Октябрьская революция?", options: ["1917", "1918", "1919", "1920"], answer: 0 },
                { question: "Кто открыл Америку?", options: ["Христофор Колумб", "Васко да Гама", "Фернан Магеллан", "Америго Веспуччи"], answer: 0 },
                { question: "В каком году распался СССР?", options: ["1989", "1990", "1991", "1992"], answer: 2 },
                { question: "Кто был первым царем всея Руси?", options: ["Иван III", "Иван IV", "Петр I", "Алексей Михайлович"], answer: 1 },
                { question: "Когда была основана Москва?", options: ["1147", "1247", "1347", "1447"], answer: 0 }
            ],
            geography: [
                { question: "Какая страна имеет самую длинную береговую линию?", options: ["Россия", "Канада", "Австралия", "Чили"], answer: 1 },
                { question: "Какой самый большой океан на Земле?", options: ["Атлантический", "Индийский", "Северный Ледовитый", "Тихий"], answer: 3 },
                { question: "Какая самая высокая гора в мире?", options: ["К2", "Килиманджаро", "Эверест", "Аконкагуа"], answer: 2 },
                { question: "Столица Австралии?", options: ["Сидней", "Мельбурн", "Канберра", "Брисбен"], answer: 2 },
                { question: "Самая большая пустыня в мире?", options: ["Сахара", "Гоби", "Аравийская", "Антарктическая"], answer: 3 },
                { question: "Сколько штатов в США?", options: ["48", "50", "52", "54"], answer: 1 },
                { question: "Самая длинная река Европы?", options: ["Дунай", "Волга", "Днепр", "Рейн"], answer: 1 },
                { question: "Какая страна самая большая по площади?", options: ["Китай", "США", "Россия", "Канада"], answer: 2 },
                { question: "Столица Бразилии?", options: ["Рио-де-Жанейро", "Сан-Паулу", "Бразилиа", "Сальвадор"], answer: 2 },
                { question: "Сколько материков на Земле?", options: ["5", "6", "7", "8"], answer: 1 }
            ],
            entertainment: [
                { question: "Какой актер сыграл Тони Старка в фильмах Marvel?", options: ["Крис Эванс", "Роберт Дауни-мл.", "Крис Хемсворт", "Марк Руффало"], answer: 1 },
                { question: "Какая группа исполнила песню 'Bohemian Rhapsody'?", options: ["The Beatles", "Queen", "Led Zeppelin", "Pink Floyd"], answer: 1 },
                { question: "Какой фильм получил Оскар за лучший фильм в 2020 году?", options: ["Паразиты", "1917", "Джокер", "Однажды в Голливуде"], answer: 0 },
                { question: "Кто написал музыку к фильму 'Титаник'?", options: ["Джон Уильямс", "Ханс Циммер", "Джеймс Хорнер", "Эннио Морриконе"], answer: 2 },
                { question: "Как зовут главного героя серии игр 'The Legend of Zelda'?", options: ["Зельда", "Линк", "Ганон", "Нави"], answer: 1 },
                { question: "Какой сериал является самым дорогим в истории?", options: ["Игра престолов", "Ведьмак", "Мандалорец", "Корона"], answer: 1 },
                { question: "Кто режиссер фильма 'Криминальное чтиво'?", options: ["Мартин Скорсезе", "Квентин Тарантино", "Дэвид Финчер", "Кристофер Нолан"], answer: 1 },
                { question: "Какой фильм собрал самый большой кассовый сбор?", options: ["Аватар", "Мстители: Финал", "Титаник", "Звездные войны: Пробуждение силы"], answer: 0 },
                { question: "Кто написал 'Гарри Поттера'?", options: ["Дж. Р. Р. Толкин", "Дж. К. Роулинг", "К. С. Льюис", "С. Майер"], answer: 1 },
                { question: "Какой мультфильм стал первым полнометражным от Disney?", options: ["Белоснежка", "Пиноккио", "Золушка", "Спящая красавица"], answer: 0 }
            ],
            sports: [
                { question: "Сколько игроков в футбольной команде на поле?", options: ["10", "11", "12", "9"], answer: 1 },
                { question: "В каком виде спорта используется шайба?", options: ["Футбол", "Баскетбол", "Хоккей", "Регби"], answer: 2 },
                { question: "Сколько очков дает трехочковый бросок в баскетболе?", options: ["1", "2", "3", "4"], answer: 2 },
                { question: "Какая страна выиграла Чемпионат мира по футболу 2018?", options: ["Франция", "Хорватия", "Бразилия", "Германия"], answer: 0 },
                { question: "Сколько сетов в теннисном матче у мужчин?", options: ["3", "4", "5", "6"], answer: 2 },
                { question: "Как называется главный турнир по теннису в Уимблдоне?", options: ["Открытый чемпионат", "Кубок", "Чемпионат", "Турнир"], answer: 0 },
                { question: "В каком году Москва принимала Олимпийские игры?", options: ["1976", "1980", "1984", "1988"], answer: 1 },
                { question: "Сколько кругов в Формуле-1?", options: ["44", "55", "66", "78"], answer: 1 },
                { question: "Какой спортсмен имеет больше всего золотых олимпийских медалей?", options: ["Майкл Фелпс", "Ларриса Латынина", "Карл Льюис", "Усэйн Болт"], answer: 0 },
                { question: "В какой стране зародился футбол?", options: ["Бразилия", "Италия", "Англия", "Германия"], answer: 2 }
            ],
            games: [
                { question: "Как зовут главного героя серии игр 'Super Mario'?", options: ["Луиджи", "Марио", "Йоши", "Боузер"], answer: 1 },
                { question: "В какой игре есть крафт?", options: ["Call of Duty", "Minecraft", "FIFA", "GTA V"], answer: 1 },
                { question: "Какая игра является самой продаваемой в истории?", options: ["Tetris", "Minecraft", "GTA V", "Wii Sports"], answer: 0 },
                { question: "Как называется компания, создавшая 'World of Warcraft'?", options: ["Valve", "Blizzard", "EA", "Ubisoft"], answer: 1 },
                { question: "Сколько чемпионов в игре 'League of Legends'?", options: ["100", "120", "150", "более 150"], answer: 3 },
                { question: "Как называется самая популярная карта в 'Counter-Strike'?", options: ["Dust II", "Inferno", "Mirage", "Nuke"], answer: 0 },
                { question: "Кто главный герой серии 'The Witcher'?", options: ["Йеннифер", "Трисс", "Геральт", "Цири"], answer: 2 },
                { question: "В какой игре есть 'Битва королев'?", options: ["Fortnite", "Overwatch", "Dota 2", "Valorant"], answer: 0 },
                { question: "Как называется игровая приставка от Sony?", options: ["Xbox", "PlayStation", "Nintendo", "Sega"], answer: 1 },
                { question: "Какой жанр у игры 'The Sims'?", options: ["Шутер", "Стратегия", "Симулятор жизни", "РПГ"], answer: 2 }
            ]
        };

        // Генератор кодов комнат
        function generateRoomCode() {
            const chars = 'ABCDEFGHIJKLMNOPQRSTUVWXYZ0123456789';
            let code = '';
            for (let i = 0; i < 6; i++) {
                code += chars.charAt(Math.floor(Math.random() * chars.length));
            }
            return code;
        }

        // Инициализация игры
        document.addEventListener('DOMContentLoaded', function() {
            // Показываем экран авторизации
            showAuthInterface();

            // Инициализируем авторизацию
            initAuth();

            // Инициализируем остальные элементы
            initGameElements();
        });

        // Инициализация авторизации
        function initAuth() {
            // Проверяем текущего пользователя
            auth.onAuthStateChanged((user) => {
                if (user) {
                    gameData.user = user;
                    gameData.isGuest = false;
                    showMainInterface();
                    loadUserQuizzes();
                    loadCustomQuizzes();
                } else {
                    gameData.user = null;
                    showAuthInterface();
                }
            });

            // Обработчики кнопок авторизации
            document.getElementById('emailSignInBtn').addEventListener('click', signInWithEmail);
            document.getElementById('emailSignUpBtn').addEventListener('click', signUpWithEmail);
            document.getElementById('continueAsGuest').addEventListener('click', continueAsGuest);
            document.getElementById('logoutBtn').addEventListener('click', signOut);

            // Инициализация создания опросов
            initQuizCreator();
        }

        // Вход по Email
        function signInWithEmail() {
            const email = document.getElementById('emailInput').value;
            const password = document.getElementById('passwordInput').value;

            if (!email || !password) {
                showNotification('Ошибка', 'Заполните все поля', '#ff0000');
                return;
            }

            auth.signInWithEmailAndPassword(email, password)
                .then((result) => {
                    showNotification('Успех!', 'Вход выполнен!', '#00ff9d');
                })
                .catch((error) => {
                    showNotification('Ошибка', error.message, '#ff0000');
                });
        }

        // Регистрация по Email
        function signUpWithEmail() {
            const email = document.getElementById('emailInput').value;
            const password = document.getElementById('passwordInput').value;

            if (!email || !password) {
                showNotification('Ошибка', 'Заполните все поля', '#ff0000');
                return;
            }

            if (password.length < 6) {
                showNotification('Ошибка', 'Пароль должен быть не менее 6 символов', '#ff0000');
                return;
            }

            auth.createUserWithEmailAndPassword(email, password)
                .then((result) => {
                    // Обновляем имя пользователя
                    return result.user.updateProfile({
                        displayName: email.split('@')[0]
                    });
                })
                .then(() => {
                    showNotification('Успех!', 'Регистрация завершена!', '#00ff9d');
                })
                .catch((error) => {
                    showNotification('Ошибка', error.message, '#ff0000');
                });
        }

        // Продолжить как гость
        function continueAsGuest() {
            gameData.isGuest = true;
            gameData.user = {
                uid: 'guest_' + Date.now() + '_' + Math.random().toString(36).substr(2, 9),
                displayName: 'Гость_' + Math.floor(Math.random() * 1000),
                email: null,
                photoURL: null,
                isGuest: true
            };
            showMainInterface();
            showNotification('Гостевой режим', 'Некоторые функции ограничены', '#ffaa00');
        }

        // Выход из системы
        function signOut() {
            if (gameData.isGuest) {
                gameData.user = null;
                gameData.isGuest = false;
                showAuthInterface();
            } else {
                auth.signOut()
                    .then(() => {
                        showNotification('Выход', 'Вы вышли из системы', '#00f3ff');
                    })
                    .catch((error) => {
                        showNotification('Ошибка', error.message, '#ff0000');
                    });
            }
        }

        // Показать интерфейс авторизации
        function showAuthInterface() {
            document.getElementById('authContainer').style.display = 'flex';
            document.querySelector('.room-controls').style.display = 'none';
            document.getElementById('gameInterface').style.display = 'none';
            document.getElementById('userProfile').style.display = 'none';
            document.getElementById('createQuizBtn').style.display = 'none';
            document.getElementById('userQuizzesContainer').style.display = 'none';
            document.getElementById('roomCodeDisplay').style.display = 'none';
            document.querySelector('.status-bar').style.display = 'none';
        }

        // Показать основной интерфейс
        function showMainInterface() {
            document.getElementById('authContainer').style.display = 'none';
            document.querySelector('.room-controls').style.display = 'flex';
            document.getElementById('userProfile').style.display = 'flex';

            // Обновляем профиль пользователя
            document.getElementById('userDisplayName').textContent =
                gameData.user.displayName || gameData.user.email || 'Пользователь';

            if (gameData.user.photoURL) {
                document.getElementById('userAvatar').src = gameData.user.photoURL;
            } else {
                document.getElementById('userAvatar').src = 'https://ui-avatars.com/api/?name=' +
                    encodeURIComponent(gameData.user.displayName || gameData.user.email || 'U') +
                    '&background=ff00ff&color=000';
            }

            // Показываем кнопку создания опроса, если не гость
            if (!gameData.isGuest) {
                document.getElementById('createQuizBtn').style.display = 'block';
                document.getElementById('userQuizzesContainer').style.display = 'block';
            }

            // Обновляем имя игрока
            document.getElementById('playerNameInput').value =
                gameData.user.displayName || gameData.user.email || 'Игрок';
        }

        // Инициализация элементов игры (ОРИГИНАЛЬНЫЙ КОД ИЗ ВАШЕГО ФАЙЛА)
        function initGameElements() {
            // Элементы интерфейса
            const createRoomBtn = document.getElementById('createRoomBtn');
            const joinRoomBtn = document.getElementById('joinRoomBtn');
            const playerNameInput = document.getElementById('playerNameInput');
            const roomCodeInput = document.getElementById('roomCodeInput');
            const startGameBtn = document.getElementById('startGameBtn');
            const readyBtn = document.getElementById('readyBtn');
            const leaveRoomBtn = document.getElementById('leaveRoomBtn');
            const backToMainBtn = document.getElementById('backToMainBtn');
            const nextRoundBtn = document.getElementById('nextRoundBtn');
            const endGameBtn = document.getElementById('endGameBtn');
            const playAgainBtn = document.getElementById('playAgainBtn');
            const backToLobbyBtn = document.getElementById('backToLobbyBtn');
            const sendMessageBtn = document.getElementById('sendMessageBtn');
            const chatInput = document.getElementById('chatInput');

            // Создание комнаты
            createRoomBtn.addEventListener('click', function() {
                const playerName = playerNameInput.value.trim() || "Игрок";
                const roomCode = generateRoomCode();

                gameData.playerName = playerName;
                gameData.playerId = 'player_' + Date.now() + '_' + Math.random().toString(36).substr(2, 9);
                gameData.isHost = true;

                // Создаем комнату в Firebase
                database.ref('rooms/' + roomCode).set({
                    hostId: gameData.playerId,
                    gameState: 'lobby',
                    theme: 'general',
                    currentQuestionIndex: 0,
                    currentQuestionData: null,
                    players: {
                        [gameData.playerId]: {
                            name: playerName,
                            score: 0,
                            ready: false,
                            isHost: true,
                            lastActive: Date.now()
                        }
                    },
                    createdAt: Date.now()
                }).then(() => {
                    gameData.roomId = roomCode;
                    joinRoom(roomCode, playerName);
                    showNotification('Комната создана!', `Код комнаты: ${roomCode}`);

                    // Показываем код комнаты
                    document.getElementById('roomCodeDisplay').style.display = 'block';
                    document.getElementById('roomCode').textContent = roomCode;

                    // Обновляем интерфейс
                    document.getElementById('hostMessage').style.display = 'block';
                    startGameBtn.style.display = 'block';
                    document.getElementById('themeSelector').style.display = 'block';
                }).catch(error => {
                    showNotification('Ошибка', 'Не удалось создать комнату');
                    console.error(error);
                });
            });

            // Присоединение к комнате
            joinRoomBtn.addEventListener('click', function() {
                const playerName = playerNameInput.value.trim() || "Игрок";
                const roomCode = roomCodeInput.value.trim().toUpperCase();

                if (roomCode.length !== 6) {
                    showNotification('Ошибка', 'Код комнаты должен содержать 6 символов');
                    return;
                }

                // Проверяем существование комнаты
                database.ref('rooms/' + roomCode).once('value').then(snapshot => {
                    if (snapshot.exists()) {
                        gameData.playerName = playerName;
                        gameData.playerId = 'player_' + Date.now() + '_' + Math.random().toString(36).substr(2, 9);
                        gameData.isHost = false;

                        joinRoom(roomCode, playerName);
                        showNotification('Успех!', `Вы присоединились к комнате ${roomCode}`);
                    } else {
                        showNotification('Ошибка', 'Комната не найдена');
                    }
                });
            });

            // Функция присоединения к комнате
            function joinRoom(roomCode, playerName) {
                gameData.roomId = roomCode;

                // Показываем игровой интерфейс
                document.getElementById('gameInterface').style.display = 'flex';
                document.querySelector('.room-controls').style.display = 'none';
                document.getElementById('roomCodeDisplay').style.display = 'none';

                // Обновляем информацию о комнате
                document.getElementById('roomName').textContent = roomCode;

                // Показываем соответствующее сообщение
                if (gameData.isHost) {
                    document.getElementById('hostMessage').style.display = 'block';
                    document.getElementById('guestMessage').style.display = 'none';
                    startGameBtn.style.display = 'block';
                    readyBtn.style.display = 'none';
                } else {
                    document.getElementById('hostMessage').style.display = 'none';
                    document.getElementById('guestMessage').style.display = 'block';
                    startGameBtn.style.display = 'none';
                    readyBtn.style.display = 'block';
                }

                // Добавляем игрока в комнату
                database.ref('rooms/' + roomCode + '/players/' + gameData.playerId).set({
                    name: playerName,
                    score: 0,
                    ready: false,
                    isHost: gameData.isHost,
                    lastActive: Date.now()
                });

                // Подписываемся на изменения в комнате
                setupRoomListeners(roomCode);
            }

            // Настройка слушателей комнаты
            function setupRoomListeners(roomCode) {
                // Слушатель изменений списка игроков
                database.ref('rooms/' + roomCode + '/players').on('value', snapshot => {
                    gameData.players = snapshot.val() || {};
                    updatePlayerList();

                    // Показываем/скрываем сообщение об ожидании
                    const playerCount = Object.keys(gameData.players).length;
                    document.getElementById('waitingMessage').style.display =
                        playerCount < 2 ? 'block' : 'none';
                    document.getElementById('chatContainer').style.display =
                        playerCount >= 2 ? 'block' : 'none';
                });

                // Слушатель состояния игры
                database.ref('rooms/' + roomCode + '/gameState').on('value', snapshot => {
                    const state = snapshot.val();
                    gameData.gameState = state;

                    document.getElementById('gameStatus').textContent =
                        state === 'lobby' ? 'Лобби' :
                        state === 'playing' ? 'Игра идет' :
                        state === 'results' ? 'Результаты' : 'Конец игры';

                    if (state === 'playing') {
                        startGame();
                    } else if (state === 'results') {
                        // Получаем данные о правильном ответе
                        calculateRoundResults();
                        showResults();
                    } else if (state === 'endgame') {
                        showEndGameResults();
                    }
                });

                // Слушатель текущего вопроса
                database.ref('rooms/' + roomCode + '/currentQuestionIndex').on('value', snapshot => {
                    gameData.currentQuestion = snapshot.val() || 0;
                });

                // Слушатель данных текущего вопроса
                database.ref('rooms/' + roomCode + '/currentQuestionData').on('value', snapshot => {
                    gameData.currentQuestionData = snapshot.val();
                    if (gameData.gameState === 'playing' && gameData.currentQuestionData) {
                        loadQuestionFromData();
                    }
                });

                // Слушатель темы
                database.ref('rooms/' + roomCode + '/theme').on('value', snapshot => {
                    gameData.selectedTheme = snapshot.val() || 'general';
                    updateThemeSelector();
                    document.getElementById('currentTopic').textContent = getThemeName(gameData.selectedTheme);
                });

                // Слушатель ответов игроков
                database.ref('rooms/' + roomCode + '/answers').on('value', snapshot => {
                    gameData.playerAnswers = snapshot.val() || {};
                    // При изменении ответов пересчитываем результаты
                    if (gameData.gameState === 'results') {
                        calculateRoundResults();
                        updateResultsDisplay();
                    }
                });

                // Слушатель чата
                database.ref('rooms/' + roomCode + '/chat').limitToLast(20).on('value', snapshot => {
                    const messages = snapshot.val() || {};
                    updateChat(messages);
                });
            }

            // Начало игры (только для хоста)
            startGameBtn.addEventListener('click', function() {
                if (!gameData.isHost) return;

                // Проверяем, есть ли хотя бы 1 готовый игрок кроме хоста
                let readyPlayers = 0;
                Object.keys(gameData.players).forEach(playerId => {
                    if (playerId !== gameData.playerId && gameData.players[playerId].ready) {
                        readyPlayers++;
                    }
                });

                if (readyPlayers === 0) {
                    showNotification('Ошибка', 'Дождитесь, пока другие игроки нажмут "Готов"');
                    return;
                }

                // Сбрасываем очки всех игроков
                const updates = {};
                Object.keys(gameData.players).forEach(playerId => {
                    updates['/players/' + playerId + '/score'] = 0;
                });

                database.ref('rooms/' + gameData.roomId).update(updates).then(() => {
                    // Начинаем игру с первого вопроса
                    let themeQuestions = questions[gameData.selectedTheme];

                    // Проверяем, есть ли пользовательские опросы для этой темы
                    if (gameData.customQuizzes[gameData.selectedTheme]) {
                        themeQuestions = gameData.customQuizzes[gameData.selectedTheme];
                    }

                    const questionIndex = 0;
                    const question = themeQuestions[questionIndex];

                    database.ref('rooms/' + gameData.roomId).update({
                        gameState: 'playing',
                        currentQuestionIndex: questionIndex,
                        currentQuestionData: question,
                        answers: {},
                        questionStartTime: Date.now()
                    });
                });
            });

            // Кнопка "Готов"
            readyBtn.addEventListener('click', function() {
                database.ref('rooms/' + gameData.roomId + '/players/' + gameData.playerId).update({
                    ready: true,
                    lastActive: Date.now()
                });

                readyBtn.disabled = true;
                readyBtn.innerHTML = '<span class="loader"></span> ОЖИДАНИЕ';
            });

            // Следующий раунд
            nextRoundBtn.addEventListener('click', function() {
                if (!gameData.isHost) return;

                const nextQuestionIndex = gameData.currentQuestion + 1;
                let themeQuestions = questions[gameData.selectedTheme];

                // Проверяем, есть ли пользовательские опросы для этой темы
                if (gameData.customQuizzes[gameData.selectedTheme]) {
                    themeQuestions = gameData.customQuizzes[gameData.selectedTheme];
                }

                if (nextQuestionIndex >= themeQuestions.length) {
                    // Конец игры
                    database.ref('rooms/' + gameData.roomId).update({
                        gameState: 'endgame'
                    });
                } else {
                    // Следующий вопрос
                    const nextQuestion = themeQuestions[nextQuestionIndex];

                    database.ref('rooms/' + gameData.roomId).update({
                        gameState: 'playing',
                        currentQuestionIndex: nextQuestionIndex,
                        currentQuestionData: nextQuestion,
                        answers: {},
                        questionStartTime: Date.now()
                    });
                }
            });

            // Завершить игру
            endGameBtn.addEventListener('click', function() {
                if (!gameData.isHost) return;

                database.ref('rooms/' + gameData.roomId).update({
                    gameState: 'endgame'
                });
            });

            // Играть еще
            playAgainBtn.addEventListener('click', function() {
                if (!gameData.isHost) return;

                // Сбрасываем очки всех игроков
                const updates = {};
                Object.keys(gameData.players).forEach(playerId => {
                    updates['/players/' + playerId + '/score'] = 0;
                    updates['/players/' + playerId + '/ready'] = false;
                });

                database.ref('rooms/' + gameData.roomId).update(updates).then(() => {
                    database.ref('rooms/' + gameData.roomId).update({
                        gameState: 'lobby',
                        currentQuestionIndex: 0,
                        currentQuestionData: null,
                        answers: {}
                    });
                });
            });

            // Вернуться в лобби
            backToLobbyBtn.addEventListener('click', function() {
                if (!gameData.isHost) return;

                database.ref('rooms/' + gameData.roomId).update({
                    gameState: 'lobby',
                    currentQuestionIndex: 0,
                    currentQuestionData: null,
                    answers: {}
                });
            });

            // Покинуть комнату
            leaveRoomBtn.addEventListener('click', function() {
                if (confirm('Вы уверены, что хотите покинуть комнату?')) {
                    leaveRoom();
                }
            });

            // Вернуться в главное меню
            backToMainBtn.addEventListener('click', function() {
                if (confirm('Вы уверены, что хотите вернуться в главное меню?')) {
                    leaveRoom();
                    resetToMainMenu();
                }
            });

            function leaveRoom() {
                if (gameData.roomId && gameData.playerId) {
                    // Удаляем игрока из комнаты
                    database.ref('rooms/' + gameData.roomId + '/players/' + gameData.playerId).remove().then(() => {
                        // Проверяем, пустая ли комната
                        database.ref('rooms/' + gameData.roomId + '/players').once('value').then(snapshot => {
                            const players = snapshot.val() || {};
                            if (Object.keys(players).length === 0) {
                                // Если комната пуста, удаляем ее
                                database.ref('rooms/' + gameData.roomId).remove();
                            } else if (gameData.isHost) {
                                // Если хост уходит, назначаем нового хоста
                                const playerIds = Object.keys(players);
                                if (playerIds.length > 0) {
                                    const newHostId = playerIds[0];
                                    database.ref('rooms/' + gameData.roomId).update({
                                        hostId: newHostId
                                    });
                                    database.ref('rooms/' + gameData.roomId + '/players/' + newHostId).update({
                                        isHost: true
                                    });
                                }
                            }
                        });
                    });
                }

                resetToMainMenu();
            }

            // Отправка сообщения в чат
            sendMessageBtn.addEventListener('click', sendMessage);
            chatInput.addEventListener('keypress', function(e) {
                if (e.key === 'Enter') sendMessage();
            });

            function sendMessage() {
                const message = chatInput.value.trim();
                if (!message || !gameData.roomId) return;

                const messageId = Date.now();
                database.ref('rooms/' + gameData.roomId + '/chat/' + messageId).set({
                    sender: gameData.playerName,
                    text: message,
                    timestamp: Date.now(),
                    senderId: gameData.playerId
                });

                chatInput.value = '';
            }

            // Начало игры
            function startGame() {
                document.getElementById('lobbyView').style.display = 'none';
                document.getElementById('gameArea').style.display = 'block';
                document.getElementById('results').style.display = 'none';
                document.getElementById('endGameResults').style.display = 'none';

                loadQuestionFromData();
                startTimer();
            }

            // Загрузка вопроса из данных
            function loadQuestionFromData() {
                const question = gameData.currentQuestionData;
                if (!question) return;

                document.getElementById('questionText').textContent = question.question;
                const optionsGrid = document.getElementById('optionsGrid');
                optionsGrid.innerHTML = '';

                question.options.forEach((option, index) => {
                    const optionElement = document.createElement('div');
                    optionElement.className = 'option';
                    optionElement.textContent = option;
                    optionElement.dataset.index = index;

                    optionElement.addEventListener('click', function() {
                        if (!gameData.playerId || gameData.playerAnswers[gameData.playerId]) return;

                        const selectedIndex = parseInt(this.dataset.index);
                        submitAnswer(selectedIndex);
                    });

                    optionsGrid.appendChild(optionElement);
                });

                // Сбрасываем ответы на клиенте
                gameData.playerAnswers = {};

                // Включаем варианты ответов
                document.querySelectorAll('.option').forEach(opt => {
                    opt.classList.remove('disabled');
                    opt.style.pointerEvents = 'auto';
                });
            }

            // Отправка ответа
            function submitAnswer(answerIndex) {
                if (!gameData.roomId || !gameData.playerId) return;

                database.ref('rooms/' + gameData.roomId + '/answers/' + gameData.playerId).set({
                    answer: answerIndex,
                    timestamp: Date.now(),
                    playerName: gameData.playerName
                });

                // Отключаем варианты ответов для этого игрока
                document.querySelectorAll('.option').forEach(opt => {
                    opt.classList.add('disabled');
                    opt.style.pointerEvents = 'none';
                });
            }

            // Таймер
            function startTimer() {
                clearInterval(gameData.timerInterval);
                gameData.timer = 30;
                updateTimerDisplay();

                gameData.timerInterval = setInterval(() => {
                    gameData.timer--;
                    updateTimerDisplay();

                    if (gameData.timer <= 0) {
                        clearInterval(gameData.timerInterval);
                        if (gameData.isHost) {
                            endQuestion();
                        }
                    }
                }, 1000);
            }

            function endQuestion() {
                if (!gameData.isHost) return;

                // Показываем результаты
                database.ref('rooms/' + gameData.roomId).update({
                    gameState: 'results'
                });
            }

            // Расчет результатов раунда
            function calculateRoundResults() {
                const question = gameData.currentQuestionData;
                if (!question) return;

                // Получаем правильный ответ
                const correctAnswerIndex = question.answer;
                const correctAnswerText = question.options[correctAnswerIndex];

                // Собираем статистику
                const totalPlayers = Object.keys(gameData.players).length;
                let correctCount = 0;
                const correctPlayers = [];

                // Проверяем ответы игроков
                Object.keys(gameData.playerAnswers).forEach(playerId => {
                    const answer = gameData.playerAnswers[playerId];
                    const player = gameData.players[playerId];

                    if (answer && player) {
                        if (answer.answer === correctAnswerIndex) {
                            correctCount++;
                            correctPlayers.push({
                                name: player.name,
                                isHost: player.isHost
                            });

                            // Обновляем очки на сервере
                            database.ref('rooms/' + gameData.roomId + '/players/' + playerId).update({
                                score: (player.score || 0) + 10
                            });
                        }
                    }
                });

                // Сохраняем результаты
                gameData.roundResults = {
                    correctAnswer: correctAnswerText,
                    correctPlayers: correctPlayers,
                    correctCount: correctCount,
                    totalPlayers: totalPlayers,
                    percentage: totalPlayers > 0 ? Math.round((correctCount / totalPlayers) * 100) : 0
                };
            }

            // Показать результаты раунда
            function showResults() {
                document.getElementById('gameArea').style.display = 'none';
                document.getElementById('results').style.display = 'block';
                document.getElementById('endGameResults').style.display = 'none';

                // Рассчитываем результаты
                calculateRoundResults();

                // Обновляем отображение
                updateResultsDisplay();

                // Показываем кнопки управления
                nextRoundBtn.style.display = gameData.isHost ? 'block' : 'none';
                endGameBtn.style.display = gameData.isHost ? 'block' : 'none';
            }

            // Обновить отображение результатов
            function updateResultsDisplay() {
                const results = gameData.roundResults;

                // Показываем правильный ответ
                document.getElementById('correctAnswerText').textContent = results.correctAnswer;

                // Обновляем статистику
                document.getElementById('correctCount').textContent = results.correctCount;
                document.getElementById('totalPlayersCount').textContent = results.totalPlayers;
                document.getElementById('correctPercentage').textContent = results.percentage + '%';

                // Показываем игроков, ответивших правильно
                const correctPlayersList = document.getElementById('correctPlayersList');
                const correctPlayersContainer = document.getElementById('correctPlayersContainer');

                correctPlayersList.innerHTML = '';

                if (results.correctPlayers.length > 0) {
                    results.correctPlayers.forEach(player => {
                        const playerElement = document.createElement('div');
                        playerElement.className = 'correct-player';
                        playerElement.innerHTML = `
                            ${player.name}
                            ${player.isHost ? '<span class="host-badge" style="font-size: 0.7rem; padding: 1px 5px;">ХОСТ</span>' : ''}
                            <span style="color: #00ff9d;">(+10 очков)</span>
                        `;
                        correctPlayersList.appendChild(playerElement);
                    });
                    correctPlayersContainer.style.display = 'block';
                } else {
                    correctPlayersContainer.style.display = 'none';
                    const noCorrectElement = document.createElement('div');
                    noCorrectElement.className = 'correct-player';
                    noCorrectElement.textContent = 'Никто не ответил правильно 😔';
                    noCorrectElement.style.color = '#ff5555';
                    correctPlayersList.appendChild(noCorrectElement);
                    correctPlayersContainer.style.display = 'block';
                }

                // Обновляем таблицу результатов
                const scoreboard = document.getElementById('scoreboard');
                scoreboard.innerHTML = '<h3 style="color: #00f3ff; margin-bottom: 10px;">ОБЩИЙ ЗАЧЕТ:</h3>';

                const playersArray = Object.values(gameData.players);
                const sortedPlayers = [...playersArray].sort((a, b) => b.score - a.score);

                sortedPlayers.forEach((player, index) => {
                    const playerRow = document.createElement('div');
                    playerRow.className = 'player-item';

                    // Подсвечиваем игроков, ответивших правильно
                    const answeredCorrectly = results.correctPlayers.some(p => p.name === player.name);
                    playerRow.style.borderLeftColor = answeredCorrectly ? '#00ff9d' : '#ff00ff';
                    playerRow.style.marginBottom = '10px';

                    playerRow.innerHTML = `
                        <span style="font-weight: bold; margin-right: 10px;">${index + 1}.</span>
                        <i class="fas fa-user player-icon"></i>
                        <span>${player.name}</span>
                        ${player.isHost ? '<span class="host-badge">ХОСТ</span>' : ''}
                        ${answeredCorrectly ? '<i class="fas fa-check" style="color: #00ff9d; margin-left: 5px;"></i>' : ''}
                        <span class="player-score">${player.score} pts</span>
                    `;

                    scoreboard.appendChild(playerRow);
                });
            }

            // Показать финальные результаты
            function showEndGameResults() {
                document.getElementById('gameArea').style.display = 'none';
                document.getElementById('results').style.display = 'none';
                document.getElementById('endGameResults').style.display = 'block';

                // Определяем победителя игры
                const playersArray = Object.values(gameData.players);
                const sortedPlayers = [...playersArray].sort((a, b) => b.score - a.score);
                const winner = sortedPlayers[0];

                if (winner) {
                    document.getElementById('finalWinnerName').textContent = `🏆 ПОБЕДИТЕЛЬ: ${winner.name} (${winner.score} очков) 🏆`;
                }

                // Обновляем финальную таблицу результатов
                const finalScoreboard = document.getElementById('finalScoreboard');
                finalScoreboard.innerHTML = '';

                sortedPlayers.forEach((player, index) => {
                    const playerRow = document.createElement('div');
                    playerRow.className = 'player-item';

                    // Медали для первых трех мест
                    let medal = '';
                    if (index === 0) {
                        medal = '🥇';
                        playerRow.style.borderLeftColor = 'gold';
                    } else if (index === 1) {
                        medal = '🥈';
                        playerRow.style.borderLeftColor = 'silver';
                    } else if (index === 2) {
                        medal = '🥉';
                        playerRow.style.borderLeftColor = '#cd7f32'; // бронза
                    } else {
                        playerRow.style.borderLeftColor = '#ff00ff';
                    }

                    playerRow.style.marginBottom = '10px';

                    playerRow.innerHTML = `
                        <span style="font-weight: bold; margin-right: 10px;">${index + 1}${medal}</span>
                        <i class="fas fa-user player-icon"></i>
                        <span>${player.name}</span>
                        ${player.isHost ? '<span class="host-badge">ХОСТ</span>' : ''}
                        <span class="player-score">${player.score} pts</span>
                    `;

                    finalScoreboard.appendChild(playerRow);
                });
            }

            // Обновление списка игроков
            function updatePlayerList() {
                const playerList = document.getElementById('playerList');
                playerList.innerHTML = '';

                Object.keys(gameData.players).forEach(playerId => {
                    const player = gameData.players[playerId];
                    const li = document.createElement('li');
                    li.className = 'player-item';
                    li.style.borderLeftColor = player.isHost ? '#00ff9d' : '#ff00ff';

                    li.innerHTML = `
                        <i class="fas fa-user player-icon"></i>
                        <span>${player.name}</span>
                        ${player.isHost ? '<span class="host-badge">ХОСТ</span>' : ''}
                        ${player.ready ? '<i class="fas fa-check" style="color: #00ff9d; margin-left: 5px;"></i>' : ''}
                        <span class="player-score">${player.score} pts</span>
                    `;

                    // Добавляем кнопку кика для хоста (только для других игроков)
                    if (gameData.isHost && playerId !== gameData.playerId) {
                        const kickBtn = document.createElement('button');
                        kickBtn.className = 'kick-btn';
                        kickBtn.innerHTML = '<i class="fas fa-times"></i>';
                        kickBtn.title = 'Исключить игрока';
                        kickBtn.style.display = 'block';

                        kickBtn.addEventListener('click', function(e) {
                            e.stopPropagation();
                            if (confirm(`Исключить игрока ${player.name}?`)) {
                                database.ref('rooms/' + gameData.roomId + '/players/' + playerId).remove();
                                showNotification('Игрок исключен', `${player.name} был исключен из комнаты`);
                            }
                        });

                        li.appendChild(kickBtn);
                    }

                    playerList.appendChild(li);
                });

                // Обновляем счетчик игроков
                const playerCount = Object.keys(gameData.players).length;
                document.getElementById('onlineCount').textContent = playerCount;

                // Обновляем статус готовности для хоста
                if (gameData.isHost && startGameBtn) {
                    const allReady = Object.values(gameData.players).every(p => p.ready || p.isHost);
                    startGameBtn.disabled = playerCount < 2 || !allReady;
                }
            }

            // Обновление чата
            function updateChat(messages) {
                const chatMessages = document.getElementById('chatMessages');
                chatMessages.innerHTML = '';

                // Сортируем сообщения по времени
                const sortedMessageIds = Object.keys(messages).sort((a, b) => a - b);

                sortedMessageIds.forEach(messageId => {
                    const message = messages[messageId];
                    const messageElement = document.createElement('div');
                    messageElement.className = 'message';

                    const isOwnMessage = message.senderId === gameData.playerId;

                    messageElement.innerHTML = `
                        <div class="message-sender" style="color: ${isOwnMessage ? '#00ff9d' : '#ff00ff'}">
                            ${message.sender}${isOwnMessage ? ' (Вы)' : ''}
                        </div>
                        <div>${message.text}</div>
                        <div style="font-size: 0.8rem; color: #aaa; text-align: right;">
                            ${new Date(message.timestamp).toLocaleTimeString([], {hour: '2-digit', minute:'2-digit'})}
                        </div>
                    `;

                    chatMessages.appendChild(messageElement);
                });

                // Прокручиваем вниз
                chatMessages.scrollTop = chatMessages.scrollHeight;
            }

            // Обновление селектора тем
            function updateThemeSelector() {
                document.querySelectorAll('.theme-btn').forEach(btn => {
                    btn.classList.remove('active-theme');
                    if (btn.getAttribute('data-theme') === gameData.selectedTheme) {
                        btn.classList.add('active-theme');
                    }

                    // Добавляем обработчики для хоста
                    if (gameData.isHost) {
                        btn.onclick = function() {
                            const theme = this.getAttribute('data-theme');
                            database.ref('rooms/' + gameData.roomId).update({
                                theme: theme
                            });
                            showNotification('Тема изменена', `Тема игры: ${getThemeName(theme)}`);
                        };
                    } else {
                        btn.style.cursor = 'default';
                    }
                });
            }

            // Обновление таймера
            function updateTimerDisplay() {
                document.getElementById('timer').textContent = gameData.timer;

                if (gameData.timer <= 10) {
                    document.getElementById('timer').style.color = '#ff0000';
                    document.getElementById('timer').classList.add('pulse');
                } else {
                    document.getElementById('timer').style.color = '#ff00ff';
                    document.getElementById('timer').classList.remove('pulse');
                }
            }

            // Сброс к главному меню
            function resetToMainMenu() {
                // Очищаем все интервалы
                clearInterval(gameData.timerInterval);

                // Скрываем игровой интерфейс
                document.getElementById('gameInterface').style.display = 'none';
                document.querySelector('.room-controls').style.display = 'flex';
                document.getElementById('roomCodeDisplay').style.display = 'none';

                // Сбрасываем игровые данные
                gameData.roomId = null;
                gameData.playerId = null;
                gameData.isHost = false;
                gameData.players = {};
                gameData.gameState = "lobby";

                // Обновляем статус
                document.getElementById('roomName').textContent = 'Не подключено';
                document.getElementById('onlineCount').textContent = '0';
                document.getElementById('gameStatus').textContent = 'Ожидание';
            }
        }

        // Инициализация создания опросов
        function initQuizCreator() {
            document.getElementById('createQuizBtn').addEventListener('click', showQuizCreator);
            document.getElementById('cancelQuizBtn').addEventListener('click', hideQuizCreator);
            document.getElementById('saveQuizBtn').addEventListener('click', saveQuiz);
            document.getElementById('publishQuizBtn').addEventListener('click', publishQuiz);
            document.getElementById('addQuestionBtn').addEventListener('click', addQuestion);

            // Инициализируем выбор темы в создании опроса
            document.querySelectorAll('.quiz-theme-btn').forEach(btn => {
                btn.addEventListener('click', function() {
                    document.querySelectorAll('.quiz-theme-btn').forEach(b => b.classList.remove('active'));
                    this.classList.add('active');
                    generateQuizPreview();
                });
            });

            // Обновляем превью при вводе
            document.getElementById('questionsContainer').addEventListener('input', generateQuizPreview);
            document.getElementById('quizTitle').addEventListener('input', generateQuizPreview);
        }

        // Показать создание опроса
        function showQuizCreator() {
            if (gameData.isGuest) {
                showNotification('Ошибка', 'Войдите в систему для создания опросов', '#ff0000');
                return;
            }

            document.getElementById('quizCreatorModal').style.display = 'block';
            generateQuizPreview();
        }

        // Скрыть создание опроса
        function hideQuizCreator() {
            document.getElementById('quizCreatorModal').style.display = 'none';
            resetQuizForm();
        }

        // Сброс формы опроса
        function resetQuizForm() {
            document.getElementById('quizTitle').value = '';
            document.getElementById('quizDescription').value = '';
            document.getElementById('questionsContainer').innerHTML = `
                <div class="question-item" data-index="0">
                    <div class="form-group">
                        <label class="form-label">Вопрос 1:</label>
                        <input type="text" class="auth-input question-text" placeholder="Введите текст вопроса" maxlength="200">
                    </div>

                    <div class="options-container">
                        <div class="option-row">
                            <input type="radio" name="correct0" class="correct-option" value="0" checked>
                            <input type="text" class="auth-input option-input" placeholder="Вариант ответа 1" maxlength="100">
                            <button class="remove-option-btn" onclick="removeOption(this)">×</button>
                        </div>
                        <div class="option-row">
                            <input type="radio" name="correct0" class="correct-option" value="1">
                            <input type="text" class="auth-input option-input" placeholder="Вариант ответа 2" maxlength="100">
                            <button class="remove-option-btn" onclick="removeOption(this)">×</button>
                        </div>
                    </div>
                    <button class="add-option-btn" onclick="addOption(this)"><i class="fas fa-plus"></i> Добавить вариант</button>
                    <button class="remove-question-btn" onclick="removeQuestion(this)"><i class="fas fa-trash"></i> Удалить вопрос</button>
                </div>
            `;
        }

        // Добавить вопрос
        function addQuestion() {
            const questionsContainer = document.getElementById('questionsContainer');
            const questionCount = questionsContainer.children.length;

            const questionHTML = `
                <div class="question-item" data-index="${questionCount}">
                    <div class="form-group">
                        <label class="form-label">Вопрос ${questionCount + 1}:</label>
                        <input type="text" class="auth-input question-text" placeholder="Введите текст вопроса" maxlength="200">
                    </div>

                    <div class="options-container">
                        <div class="option-row">
                            <input type="radio" name="correct${questionCount}" class="correct-option" value="0" checked>
                            <input type="text" class="auth-input option-input" placeholder="Вариант ответа 1" maxlength="100">
                            <button class="remove-option-btn" onclick="removeOption(this)">×</button>
                        </div>
                        <div class="option-row">
                            <input type="radio" name="correct${questionCount}" class="correct-option" value="1">
                            <input type="text" class="auth-input option-input" placeholder="Вариант ответа 2" maxlength="100">
                            <button class="remove-option-btn" onclick="removeOption(this)">×</button>
                        </div>
                    </div>
                    <button class="add-option-btn" onclick="addOption(this)"><i class="fas fa-plus"></i> Добавить вариант</button>
                    <button class="remove-question-btn" onclick="removeQuestion(this)"><i class="fas fa-trash"></i> Удалить вопрос</button>
                </div>
            `;

            questionsContainer.insertAdjacentHTML('beforeend', questionHTML);
            generateQuizPreview();
        }

        // Глобальные функции для кнопок
        window.addOption = function(button) {
            const questionItem = button.closest('.question-item');
            const optionsContainer = questionItem.querySelector('.options-container');
            const optionCount = optionsContainer.children.length;

            const optionHTML = `
                <div class="option-row">
                    <input type="radio" name="${questionItem.dataset.index}" class="correct-option" value="${optionCount}">
                    <input type="text" class="auth-input option-input" placeholder="Вариант ответа ${optionCount + 1}" maxlength="100">
                    <button class="remove-option-btn" onclick="removeOption(this)">×</button>
                </div>
            `;

            optionsContainer.insertAdjacentHTML('beforeend', optionHTML);
            generateQuizPreview();
        };

        window.removeOption = function(button) {
            const optionRow = button.closest('.option-row');
            const optionsContainer = optionRow.parentElement;

            if (optionsContainer.children.length > 2) {
                optionRow.remove();
                // Обновляем индексы и checked состояние
                updateOptionsIndices(optionsContainer);
                generateQuizPreview();
            } else {
                showNotification('Ошибка', 'Должно быть минимум 2 варианта ответа', '#ff0000');
            }
        };

        window.removeQuestion = function(button) {
            const questionItem = button.closest('.question-item');
            const questionsContainer = document.getElementById('questionsContainer');

            if (questionsContainer.children.length > 1) {
                questionItem.remove();
                // Обновляем индексы вопросов
                updateQuestionIndices();
                generateQuizPreview();
            } else {
                showNotification('Ошибка', 'Должен быть минимум 1 вопрос', '#ff0000');
            }
        };

        // Обновить индексы вариантов ответа
        function updateOptionsIndices(optionsContainer) {
            const optionRows = optionsContainer.querySelectorAll('.option-row');
            optionRows.forEach((row, index) => {
                const radio = row.querySelector('.correct-option');
                radio.value = index;
            });
        }

        // Обновить индексы вопросов
        function updateQuestionIndices() {
            const questions = document.querySelectorAll('.question-item');
            questions.forEach((question, index) => {
                question.dataset.index = index;
                const questionLabel = question.querySelector('.form-label');
                questionLabel.textContent = `Вопрос ${index + 1}:`;

                // Обновляем name у radio кнопок
                const radios = question.querySelectorAll('.correct-option');
                radios.forEach(radio => {
                    radio.name = `correct${index}`;
                });
            });
        }

        // Сгенерировать превью опроса
        function generateQuizPreview() {
            const preview = document.getElementById('quizPreview');
            let html = '<div class="question-box" style="margin-bottom: 15px;">';

            const questions = document.querySelectorAll('.question-item');
            questions.forEach((question, qIndex) => {
                const questionText = question.querySelector('.question-text').value || 'Пример вопроса';
                const options = question.querySelectorAll('.option-input');
                const correctIndex = parseInt(question.querySelector('.correct-option:checked').value);

                html += `<div style="margin-bottom: 20px;">`;
                html += `<div class="question-text" style="font-size: 1.1rem; color: #00f3ff;">${qIndex + 1}. ${questionText}</div>`;
                html += `<div style="margin-top: 10px;">`;

                options.forEach((option, oIndex) => {
                    const optionText = option.value || `Вариант ${oIndex + 1}`;
                    const isCorrect = oIndex === correctIndex;
                    html += `<div class="option" style="background: ${isCorrect ? 'rgba(0, 255, 157, 0.2)' : 'rgba(20, 20, 50, 0.8)'}; border-color: ${isCorrect ? '#00ff9d' : '#ff00ff'}; margin-bottom: 8px; padding: 10px; border-radius: 8px;">
                        ${optionText} ${isCorrect ? '<i class="fas fa-check" style="color: #00ff9d; margin-left: 10px;"></i>' : ''}
                    </div>`;
                });

                html += `</div></div>`;
            });

            html += '</div>';
            html += `<div style="color: #aaa; text-align: center;">Всего вопросов: ${questions.length}</div>`;

            preview.innerHTML = html;
        }

        // Сохранить опрос
        async function saveQuiz() {
            if (!gameData.user || gameData.isGuest) {
                showNotification('Ошибка', 'Войдите в систему для сохранения опросов', '#ff0000');
                return;
            }

            const quizData = collectQuizData();
            if (!validateQuiz(quizData)) return;

            try {
                const quizId = 'quiz_' + Date.now() + '_' + Math.random().toString(36).substr(2, 9);

                await database.ref('userQuizzes/' + gameData.user.uid + '/' + quizId).set({
                    ...quizData,
                    id: quizId,
                    authorId: gameData.user.uid,
                    authorName: gameData.user.displayName || gameData.user.email,
                    authorPhoto: gameData.user.photoURL,
                    createdAt: Date.now(),
                    isPublished: false,
                    playCount: 0,
                    rating: 0,
                    ratingsCount: 0
                });

                showNotification('Успех!', 'Опрос сохранен в вашей библиотеке', '#00ff9d');
                hideQuizCreator();
                loadUserQuizzes();
            } catch (error) {
                showNotification('Ошибка', 'Не удалось сохранить опрос', '#ff0000');
                console.error(error);
            }
        }

        // Опубликовать опрос
        async function publishQuiz() {
            if (!gameData.user || gameData.isGuest) {
                showNotification('Ошибка', 'Войдите в систему для публикации опросов', '#ff0000');
                return;
            }

            const quizData = collectQuizData();
            if (!validateQuiz(quizData)) return;

            try {
                const quizId = 'quiz_' + Date.now() + '_' + Math.random().toString(36).substr(2, 9);

                await database.ref('publishedQuizzes/' + quizId).set({
                    ...quizData,
                    id: quizId,
                    authorId: gameData.user.uid,
                    authorName: gameData.user.displayName || gameData.user.email,
                    authorPhoto: gameData.user.photoURL,
                    createdAt: Date.now(),
                    isPublished: true,
                    playCount: 0,
                    rating: 0,
                    ratingsCount: 0
                });

                // Также сохраняем в пользовательские
                await database.ref('userQuizzes/' + gameData.user.uid + '/' + quizId).set({
                    ...quizData,
                    id: quizId,
                    authorId: gameData.user.uid,
                    authorName: gameData.user.displayName || gameData.user.email,
                    authorPhoto: gameData.user.photoURL,
                    createdAt: Date.now(),
                    isPublished: true,
                    playCount: 0,
                    rating: 0,
                    ratingsCount: 0
                });

                showNotification('Успех!', 'Опрос опубликован и доступен всем!', '#00ff9d');
                hideQuizCreator();
                loadUserQuizzes();
                loadCustomQuizzes();
            } catch (error) {
                showNotification('Ошибка', 'Не удалось опубликовать опрос', '#ff0000');
                console.error(error);
            }
        }

        // Собрать данные опроса
        function collectQuizData() {
            const title = document.getElementById('quizTitle').value.trim();
            const description = document.getElementById('quizDescription').value.trim();
            const theme = document.querySelector('.quiz-theme-btn.active').dataset.theme;

            const questions = [];
            const questionItems = document.querySelectorAll('.question-item');

            questionItems.forEach((item, qIndex) => {
                const questionText = item.querySelector('.question-text').value.trim();
                const options = [];
                const optionInputs = item.querySelectorAll('.option-input');
                const correctIndex = parseInt(item.querySelector('.correct-option:checked').value);

                optionInputs.forEach((input, oIndex) => {
                    options.push(input.value.trim());
                });

                questions.push({
                    question: questionText,
                    options: options,
                    answer: correctIndex
                });
            });

            return {
                title: title || 'Без названия',
                description: description,
                theme: theme,
                questions: questions
            };
        }

        // Валидация опроса
        function validateQuiz(quizData) {
            if (!quizData.title || quizData.title.length < 3) {
                showNotification('Ошибка', 'Введите название опроса (минимум 3 символа)', '#ff0000');
                return false;
            }

            if (quizData.questions.length === 0) {
                showNotification('Ошибка', 'Добавьте хотя бы один вопрос', '#ff0000');
                return false;
            }

            for (const question of quizData.questions) {
                if (!question.question || question.question.length < 5) {
                    showNotification('Ошибка', 'Все вопросы должны содержать текст (минимум 5 символов)', '#ff0000');
                    return false;
                }

                if (question.options.length < 2) {
                    showNotification('Ошибка', 'В каждом вопросе должно быть минимум 2 варианта ответа', '#ff0000');
                    return false;
                }

                for (const option of question.options) {
                    if (!option || option.length === 0) {
                        showNotification('Ошибка', 'Все варианты ответов должны быть заполнены', '#ff0000');
                        return false;
                    }
                }

                if (question.answer < 0 || question.answer >= question.options.length) {
                    showNotification('Ошибка', 'Укажите правильный вариант ответа', '#ff0000');
                    return false;
                }
            }

            return true;
        }

        // Загрузить опросы пользователя
        async function loadUserQuizzes() {
            if (!gameData.user || gameData.isGuest) return;

            try {
                const snapshot = await database.ref('userQuizzes/' + gameData.user.uid).once('value');
                const quizzes = snapshot.val() || {};
                gameData.userQuizzes = Object.values(quizzes);

                displayUserQuizzes(gameData.userQuizzes);
            } catch (error) {
                console.error('Ошибка загрузки опросов:', error);
            }
        }

        // Загрузить опубликованные опросы
        async function loadCustomQuizzes() {
            try {
                const snapshot = await database.ref('publishedQuizzes').once('value');
                const quizzes = snapshot.val() || {};
                gameData.customQuizzes = {};

                // Организуем опросы по темам
                Object.values(quizzes).forEach(quiz => {
                    if (!gameData.customQuizzes[quiz.theme]) {
                        gameData.customQuizzes[quiz.theme] = [];
                    }
                    gameData.customQuizzes[quiz.theme] = gameData.customQuizzes[quiz.theme].concat(quiz.questions);
                });

                showNotification('Загружено', 'Доступны пользовательские опросы', '#00ff9d');
            } catch (error) {
                console.error('Ошибка загрузки пользовательских опросов:', error);
            }
        }

        // Отобразить опросы пользователя
        function displayUserQuizzes(quizzes) {
            const container = document.getElementById('userQuizzesList');

            if (quizzes.length === 0) {
                container.innerHTML = `
                    <div style="text-align: center; color: #aaa; padding: 40px; grid-column: 1 / -1;">
                        <i class="fas fa-book" style="font-size: 3rem; margin-bottom: 15px; opacity: 0.5;"></i>
                        <p>У вас пока нет сохраненных опросов</p>
                        <p style="font-size: 0.9rem; margin-top: 10px;">Создайте свой первый опрос!</p>
                    </div>
                `;
                return;
            }

            container.innerHTML = quizzes.map(quiz => `
                <div class="quiz-card">
                    <div class="quiz-title">${quiz.title}</div>
                    <div style="color: #aaa; font-size: 0.9rem;">
                        ${quiz.description || 'Без описания'}
                    </div>
                    <div class="quiz-stats">
                        <span><i class="fas fa-question-circle"></i> ${quiz.questions.length} вопросов</span>
                        <span><i class="fas fa-play-circle"></i> ${quiz.playCount || 0} игр</span>
                        <span><i class="fas fa-star"></i> ${quiz.rating || 0}/5</span>
                        <span><i class="fas fa-globe"></i> ${quiz.isPublished ? 'Опубликован' : 'Личный'}</span>
                    </div>
                    <div class="quiz-actions">
                        <button class="quiz-action-btn" onclick="useQuizInGame('${quiz.theme}', '${quiz.id}')">
                            <i class="fas fa-play"></i> Использовать
                        </button>
                        <button class="quiz-action-btn" onclick="deleteQuiz('${quiz.id}')" style="border-color: #ff0000;">
                            <i class="fas fa-trash"></i> Удалить
                        </button>
                    </div>
                </div>
            `).join('');
        }

        // Использовать опрос в игре (глобальная функция)
        window.useQuizInGame = function(theme, quizId) {
            if (!gameData.roomId || !gameData.isHost) {
                showNotification('Ошибка', 'Вы должны быть хостом комнаты', '#ff0000');
                return;
            }

            // Загружаем опрос из пользовательских
            const quiz = gameData.userQuizzes.find(q => q.id === quizId);
            if (quiz) {
                // Добавляем вопросы в пользовательские опросы для текущей темы
                if (!gameData.customQuizzes[theme]) {
                    gameData.customQuizzes[theme] = [];
                }
                gameData.customQuizzes[theme] = quiz.questions;

                // Меняем тему на нужную
                database.ref('rooms/' + gameData.roomId).update({
                    theme: theme
                });

                showNotification('Успех!', `Опрос "${quiz.title}" будет использоваться в игре`, '#00ff9d');
            }
        };

        // Удалить опрос (глобальная функция)
        window.deleteQuiz = function(quizId) {
            if (confirm('Вы уверены, что хотите удалить этот опрос?')) {
                database.ref('userQuizzes/' + gameData.user.uid + '/' + quizId).remove()
                    .then(() => {
                        showNotification('Успех', 'Опрос удален', '#00ff9d');
                        loadUserQuizzes();
                    })
                    .catch(error => {
                        showNotification('Ошибка', 'Не удалось удалить опрос', '#ff0000');
                    });
            }
        };

        // Уведомления
        function showNotification(title, text, color = '#00f3ff') {
            const notification = document.getElementById('notification');
            document.getElementById('notificationTitle').textContent = title;
            document.getElementById('notificationText').textContent = text;
            notification.style.borderColor = color;

            notification.style.display = 'block';

            setTimeout(() => {
                notification.style.display = 'none';
            }, 3000);
        }

        // Получить название темы
        function getThemeName(themeKey) {
            const themeNames = {
                'general': 'Общая',
                'science': 'Наука',
                'history': 'История',
                'geography': 'География',
                'entertainment': 'Кино и музыка',
                'sports': 'Спорт',
                'games': 'Игры',
                'custom': 'Своя тема'
            };

            return themeNames[themeKey] || 'Общая';
        }

        // Функции для копирования и шаринга кода комнаты
        window.copyRoomCode = function() {
            const code = document.getElementById('roomCode').textContent;
            navigator.clipboard.writeText(code).then(() => {
                showNotification('Скопировано!', 'Код комнаты скопирован в буфер обмена', '#00ff9d');
            });
        };

        window.shareRoomCode = function() {
            const code = document.getElementById('roomCode').textContent;
            if (navigator.share) {
                navigator.share({
                    title: 'Присоединяйтесь к Neon Quiz Battle!',
                    text: `Играйте со мной в Neon Quiz Battle! Код комнаты: ${code}`,
                    url: window.location.href
                });
            } else {
                copyRoomCode();
            }
        };

        // Очистка старых комнат
        setInterval(() => {
            if (!gameData.isHost) return;

            database.ref('rooms').once('value').then(snapshot => {
                const rooms = snapshot.val() || {};
                const now = Date.now();

                Object.keys(rooms).forEach(roomId => {
                    if (now - rooms[roomId].createdAt > 3600000) { // 1 час
                        database.ref('rooms/' + roomId).remove();
                    }
                });
            });
        }, 600000);

        // Проверка активности игроков
        setInterval(() => {
            if (!gameData.roomId || !gameData.playerId) return;

            // Обновляем время активности
            database.ref('rooms/' + gameData.roomId + '/players/' + gameData.playerId).update({
                lastActive: Date.now()
            });

            // Если хост, проверяем неактивных игроков
            if (gameData.isHost) {
                const now = Date.now();
                Object.keys(gameData.players).forEach(playerId => {
                    const player = gameData.players[playerId];
                    if (playerId !== gameData.playerId && now - player.lastActive > 30000) { // 30 секунд
                        // Удаляем неактивного игрока
                        database.ref('rooms/' + gameData.roomId + '/players/' + playerId).remove();
                        showNotification('Игрок отключен', `${player.name} был отключен за неактивность`);
                    }
                });
            }
        }, 10000);
    </script>
</body>

</html>
