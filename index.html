<!DOCTYPE html>
<html lang="ru">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Neon Quiz Battle - –û–Ω–ª–∞–π–Ω</title>
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css">
    <!-- Firebase SDK -->
    <script src="https://www.gstatic.com/firebasejs/9.22.0/firebase-app-compat.js"></script>
    <script src="https://www.gstatic.com/firebasejs/9.22.0/firebase-database-compat.js"></script>
    <script src="https://www.gstatic.com/firebasejs/9.22.0/firebase-auth-compat.js"></script>
    <style>
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
            font-family: 'Arial', sans-serif;
        }

        body {
            background: linear-gradient(135deg, #0a0a0a 0%, #1a1a2e 100%);
            color: #fff;
            min-height: 100vh;
            overflow-x: hidden;
        }

        .container {
            max-width: 1200px;
            margin: 0 auto;
            padding: 20px;
        }

        header {
            text-align: center;
            padding: 30px 0;
            border-bottom: 2px solid #00f3ff;
            margin-bottom: 30px;
            position: relative;
        }

        h1 {
            font-size: 3.5rem;
            background: linear-gradient(90deg, #ff00ff, #00f3ff, #ff00ff);
            background-size: 200% auto;
            -webkit-background-clip: text;
            -webkit-text-fill-color: transparent;
            animation: neonGlow 3s linear infinite;
            text-shadow: 0 0 15px rgba(255, 0, 255, 0.7);
            letter-spacing: 2px;
        }

        @keyframes neonGlow {
            0% { background-position: 0% center; }
            100% { background-position: 200% center; }
        }

        .room-controls {
            display: flex;
            gap: 15px;
            justify-content: center;
            margin: 20px 0;
            flex-wrap: wrap;
        }

        .room-input {
            padding: 12px 20px;
            background: rgba(0, 0, 30, 0.8);
            border: 2px solid #00f3ff;
            border-radius: 10px;
            color: white;
            font-size: 1rem;
            width: 300px;
            max-width: 100%;
        }

        .room-btn {
            padding: 12px 30px;
            background: linear-gradient(90deg, #ff00ff, #00f3ff);
            border: none;
            border-radius: 10px;
            color: black;
            font-weight: bold;
            cursor: pointer;
            transition: all 0.3s;
            font-size: 1rem;
        }

        .room-btn:hover {
            transform: scale(1.05);
            box-shadow: 0 0 15px #ff00ff;
        }

        .room-code-display {
            background: rgba(0, 20, 40, 0.9);
            border: 2px solid #00ff9d;
            border-radius: 10px;
            padding: 15px;
            margin: 20px auto;
            text-align: center;
            max-width: 500px;
            display: none;
        }

        .code {
            font-size: 2.5rem;
            font-weight: bold;
            color: #00ff9d;
            letter-spacing: 10px;
            margin: 10px 0;
            text-shadow: 0 0 10px #00ff9d;
        }

        .share-buttons {
            display: flex;
            gap: 10px;
            justify-content: center;
            margin-top: 15px;
        }

        .share-btn {
            padding: 10px 20px;
            background: rgba(0, 0, 30, 0.8);
            border: 1px solid #ff00ff;
            border-radius: 8px;
            color: white;
            cursor: pointer;
            transition: all 0.3s;
        }

        .share-btn:hover {
            background: #ff00ff;
            color: black;
        }

        .status-bar {
            display: flex;
            justify-content: space-between;
            background: rgba(0, 0, 30, 0.7);
            border: 1px solid #00f3ff;
            border-radius: 10px;
            padding: 15px;
            margin-bottom: 20px;
            box-shadow: 0 0 15px rgba(0, 243, 255, 0.3);
        }

        .player-count, .game-status, .topic, .room-info {
            font-size: 1.2rem;
        }

        .highlight {
            color: #ff00ff;
            font-weight: bold;
            text-shadow: 0 0 10px #ff00ff;
        }

        .main-content {
            display: flex;
            gap: 20px;
            flex-wrap: wrap;
        }

        .left-panel, .right-panel {
            flex: 1;
            min-width: 300px;
            background: rgba(20, 20, 40, 0.8);
            border-radius: 15px;
            border: 1px solid #ff00ff;
            padding: 20px;
            box-shadow: 0 0 20px rgba(255, 0, 255, 0.2);
        }

        .panel-title {
            color: #00f3ff;
            margin-bottom: 15px;
            font-size: 1.5rem;
            text-align: center;
            border-bottom: 1px solid #00f3ff;
            padding-bottom: 10px;
        }

        .player-list {
            list-style: none;
            margin-top: 15px;
        }

        .player-item {
            display: flex;
            align-items: center;
            padding: 10px;
            margin-bottom: 10px;
            background: rgba(0, 243, 255, 0.1);
            border-radius: 8px;
            border-left: 4px solid #ff00ff;
            position: relative;
        }

        .player-icon {
            margin-right: 10px;
            color: #ff00ff;
        }

        .player-score {
            margin-left: auto;
            color: #00ff9d;
            font-weight: bold;
            margin-right: 10px;
        }

        .host-badge {
            background: #ff00ff;
            color: black;
            padding: 2px 8px;
            border-radius: 12px;
            font-size: 0.8rem;
            margin-left: 10px;
            font-weight: bold;
        }

        .kick-btn {
            background: rgba(255, 0, 0, 0.3);
            color: white;
            border: 1px solid #ff0000;
            border-radius: 5px;
            padding: 3px 8px;
            font-size: 0.8rem;
            cursor: pointer;
            margin-left: 5px;
            display: none;
        }

        .kick-btn:hover {
            background: rgba(255, 0, 0, 0.7);
        }

        .join-form {
            display: flex;
            flex-direction: column;
            gap: 15px;
            margin-top: 20px;
        }

        input, select, button {
            padding: 12px;
            border-radius: 8px;
            border: none;
            font-size: 1rem;
        }

        input, select {
            background: rgba(0, 0, 20, 0.8);
            color: white;
            border: 1px solid #00f3ff;
        }

        button:disabled {
            opacity: 0.5;
            cursor: not-allowed;
        }

        button:disabled:hover {
            transform: none;
            box-shadow: none;
        }

        .game-area {
            display: none;
            margin-top: 20px;
        }

        .question-box {
            background: rgba(0, 10, 30, 0.9);
            border-radius: 15px;
            padding: 25px;
            border: 2px solid #00f3ff;
            margin-bottom: 25px;
            box-shadow: 0 0 20px rgba(0, 243, 255, 0.4);
        }

        .question-text {
            font-size: 1.4rem;
            margin-bottom: 20px;
            line-height: 1.5;
            color: #ffffff;
        }

        .options-grid {
            display: grid;
            grid-template-columns: repeat(2, 1fr);
            gap: 15px;
            margin-top: 20px;
        }

        @media (max-width: 768px) {
            .options-grid {
                grid-template-columns: 1fr;
            }
        }

        .option {
            background: rgba(20, 20, 50, 0.8);
            padding: 15px;
            border-radius: 10px;
            cursor: pointer;
            transition: all 0.3s;
            border: 1px solid transparent;
            text-align: center;
            font-size: 1.1rem;
        }

        .option:hover:not(.disabled) {
            transform: translateY(-5px);
            border-color: #ff00ff;
            box-shadow: 0 5px 15px rgba(255, 0, 255, 0.4);
        }

        .option.disabled {
            cursor: not-allowed;
            opacity: 0.7;
        }

        .option.correct {
            background: rgba(0, 255, 157, 0.3);
            border-color: #00ff9d;
        }

        .option.incorrect {
            background: rgba(255, 0, 0, 0.3);
            border-color: #ff0000;
        }

        .timer {
            text-align: center;
            font-size: 1.8rem;
            color: #ff00ff;
            margin: 20px 0;
            font-weight: bold;
        }

        .results {
            display: none;
            text-align: center;
            padding: 20px;
            background: rgba(0, 20, 40, 0.9);
            border-radius: 15px;
            border: 2px solid #00ff9d;
            margin-top: 20px;
        }

        .correct-answer-box {
            background: rgba(0, 255, 157, 0.1);
            border: 2px solid #00ff9d;
            border-radius: 10px;
            padding: 15px;
            margin: 15px 0;
        }

        .correct-answer-text {
            color: #00ff9d;
            font-size: 1.3rem;
            margin: 10px 0;
            text-shadow: 0 0 10px #00ff9d;
        }

        .answer-stats {
            display: flex;
            justify-content: space-around;
            margin: 15px 0;
            padding: 10px;
            background: rgba(0, 0, 30, 0.5);
            border-radius: 10px;
        }

        .stat-item {
            text-align: center;
        }

        .stat-value {
            font-size: 1.5rem;
            font-weight: bold;
            color: #ff00ff;
        }

        .stat-label {
            font-size: 0.9rem;
            color: #aaa;
        }

        .scoreboard {
            margin-top: 20px;
        }

        .theme-selector {
            display: flex;
            flex-wrap: wrap;
            gap: 10px;
            margin-top: 15px;
            justify-content: center;
        }

        .theme-btn {
            padding: 8px 15px;
            border-radius: 20px;
            background: rgba(0, 0, 30, 0.8);
            border: 1px solid #ff00ff;
            color: white;
            cursor: pointer;
            transition: all 0.3s;
        }

        .theme-btn:hover {
            background: #ff00ff;
            color: black;
        }

        .active-theme {
            background: #ff00ff;
            color: black;
            font-weight: bold;
        }

        .notification {
            position: fixed;
            top: 20px;
            right: 20px;
            background: rgba(0, 20, 40, 0.95);
            border: 2px solid #00f3ff;
            border-radius: 10px;
            padding: 15px;
            display: none;
            z-index: 100;
            max-width: 300px;
            box-shadow: 0 0 20px rgba(0, 243, 255, 0.7);
        }

        .chat-container {
            margin-top: 20px;
            max-height: 300px;
            overflow-y: auto;
        }

        .chat-messages {
            height: 200px;
            overflow-y: auto;
            padding: 10px;
            background: rgba(0, 0, 20, 0.8);
            border-radius: 10px;
            margin-bottom: 10px;
            border: 1px solid #00f3ff;
        }

        .chat-input {
            display: flex;
            gap: 10px;
        }

        .message {
            padding: 8px;
            margin-bottom: 5px;
            border-radius: 8px;
            background: rgba(0, 243, 255, 0.1);
            border-left: 3px solid #ff00ff;
        }

        .message-sender {
            color: #ff00ff;
            font-weight: bold;
        }

        footer {
            text-align: center;
            margin-top: 30px;
            padding-top: 20px;
            border-top: 1px solid #00f3ff;
            color: #aaa;
            font-size: 0.9rem;
        }

        .pulse {
            animation: pulse 1.5s infinite;
        }

        @keyframes pulse {
            0% { opacity: 1; }
            50% { opacity: 0.6; }
            100% { opacity: 1; }
        }

        .loader {
            display: inline-block;
            width: 20px;
            height: 20px;
            border: 3px solid #ff00ff;
            border-radius: 50%;
            border-top-color: transparent;
            animation: spin 1s linear infinite;
            margin-right: 10px;
        }

        @keyframes spin {
            to { transform: rotate(360deg); }
        }

        .waiting-players {
            text-align: center;
            padding: 30px;
            color: #aaa;
        }

        .end-game-results {
            display: none;
            text-align: center;
            padding: 30px;
            background: rgba(0, 10, 30, 0.95);
            border-radius: 15px;
            border: 2px solid #ff00ff;
            margin-top: 20px;
        }

        .final-winner {
            color: #ff00ff;
            font-size: 2.5rem;
            margin: 20px 0;
            text-shadow: 0 0 15px #ff00ff;
        }

        .trophy-icon {
            font-size: 4rem;
            color: gold;
            margin: 20px 0;
        }

        .control-buttons {
            display: flex;
            gap: 10px;
            justify-content: center;
            margin-top: 20px;
        }

        .correct-players-list {
            margin-top: 10px;
            padding: 10px;
            background: rgba(0, 255, 157, 0.1);
            border-radius: 8px;
        }

        .correct-player {
            color: #00ff9d;
            margin: 5px 0;
        }

        /* –°—Ç–∏–ª–∏ –¥–ª—è –∞–≤—Ç–æ—Ä–∏–∑–∞—Ü–∏–∏ –∏ —Å–æ–∑–¥–∞–Ω–∏—è –æ–ø—Ä–æ—Å–æ–≤ */
        .auth-container {
            display: none;
            flex-direction: column;
            align-items: center;
            justify-content: center;
            padding: 40px;
            background: rgba(20, 20, 40, 0.9);
            border-radius: 15px;
            border: 2px solid #ff00ff;
            max-width: 500px;
            margin: 50px auto;
            box-shadow: 0 0 30px rgba(255, 0, 255, 0.3);
        }

        .auth-title {
            color: #00f3ff;
            font-size: 2rem;
            margin-bottom: 20px;
            text-align: center;
        }

        .auth-buttons {
            display: flex;
            flex-direction: column;
            gap: 15px;
            width: 100%;
            margin-top: 20px;
        }

        .auth-btn {
            padding: 15px;
            border-radius: 10px;
            border: 2px solid #00f3ff;
            background: rgba(0, 0, 30, 0.8);
            color: white;
            font-size: 1.1rem;
            cursor: pointer;
            transition: all 0.3s;
            display: flex;
            align-items: center;
            justify-content: center;
            gap: 10px;
        }

        .auth-btn:hover {
            background: linear-gradient(90deg, #ff00ff, #00f3ff);
            color: black;
            transform: scale(1.05);
        }

        .auth-input {
            width: 100%;
            padding: 12px;
            margin: 10px 0;
            background: rgba(0, 0, 20, 0.8);
            border: 2px solid #00f3ff;
            border-radius: 8px;
            color: white;
            font-size: 1rem;
        }

        .user-profile {
            display: none;
            align-items: center;
            gap: 10px;
            position: absolute;
            top: 20px;
            right: 20px;
            background: rgba(0, 20, 40, 0.9);
            padding: 10px 15px;
            border-radius: 10px;
            border: 2px solid #00ff9d;
        }

        .user-avatar {
            width: 40px;
            height: 40px;
            border-radius: 50%;
            border: 2px solid #ff00ff;
        }

        .user-name {
            color: white;
            font-weight: bold;
        }

        .logout-btn {
            background: rgba(255, 0, 0, 0.3);
            color: white;
            border: 1px solid #ff0000;
            border-radius: 5px;
            padding: 5px 10px;
            cursor: pointer;
            margin-left: 10px;
        }

        .logout-btn:hover {
            background: rgba(255, 0, 0, 0.7);
        }

        .create-quiz-btn {
            display: none;
            position: absolute;
            top: 20px;
            left: 20px;
            background: linear-gradient(90deg, #ff00ff, #00f3ff);
            color: black;
            padding: 10px 20px;
            border-radius: 10px;
            font-weight: bold;
            cursor: pointer;
            border: none;
            z-index: 100;
        }

        .create-quiz-btn:hover {
            transform: scale(1.05);
            box-shadow: 0 0 15px #ff00ff;
        }

        .quiz-creator-modal {
            display: none;
            position: fixed;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            background: rgba(0, 0, 0, 0.9);
            z-index: 1000;
            overflow-y: auto;
            padding: 20px;
        }

        .quiz-creator-content {
            max-width: 800px;
            margin: 50px auto;
            background: rgba(20, 20, 40, 0.95);
            border-radius: 15px;
            border: 2px solid #00f3ff;
            padding: 30px;
            box-shadow: 0 0 40px rgba(0, 243, 255, 0.5);
        }

        .quiz-form {
            display: flex;
            flex-direction: column;
            gap: 20px;
        }

        .form-group {
            margin-bottom: 15px;
        }

        .form-label {
            color: #00f3ff;
            margin-bottom: 5px;
            display: block;
            font-weight: bold;
        }

        .question-item {
            background: rgba(0, 0, 30, 0.8);
            border: 1px solid #ff00ff;
            border-radius: 10px;
            padding: 15px;
            margin-bottom: 15px;
            position: relative;
        }

        .remove-question-btn {
            position: absolute;
            top: 10px;
            right: 10px;
            background: rgba(255, 0, 0, 0.3);
            color: white;
            border: 1px solid #ff0000;
            border-radius: 5px;
            padding: 5px 10px;
            cursor: pointer;
        }

        .option-row {
            display: flex;
            align-items: center;
            gap: 10px;
            margin-bottom: 8px;
        }

        .correct-option {
            width: 20px;
            height: 20px;
            accent-color: #00ff9d;
        }

        .add-question-btn, .add-option-btn {
            background: rgba(0, 150, 255, 0.3);
            color: white;
            border: 1px solid #00aaff;
            border-radius: 5px;
            padding: 8px 15px;
            cursor: pointer;
            margin-top: 10px;
        }

        .add-question-btn:hover, .add-option-btn:hover {
            background: rgba(0, 150, 255, 0.7);
        }

        .quiz-preview {
            margin-top: 20px;
            padding: 20px;
            background: rgba(0, 10, 30, 0.8);
            border-radius: 10px;
            border: 1px solid #00ff9d;
        }

        .quiz-theme-selector {
            display: flex;
            gap: 10px;
            flex-wrap: wrap;
            margin-top: 10px;
        }

        .quiz-theme-btn {
            padding: 8px 15px;
            background: rgba(0, 0, 30, 0.8);
            border: 1px solid #ff00ff;
            color: white;
            border-radius: 20px;
            cursor: pointer;
        }

        .quiz-theme-btn.active {
            background: #ff00ff;
            color: black;
        }

        .user-quizzes-container {
            display: none;
            margin-top: 30px;
            padding: 20px;
            background: rgba(0, 10, 30, 0.9);
            border-radius: 15px;
            border: 2px solid #00ff9d;
        }

        .user-quizzes-list {
            display: grid;
            grid-template-columns: repeat(auto-fill, minmax(300px, 1fr));
            gap: 15px;
            margin-top: 20px;
        }

        .quiz-card {
            background: rgba(20, 20, 50, 0.8);
            border: 1px solid #ff00ff;
            border-radius: 10px;
            padding: 15px;
            transition: all 0.3s;
        }

        .quiz-card:hover {
            transform: translateY(-5px);
            box-shadow: 0 5px 15px rgba(255, 0, 255, 0.4);
        }

        .quiz-title {
            color: #00f3ff;
            font-size: 1.2rem;
            margin-bottom: 10px;
        }

        .quiz-stats {
            display: flex;
            justify-content: space-between;
            color: #aaa;
            font-size: 0.9rem;
            margin-top: 10px;
        }

        .quiz-actions {
            display: flex;
            gap: 10px;
            margin-top: 15px;
        }

        .quiz-action-btn {
            padding: 5px 10px;
            background: rgba(0, 0, 30, 0.8);
            border: 1px solid #00f3ff;
            color: white;
            border-radius: 5px;
            cursor: pointer;
            font-size: 0.9rem;
        }

        .quiz-action-btn:hover {
            background: #00f3ff;
            color: black;
        }

        /* –û–±–Ω–æ–≤–ª—è–µ–º —Å—É—â–µ—Å—Ç–≤—É—é—â–∏–µ —Å—Ç–∏–ª–∏ */
        .room-controls {
            margin-top: 70px;
        }
    </style>
</head>
<body>
    <!-- –ö–Ω–æ–ø–∫–∞ —Å–æ–∑–¥–∞–Ω–∏—è –æ–ø—Ä–æ—Å–∞ -->
    <button id="createQuizBtn" class="create-quiz-btn" style="display: none;">
        <i class="fas fa-plus-circle"></i> –°–û–ó–î–ê–¢–¨ –û–ü–†–û–°
    </button>

    <!-- –ü—Ä–æ—Ñ–∏–ª—å –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è -->
    <div id="userProfile" class="user-profile" style="display: none;">
        <img id="userAvatar" class="user-avatar" src="" alt="–ê–≤–∞—Ç–∞—Ä">
        <div>
            <div class="user-name" id="userDisplayName"></div>
            <button id="logoutBtn" class="logout-btn">–í—ã–π—Ç–∏</button>
        </div>
    </div>

    <!-- –ú–æ–¥–∞–ª—å–Ω–æ–µ –æ–∫–Ω–æ —Å–æ–∑–¥–∞–Ω–∏—è –æ–ø—Ä–æ—Å–∞ -->
    <div id="quizCreatorModal" class="quiz-creator-modal">
        <div class="quiz-creator-content">
            <h2 class="auth-title"><i class="fas fa-edit"></i> –°–û–ó–î–ê–ù–ò–ï –û–ü–†–û–°–ê</h2>

            <div class="quiz-form">
                <div class="form-group">
                    <label class="form-label">–ù–∞–∑–≤–∞–Ω–∏–µ –æ–ø—Ä–æ—Å–∞:</label>
                    <input type="text" id="quizTitle" class="auth-input" placeholder="–í–≤–µ–¥–∏—Ç–µ –Ω–∞–∑–≤–∞–Ω–∏–µ –æ–ø—Ä–æ—Å–∞" maxlength="100">
                </div>

                <div class="form-group">
                    <label class="form-label">–¢–µ–º–∞:</label>
                    <div class="quiz-theme-selector">
                        <div class="quiz-theme-btn active" data-theme="custom">–°–≤–æ—è</div>
                        <div class="quiz-theme-btn" data-theme="general">–û–±—â–∞—è</div>
                        <div class="quiz-theme-btn" data-theme="science">–ù–∞—É–∫–∞</div>
                        <div class="quiz-theme-btn" data-theme="history">–ò—Å—Ç–æ—Ä–∏—è</div>
                        <div class="quiz-theme-btn" data-theme="geography">–ì–µ–æ–≥—Ä–∞—Ñ–∏—è</div>
                        <div class="quiz-theme-btn" data-theme="entertainment">–ö–∏–Ω–æ –∏ –º—É–∑—ã–∫–∞</div>
                        <div class="quiz-theme-btn" data-theme="sports">–°–ø–æ—Ä—Ç</div>
                        <div class="quiz-theme-btn" data-theme="games">–ò–≥—Ä—ã</div>
                    </div>
                </div>

                <div id="questionsContainer">
                    <!-- –í–æ–ø—Ä–æ—Å—ã –±—É–¥—É—Ç –¥–æ–±–∞–≤–ª—è—Ç—å—Å—è –∑–¥–µ—Å—å -->
                    <div class="question-item" data-index="0">
                        <div class="form-group">
                            <label class="form-label">–í–æ–ø—Ä–æ—Å 1:</label>
                            <input type="text" class="auth-input question-text" placeholder="–í–≤–µ–¥–∏—Ç–µ —Ç–µ–∫—Å—Ç –≤–æ–ø—Ä–æ—Å–∞" maxlength="200">
                        </div>

                        <div class="options-container">
                            <div class="option-row">
                                <input type="radio" name="correct0" class="correct-option" value="0" checked>
                                <input type="text" class="auth-input option-input" placeholder="–í–∞—Ä–∏–∞–Ω—Ç –æ—Ç–≤–µ—Ç–∞ 1" maxlength="100">
                                <button class="remove-option-btn" onclick="removeOption(this)">√ó</button>
                            </div>
                            <div class="option-row">
                                <input type="radio" name="correct0" class="correct-option" value="1">
                                <input type="text" class="auth-input option-input" placeholder="–í–∞—Ä–∏–∞–Ω—Ç –æ—Ç–≤–µ—Ç–∞ 2" maxlength="100">
                                <button class="remove-option-btn" onclick="removeOption(this)">√ó</button>
                            </div>
                        </div>
                        <button class="add-option-btn" onclick="addOption(this)"><i class="fas fa-plus"></i> –î–æ–±–∞–≤–∏—Ç—å –≤–∞—Ä–∏–∞–Ω—Ç</button>
                        <button class="remove-question-btn" onclick="removeQuestion(this)"><i class="fas fa-trash"></i> –£–¥–∞–ª–∏—Ç—å –≤–æ–ø—Ä–æ—Å</button>
                    </div>
                </div>

                <button id="addQuestionBtn" class="add-question-btn"><i class="fas fa-plus-circle"></i> –î–æ–±–∞–≤–∏—Ç—å –≤–æ–ø—Ä–æ—Å</button>

                <div class="quiz-preview">
                    <h3 style="color: #00f3ff;">–ü—Ä–µ–¥–ø—Ä–æ—Å–º–æ—Ç—Ä:</h3>
                    <div id="quizPreview"></div>
                </div>

                <div class="control-buttons" style="margin-top: 20px;">
                    <button id="saveQuizBtn" class="room-btn" style="background: #00ff9d;">
                        <i class="fas fa-save"></i> –°–û–•–†–ê–ù–ò–¢–¨ –û–ü–†–û–°
                    </button>
                    <button id="cancelQuizBtn" class="room-btn" style="background: rgba(255, 0, 0, 0.7);">
                        <i class="fas fa-times"></i> –û–¢–ú–ï–ù–ê
                    </button>
                    <button id="publishQuizBtn" class="room-btn" style="background: #ff00ff;">
                        <i class="fas fa-globe"></i> –û–ü–£–ë–õ–ò–ö–û–í–ê–¢–¨
                    </button>
                </div>
            </div>
        </div>
    </div>

    <!-- –ö–æ–Ω—Ç–µ–π–Ω–µ—Ä –¥–ª—è –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å—Å–∫–∏—Ö –æ–ø—Ä–æ—Å–æ–≤ -->
    <div id="userQuizzesContainer" class="user-quizzes-container">
        <h2 class="auth-title"><i class="fas fa-book"></i> –ú–û–ò –û–ü–†–û–°–´</h2>
        <div id="userQuizzesList" class="user-quizzes-list">
            <!-- –û–ø—Ä–æ—Å—ã –±—É–¥—É—Ç –∑–∞–≥—Ä—É–∂–∞—Ç—å—Å—è –∑–¥–µ—Å—å -->
        </div>
    </div>

    <div class="container">
        <header>
            <h1><i class="fas fa-gamepad"></i> NEON QUIZ BATTLE ONLINE</h1>
            <p style="margin-top: 10px; color: #aaa;">–û–Ω–ª–∞–π–Ω-–≤–∏–∫—Ç–æ—Ä–∏–Ω–∞ –≤ —Ä–µ–∞–ª—å–Ω–æ–º –≤—Ä–µ–º–µ–Ω–∏ —Å –¥—Ä—É–∑—å—è–º–∏!</p>
        </header>

        <!-- –ö–æ–Ω—Ç–µ–π–Ω–µ—Ä –∞–≤—Ç–æ—Ä–∏–∑–∞—Ü–∏–∏ -->
        <div id="authContainer" class="auth-container">
            <h2 class="auth-title"><i class="fas fa-user-circle"></i> –ê–í–¢–û–†–ò–ó–ê–¶–ò–Ø</h2>
            <p style="color: #aaa; text-align: center; margin-bottom: 20px;">
                –í–æ–π–¥–∏—Ç–µ, —á—Ç–æ–±—ã —Å–æ–∑–¥–∞–≤–∞—Ç—å —Å–≤–æ–∏ –æ–ø—Ä–æ—Å—ã, —Å–æ—Ö—Ä–∞–Ω—è—Ç—å —Å—Ç–∞—Ç–∏—Å—Ç–∏–∫—É –∏ –±–æ–ª—å—à–µ!
            </p>

            <div class="auth-buttons">
                <input type="email" id="emailInput" class="auth-input" placeholder="Email">
                <input type="password" id="passwordInput" class="auth-input" placeholder="–ü–∞—Ä–æ–ª—å">

                <button id="emailSignInBtn" class="auth-btn">
                    <i class="fas fa-envelope"></i> –í–æ–π—Ç–∏ –ø–æ Email
                </button>
                <button id="emailSignUpBtn" class="auth-btn" style="background: rgba(0, 150, 255, 0.3);">
                    <i class="fas fa-user-plus"></i> –ó–∞—Ä–µ–≥–∏—Å—Ç—Ä–∏—Ä–æ–≤–∞—Ç—å—Å—è
                </button>

                <button id="continueAsGuest" class="auth-btn" style="background: rgba(100, 100, 100, 0.3);">
                    <i class="fas fa-user"></i> –ü—Ä–æ–¥–æ–ª–∂–∏—Ç—å –∫–∞–∫ –≥–æ—Å—Ç—å
                </button>
            </div>
        </div>

        <!-- –û–°–ù–û–í–ù–û–ô –ò–ù–¢–ï–†–§–ï–ô–° –ò–ì–†–´ -->
        <div class="room-controls" style="display: none;">
            <input type="text" id="playerNameInput" class="room-input" placeholder="–í–≤–µ–¥–∏—Ç–µ –≤–∞—à–µ –∏–º—è" value="–ò–≥—Ä–æ–∫">
            <button id="createRoomBtn" class="room-btn"><i class="fas fa-plus"></i> –°–û–ó–î–ê–¢–¨ –ö–û–ú–ù–ê–¢–£</button>
            <input type="text" id="roomCodeInput" class="room-input" placeholder="–í–≤–µ–¥–∏—Ç–µ –∫–æ–¥ –∫–æ–º–Ω–∞—Ç—ã">
            <button id="joinRoomBtn" class="room-btn"><i class="fas fa-sign-in-alt"></i> –ü–†–ò–°–û–ï–î–ò–ù–ò–¢–¨–°–Ø</button>
        </div>

        <div class="room-code-display" id="roomCodeDisplay">
            <h3>–ö–û–î –ö–û–ú–ù–ê–¢–´</h3>
            <div class="code" id="roomCode">XXXXXX</div>
            <p>–ü–æ–¥–µ–ª–∏—Ç–µ—Å—å —ç—Ç–∏–º –∫–æ–¥–æ–º —Å –¥—Ä—É–∑—å—è–º–∏</p>
            <div class="share-buttons">
                <button class="share-btn" onclick="copyRoomCode()"><i class="fas fa-copy"></i> –ö–æ–ø–∏—Ä–æ–≤–∞—Ç—å</button>
                <button class="share-btn" onclick="shareRoomCode()"><i class="fas fa-share-alt"></i> –ü–æ–¥–µ–ª–∏—Ç—å—Å—è</button>
            </div>
        </div>

        <div class="status-bar">
            <div class="room-info">–ö–æ–º–Ω–∞—Ç–∞: <span class="highlight" id="roomName">–ù–µ –ø–æ–¥–∫–ª—é—á–µ–Ω–æ</span></div>
            <div class="player-count">–ò–≥—Ä–æ–∫–æ–≤: <span class="highlight" id="onlineCount">0</span>/8</div>
            <div class="game-status">–°—Ç–∞—Ç—É—Å: <span class="highlight" id="gameStatus">–û–∂–∏–¥–∞–Ω–∏–µ</span></div>
            <div class="topic">–¢–µ–º–∞: <span class="highlight" id="currentTopic">–û–±—â–∞—è</span></div>
        </div>

        <div class="main-content" id="gameInterface" style="display: none;">
            <div class="left-panel">
                <h2 class="panel-title"><i class="fas fa-users"></i> –ò–≥—Ä–æ–∫–∏ –≤ –∫–æ–º–Ω–∞—Ç–µ</h2>
                <div class="waiting-players" id="waitingMessage">
                    <i class="fas fa-hourglass-half" style="font-size: 2rem; margin-bottom: 10px;"></i>
                    <p>–û–∂–∏–¥–∞–Ω–∏–µ –ø–æ–¥–∫–ª—é—á–µ–Ω–∏—è –¥—Ä—É–≥–∏—Ö –∏–≥—Ä–æ–∫–æ–≤...</p>
                    <p>–ü–æ–¥–µ–ª–∏—Ç–µ—Å—å –∫–æ–¥–æ–º –∫–æ–º–Ω–∞—Ç—ã —Å –¥—Ä—É–∑—å—è–º–∏!</p>
                </div>
                <ul class="player-list" id="playerList">
                    <!-- –ò–≥—Ä–æ–∫–∏ –±—É–¥—É—Ç –¥–æ–±–∞–≤–ª—è—Ç—å—Å—è –∑–¥–µ—Å—å -->
                </ul>

                <div class="theme-selector" id="themeSelector" style="display: none;">
                    <div class="panel-title">–í—ã–±–µ—Ä–∏—Ç–µ —Ç–µ–º—É</div>
                    <div class="theme-btn active-theme" data-theme="general">–û–±—â–∞—è</div>
                    <div class="theme-btn" data-theme="science">–ù–∞—É–∫–∞</div>
                    <div class="theme-btn" data-theme="history">–ò—Å—Ç–æ—Ä–∏—è</div>
                    <div class="theme-btn" data-theme="geography">–ì–µ–æ–≥—Ä–∞—Ñ–∏—è</div>
                    <div class="theme-btn" data-theme="entertainment">–ö–∏–Ω–æ –∏ –º—É–∑—ã–∫–∞</div>
                    <div class="theme-btn" data-theme="sports">–°–ø–æ—Ä—Ç</div>
                    <div class="theme-btn" data-theme="games">–ò–≥—Ä—ã</div>
                </div>

                <div class="chat-container" id="chatContainer" style="display: none;">
                    <div class="panel-title"><i class="fas fa-comments"></i> –ß–∞—Ç</div>
                    <div class="chat-messages" id="chatMessages">
                        <!-- –°–æ–æ–±—â–µ–Ω–∏—è —á–∞—Ç–∞ -->
                    </div>
                    <div class="chat-input">
                        <input type="text" id="chatInput" placeholder="–í–≤–µ–¥–∏—Ç–µ —Å–æ–æ–±—â–µ–Ω–∏–µ..." class="room-input">
                        <button id="sendMessageBtn" class="room-btn"><i class="fas fa-paper-plane"></i></button>
                    </div>
                </div>
            </div>

            <div class="right-panel">
                <div id="lobbyView">
                    <h2 class="panel-title"><i class="fas fa-door-open"></i> –õ–û–ë–ë–ò</h2>
                    <div style="text-align: center; padding: 20px;">
                        <p id="hostMessage" style="display: none;">–í—ã —Å–æ–∑–¥–∞—Ç–µ–ª—å –∫–æ–º–Ω–∞—Ç—ã. –ù–∞—á–Ω–∏—Ç–µ –∏–≥—Ä—É, –∫–æ–≥–¥–∞ –≤—Å–µ –ø–æ–¥–∫–ª—é—á–∞—Ç—Å—è!</p>
                        <p id="guestMessage" style="display: none;">–û–∂–∏–¥–∞–π—Ç–µ, –ø–æ–∫–∞ —Å–æ–∑–¥–∞—Ç–µ–ª—å –∫–æ–º–Ω–∞—Ç—ã –Ω–∞—á–Ω–µ—Ç –∏–≥—Ä—É...</p>

                        <button id="startGameBtn" class="room-btn" style="margin-top: 20px; display: none;">
                            <i class="fas fa-play"></i> –ù–ê–ß–ê–¢–¨ –ò–ì–†–£
                        </button>

                        <button id="readyBtn" class="room-btn" style="margin-top: 20px; display: none;">
                            <i class="fas fa-check"></i> –ì–û–¢–û–í
                        </button>

                        <div class="control-buttons">
                            <button id="leaveRoomBtn" class="room-btn" style="background: rgba(255, 0, 0, 0.7);">
                                <i class="fas fa-sign-out-alt"></i> –ü–û–ö–ò–ù–£–¢–¨ –ö–û–ú–ù–ê–¢–£
                            </button>
                            <button id="backToMainBtn" class="room-btn" style="background: rgba(0, 150, 255, 0.7);">
                                <i class="fas fa-home"></i> –ì–õ–ê–í–ù–û–ï –ú–ï–ù–Æ
                            </button>
                        </div>
                    </div>
                </div>

                <div class="game-area" id="gameArea">
                    <div class="question-box">
                        <div class="question-text" id="questionText">–ó–¥–µ—Å—å –±—É–¥–µ—Ç –≤–æ–ø—Ä–æ—Å</div>
                        <div class="options-grid" id="optionsGrid">
                            <!-- –í–∞—Ä–∏–∞–Ω—Ç—ã –æ—Ç–≤–µ—Ç–æ–≤ –±—É–¥—É—Ç –∑–¥–µ—Å—å -->
                        </div>
                    </div>

                    <div class="timer" id="timer">30</div>
                </div>

                <div class="results" id="results">
                    <h2 class="panel-title"><i class="fas fa-chart-bar"></i> –†–ï–ó–£–õ–¨–¢–ê–¢–´ –†–ê–£–ù–î–ê</h2>

                    <div class="correct-answer-box">
                        <div style="color: #00f3ff; font-size: 1.1rem;">–ü–†–ê–í–ò–õ–¨–ù–´–ô –û–¢–í–ï–¢:</div>
                        <div class="correct-answer-text" id="correctAnswerText"></div>
                        <div id="correctPlayersContainer" style="display: none;">
                            <div style="margin-top: 10px; color: #aaa;">–ü—Ä–∞–≤–∏–ª—å–Ω–æ –æ—Ç–≤–µ—Ç–∏–ª–∏:</div>
                            <div class="correct-players-list" id="correctPlayersList">
                                <!-- –°–ø–∏—Å–æ–∫ –∏–≥—Ä–æ–∫–æ–≤, –æ—Ç–≤–µ—Ç–∏–≤—à–∏—Ö –ø—Ä–∞–≤–∏–ª—å–Ω–æ -->
                            </div>
                        </div>
                    </div>

                    <div class="answer-stats">
                        <div class="stat-item">
                            <div class="stat-value" id="correctCount">0</div>
                            <div class="stat-label">–ü—Ä–∞–≤–∏–ª—å–Ω–æ</div>
                        </div>
                        <div class="stat-item">
                            <div class="stat-value" id="totalPlayersCount">0</div>
                            <div class="stat-label">–í—Å–µ–≥–æ –∏–≥—Ä–æ–∫–æ–≤</div>
                        </div>
                        <div class="stat-item">
                            <div class="stat-value" id="correctPercentage">0%</div>
                            <div class="stat-label">–ü—Ä–æ—Ü–µ–Ω—Ç –≤–µ—Ä–Ω—ã—Ö</div>
                        </div>
                    </div>

                    <div class="scoreboard" id="scoreboard">
                        <!-- –¢–∞–±–ª–∏—Ü–∞ —Ä–µ–∑—É–ª—å—Ç–∞—Ç–æ–≤ –±—É–¥–µ—Ç –∑–¥–µ—Å—å -->
                    </div>
                    <button id="nextRoundBtn" class="room-btn" style="margin-top: 20px; display: none;">
                        <i class="fas fa-forward"></i> –°–õ–ï–î–£–Æ–©–ò–ô –†–ê–£–ù–î
                    </button>
                    <button id="endGameBtn" class="room-btn" style="margin-top: 20px; display: none; background: rgba(255, 0, 0, 0.7);">
                        <i class="fas fa-flag-checkered"></i> –ó–ê–í–ï–†–®–ò–¢–¨ –ò–ì–†–£
                    </button>
                </div>

                <div class="end-game-results" id="endGameResults">
                    <div class="trophy-icon">
                        <i class="fas fa-trophy"></i>
                    </div>
                    <h2 class="final-winner" id="finalWinnerName">–ü–û–ë–ï–î–ò–¢–ï–õ–¨ –ò–ì–†–´!</h2>
                    <div class="scoreboard" id="finalScoreboard">
                        <!-- –§–∏–Ω–∞–ª—å–Ω–∞—è —Ç–∞–±–ª–∏—Ü–∞ —Ä–µ–∑—É–ª—å—Ç–∞—Ç–æ–≤ -->
                    </div>
                    <div class="control-buttons">
                        <button id="playAgainBtn" class="room-btn">
                            <i class="fas fa-redo"></i> –ò–ì–†–ê–¢–¨ –ï–©–ï
                        </button>
                        <button id="backToLobbyBtn" class="room-btn">
                            <i class="fas fa-door-open"></i> –í –õ–û–ë–ë–ò
                        </button>
                    </div>
                </div>
            </div>
        </div>

        <div class="notification" id="notification">
            <strong id="notificationTitle">–£–≤–µ–¥–æ–º–ª–µ–Ω–∏–µ</strong>
            <p id="notificationText">–¢–µ–∫—Å—Ç —É–≤–µ–¥–æ–º–ª–µ–Ω–∏—è</p>
        </div>

        <footer>
            <p>Neon Quiz Battle Online &copy; 2023 | –û–Ω–ª–∞–π–Ω-–≤–∏–∫—Ç–æ—Ä–∏–Ω–∞ —Å –¥—Ä—É–∑—å—è–º–∏ –≤ —Ä–µ–∞–ª—å–Ω–æ–º –≤—Ä–µ–º–µ–Ω–∏</p>
            <p style="margin-top: 5px; font-size: 0.8rem;">–†–∞–±–æ—Ç–∞–µ—Ç –Ω–∞ Firebase | –ë–µ–∑ —Å–∫–∞—á–∏–≤–∞–Ω–∏–π –∏ —Ä–µ–≥–∏—Å—Ç—Ä–∞—Ü–∏–∏</p>
        </footer>
    </div>

    <script>
        // üî• Firebase –∫–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏—è (–ó–ê–ú–ï–ù–ò–¢–ï –ù–ê –°–í–û–Æ!)
        const firebaseConfig = {
            apiKey: "AIzaSyBJpQ81raWuqIagBYaMBX1Sr5mfH2q-uds",
            authDomain: "neonquiz-5ab11.firebaseapp.com",
            databaseURL: "https://neonquiz-5ab11-default-rtdb.firebaseio.com",
            projectId: "neonquiz-5ab11",
            storageBucket: "neonquiz-5ab11.firebasestorage.app",
            messagingSenderId: "902090209070",
            appId: "1:902090209070:web:deb8964a92f848cb5c2cbf",
            measurementId: "G-VQPVCFQ1TW"
        };

        // –ò–Ω–∏—Ü–∏–∞–ª–∏–∑–∞—Ü–∏—è Firebase
        firebase.initializeApp(firebaseConfig);
        const database = firebase.database();
        const auth = firebase.auth();

        // –ì–ª–æ–±–∞–ª—å–Ω—ã–µ –ø–µ—Ä–µ–º–µ–Ω–Ω—ã–µ –∏–≥—Ä—ã
        const gameData = {
            user: null,
            isGuest: false,
            roomId: null,
            playerId: null,
            playerName: "–ò–≥—Ä–æ–∫",
            isHost: false,
            players: {},
            gameState: "lobby", // lobby, playing, results, endgame
            currentQuestion: 0,
            selectedTheme: "general",
            timer: 30,
            timerInterval: null,
            playerAnswers: {},
            playerReady: {},
            currentQuestionData: null,
            roundResults: {
                correctAnswer: "",
                correctPlayers: [],
                correctCount: 0,
                totalPlayers: 0
            },
            userQuizzes: [],
            customQuizzes: {}
        };

        // –ë–û–õ–¨–®–ê–Ø –±–∞–∑–∞ –≤–æ–ø—Ä–æ—Å–æ–≤ (–±–æ–ª–µ–µ 70 –≤–æ–ø—Ä–æ—Å–æ–≤!)
        const questions = {
            general: [
                { question: "–ö–∞–∫–∞—è –ø–ª–∞–Ω–µ—Ç–∞ –°–æ–ª–Ω–µ—á–Ω–æ–π —Å–∏—Å—Ç–µ–º—ã —Å–∞–º–∞—è –≥–æ—Ä—è—á–∞—è?", options: ["–í–µ–Ω–µ—Ä–∞", "–ú–µ—Ä–∫—É—Ä–∏–π", "–ú–∞—Ä—Å", "–Æ–ø–∏—Ç–µ—Ä"], answer: 0 },
                { question: "–°–∫–æ–ª—å–∫–æ —Ü–≤–µ—Ç–æ–≤ –≤ —Ä–∞–¥—É–≥–µ?", options: ["5", "6", "7", "8"], answer: 2 },
                { question: "–ö–∞–∫ –Ω–∞–∑—ã–≤–∞–µ—Ç—Å—è —Å–∞–º–∞—è –¥–ª–∏–Ω–Ω–∞—è —Ä–µ–∫–∞ –≤ –º–∏—Ä–µ?", options: ["–ê–º–∞–∑–æ–Ω–∫–∞", "–ù–∏–ª", "–Ø–Ω—Ü–∑—ã", "–ú–∏—Å—Å–∏—Å–∏–ø–∏"], answer: 0 },
                { question: "–í –∫–∞–∫–æ–º –≥–æ–¥—É —á–µ–ª–æ–≤–µ–∫ –≤–ø–µ—Ä–≤—ã–µ –ø–æ–ª–µ—Ç–µ–ª –≤ –∫–æ—Å–º–æ—Å?", options: ["1957", "1961", "1969", "1975"], answer: 1 },
                { question: "–ö–∞–∫–æ–π —Ö–∏–º–∏—á–µ—Å–∫–∏–π —ç–ª–µ–º–µ–Ω—Ç –æ–±–æ–∑–Ω–∞—á–∞–µ—Ç—Å—è —Å–∏–º–≤–æ–ª–æ–º 'Au'?", options: ["–°–µ—Ä–µ–±—Ä–æ", "–ñ–µ–ª–µ–∑–æ", "–ó–æ–ª–æ—Ç–æ", "–ê–ª—é–º–∏–Ω–∏–π"], answer: 2 },
                { question: "–°–∫–æ–ª—å–∫–æ –∫–æ–Ω—Ç–∏–Ω–µ–Ω—Ç–æ–≤ –Ω–∞ –ó–µ–º–ª–µ?", options: ["5", "6", "7", "8"], answer: 1 },
                { question: "–ö–∞–∫–æ–µ –∂–∏–≤–æ—Ç–Ω–æ–µ —è–≤–ª—è–µ—Ç—Å—è —Å–∏–º–≤–æ–ª–æ–º –†–æ—Å—Å–∏–∏?", options: ["–ú–µ–¥–≤–µ–¥—å", "–û—Ä–µ–ª", "–í–æ–ª–∫", "–¢–∏–≥—Ä"], answer: 0 },
                { question: "–ö–∞–∫–æ–π –æ–∫–µ–∞–Ω —Å–∞–º—ã–π –º–∞–ª–µ–Ω—å–∫–∏–π?", options: ["–¢–∏—Ö–∏–π", "–ê—Ç–ª–∞–Ω—Ç–∏—á–µ—Å–∫–∏–π", "–ò–Ω–¥–∏–π—Å–∫–∏–π", "–°–µ–≤–µ—Ä–Ω—ã–π –õ–µ–¥–æ–≤–∏—Ç—ã–π"], answer: 3 },
                { question: "–°–∫–æ–ª—å–∫–æ –¥–Ω–µ–π –≤ –≤–∏—Å–æ–∫–æ—Å–Ω–æ–º –≥–æ–¥—É?", options: ["365", "366", "364", "367"], answer: 1 },
                { question: "–ö–∞–∫ –Ω–∞–∑—ã–≤–∞–µ—Ç—Å—è —Å–∞–º–∞—è –≤—ã—Å–æ–∫–∞—è –≥–æ—Ä–∞ –≤ –º–∏—Ä–µ?", options: ["–ö–∏–ª–∏–º–∞–Ω–¥–∂–∞—Ä–æ", "–≠–≤–µ—Ä–µ—Å—Ç", "–ê–∫–æ–Ω–∫–∞–≥—É–∞", "–ú–æ–Ω–±–ª–∞–Ω"], answer: 1 }
            ],
            science: [
                { question: "–ö–∞–∫–æ–π –≥–∞–∑ –Ω–∞–∏–±–æ–ª–µ–µ —Ä–∞—Å–ø—Ä–æ—Å—Ç—Ä–∞–Ω–µ–Ω –≤ –∞—Ç–º–æ—Å—Ñ–µ—Ä–µ –ó–µ–º–ª–∏?", options: ["–ö–∏—Å–ª–æ—Ä–æ–¥", "–ê–∑–æ—Ç", "–£–≥–ª–µ–∫–∏—Å–ª—ã–π –≥–∞–∑", "–í–æ–¥–æ—Ä–æ–¥"], answer: 1 },
                { question: "–ö–∞–∫–∞—è —á–∞—Å—Ç–∏—Ü–∞ –∏–º–µ–µ—Ç –ø–æ–ª–æ–∂–∏—Ç–µ–ª—å–Ω—ã–π –∑–∞—Ä—è–¥?", options: ["–≠–ª–µ–∫—Ç—Ä–æ–Ω", "–ù–µ–π—Ç—Ä–æ–Ω", "–ü—Ä–æ—Ç–æ–Ω", "–ù–µ–π—Ç—Ä–∏–Ω–æ"], answer: 2 },
                { question: "–ö–∞–∫–æ–π –æ—Ä–≥–∞–Ω —á–µ–ª–æ–≤–µ–∫–∞ —Å–∞–º—ã–π –±–æ–ª—å—à–æ–π?", options: ["–ü–µ—á–µ–Ω—å", "–ú–æ–∑–≥", "–ö–æ–∂–∞", "–õ–µ–≥–∫–∏–µ"], answer: 2 },
                { question: "–°–∫–æ–ª—å–∫–æ –∫–æ—Å—Ç–µ–π –≤ —Ç–µ–ª–µ –≤–∑—Ä–æ—Å–ª–æ–≥–æ —á–µ–ª–æ–≤–µ–∫–∞?", options: ["206", "250", "300", "180"], answer: 0 },
                { question: "–ö–∞–∫–∞—è –ø–ª–∞–Ω–µ—Ç–∞ –∏–∑–≤–µ—Å—Ç–Ω–∞ —Å–≤–æ–∏–º–∏ –∫–æ–ª—å—Ü–∞–º–∏?", options: ["–Æ–ø–∏—Ç–µ—Ä", "–°–∞—Ç—É—Ä–Ω", "–£—Ä–∞–Ω", "–ù–µ–ø—Ç—É–Ω"], answer: 1 },
                { question: "–ö–∞–∫ –Ω–∞–∑—ã–≤–∞–µ—Ç—Å—è –ø—Ä–æ—Ü–µ—Å—Å –ø—Ä–µ–≤—Ä–∞—â–µ–Ω–∏—è –≤–æ–¥—ã –≤ –ø–∞—Ä?", options: ["–ö–æ–Ω–¥–µ–Ω—Å–∞—Ü–∏—è", "–ò—Å–ø–∞—Ä–µ–Ω–∏–µ", "–ö—Ä–∏—Å—Ç–∞–ª–ª–∏–∑–∞—Ü–∏—è", "–°—É–±–ª–∏–º–∞—Ü–∏—è"], answer: 1 },
                { question: "–ö–∞–∫–æ–π –º–µ—Ç–∞–ª–ª –∂–∏–¥–∫–∏–π –ø—Ä–∏ –∫–æ–º–Ω–∞—Ç–Ω–æ–π —Ç–µ–º–ø–µ—Ä–∞—Ç—É—Ä–µ?", options: ["–†—Ç—É—Ç—å", "–ó–æ–ª–æ—Ç–æ", "–°–µ—Ä–µ–±—Ä–æ", "–ú–µ–¥—å"], answer: 0 },
                { question: "–°–∫–æ–ª—å–∫–æ —Ö—Ä–æ–º–æ—Å–æ–º —É —á–µ–ª–æ–≤–µ–∫–∞?", options: ["23", "46", "48", "52"], answer: 1 },
                { question: "–ö–∞–∫–∞—è –∫–∏—Å–ª–æ—Ç–∞ —Å–æ–¥–µ—Ä–∂–∏—Ç—Å—è –≤ –∂–µ–ª—É–¥–∫–µ?", options: ["–°–æ–ª—è–Ω–∞—è", "–°–µ—Ä–Ω–∞—è", "–ê–∑–æ—Ç–Ω–∞—è", "–£–∫—Å—É—Å–Ω–∞—è"], answer: 0 },
                { question: "–ö–∞–∫–æ–π —ç–ª–µ–º–µ–Ω—Ç —Å–∞–º—ã–π —Ä–∞—Å–ø—Ä–æ—Å—Ç—Ä–∞–Ω–µ–Ω–Ω—ã–π –≤–æ –í—Å–µ–ª–µ–Ω–Ω–æ–π?", options: ["–í–æ–¥–æ—Ä–æ–¥", "–ì–µ–ª–∏–π", "–ö–∏—Å–ª–æ—Ä–æ–¥", "–£–≥–ª–µ—Ä–æ–¥"], answer: 0 }
            ],
            history: [
                { question: "–í –∫–∞–∫–æ–º –≥–æ–¥—É –Ω–∞—á–∞–ª–∞—Å—å –í—Ç–æ—Ä–∞—è –º–∏—Ä–æ–≤–∞—è –≤–æ–π–Ω–∞?", options: ["1937", "1939", "1941", "1945"], answer: 1 },
                { question: "–ö—Ç–æ –±—ã–ª –ø–µ—Ä–≤—ã–º –ø—Ä–µ–∑–∏–¥–µ–Ω—Ç–æ–º –°–®–ê?", options: ["–¢–æ–º–∞—Å –î–∂–µ—Ñ—Ñ–µ—Ä—Å–æ–Ω", "–î–∂–æ—Ä–¥–∂ –í–∞—à–∏–Ω–≥—Ç–æ–Ω", "–ê–≤—Ä–∞–∞–º –õ–∏–Ω–∫–æ–ª—å–Ω", "–î–∂–æ–Ω –ê–¥–∞–º—Å"], answer: 1 },
                { question: "–ö–∞–∫ –∑–≤–∞–ª–∏ –ø–µ—Ä–≤–æ–≥–æ —á–µ–ª–æ–≤–µ–∫–∞ –≤ –∫–æ—Å–º–æ—Å–µ?", options: ["–ù–∏–ª –ê—Ä–º—Å—Ç—Ä–æ–Ω–≥", "–Æ—Ä–∏–π –ì–∞–≥–∞—Ä–∏–Ω", "–í–∞–ª–µ–Ω—Ç–∏–Ω–∞ –¢–µ—Ä–µ—à–∫–æ–≤–∞", "–ê–ª–∞–Ω –®–µ–ø–∞—Ä–¥"], answer: 1 },
                { question: "–í –∫–∞–∫–æ–º –≥–æ–¥—É –ø–∞–ª–∞ –ë–µ—Ä–ª–∏–Ω—Å–∫–∞—è —Å—Ç–µ–Ω–∞?", options: ["1987", "1989", "1991", "1993"], answer: 1 },
                { question: "–ö—Ç–æ –Ω–∞–ø–∏—Å–∞–ª '–í–æ–π–Ω—É –∏ –º–∏—Ä'?", options: ["–§. –î–æ—Å—Ç–æ–µ–≤—Å–∫–∏–π", "–õ. –¢–æ–ª—Å—Ç–æ–π", "–ê. –ß–µ—Ö–æ–≤", "–ò. –¢—É—Ä–≥–µ–Ω–µ–≤"], answer: 1 },
                { question: "–ö–æ–≥–¥–∞ –ø—Ä–æ–∏–∑–æ—à–ª–∞ –û–∫—Ç—è–±—Ä—å—Å–∫–∞—è —Ä–µ–≤–æ–ª—é—Ü–∏—è?", options: ["1917", "1918", "1919", "1920"], answer: 0 },
                { question: "–ö—Ç–æ –æ—Ç–∫—Ä—ã–ª –ê–º–µ—Ä–∏–∫—É?", options: ["–•—Ä–∏—Å—Ç–æ—Ñ–æ—Ä –ö–æ–ª—É–º–±", "–í–∞—Å–∫–æ –¥–∞ –ì–∞–º–∞", "–§–µ—Ä–Ω–∞–Ω –ú–∞–≥–µ–ª–ª–∞–Ω", "–ê–º–µ—Ä–∏–≥–æ –í–µ—Å–ø—É—á—á–∏"], answer: 0 },
                { question: "–í –∫–∞–∫–æ–º –≥–æ–¥—É —Ä–∞—Å–ø–∞–ª—Å—è –°–°–°–†?", options: ["1989", "1990", "1991", "1992"], answer: 2 },
                { question: "–ö—Ç–æ –±—ã–ª –ø–µ—Ä–≤—ã–º —Ü–∞—Ä–µ–º –≤—Å–µ—è –†—É—Å–∏?", options: ["–ò–≤–∞–Ω III", "–ò–≤–∞–Ω IV", "–ü–µ—Ç—Ä I", "–ê–ª–µ–∫—Å–µ–π –ú–∏—Ö–∞–π–ª–æ–≤–∏—á"], answer: 1 },
                { question: "–ö–æ–≥–¥–∞ –±—ã–ª–∞ –æ—Å–Ω–æ–≤–∞–Ω–∞ –ú–æ—Å–∫–≤–∞?", options: ["1147", "1247", "1347", "1447"], answer: 0 }
            ],
            geography: [
                { question: "–ö–∞–∫–∞—è —Å—Ç—Ä–∞–Ω–∞ –∏–º–µ–µ—Ç —Å–∞–º—É—é –¥–ª–∏–Ω–Ω—É—é –±–µ—Ä–µ–≥–æ–≤—É—é –ª–∏–Ω–∏—é?", options: ["–†–æ—Å—Å–∏—è", "–ö–∞–Ω–∞–¥–∞", "–ê–≤—Å—Ç—Ä–∞–ª–∏—è", "–ß–∏–ª–∏"], answer: 1 },
                { question: "–ö–∞–∫–æ–π —Å–∞–º—ã–π –±–æ–ª—å—à–æ–π –æ–∫–µ–∞–Ω –Ω–∞ –ó–µ–º–ª–µ?", options: ["–ê—Ç–ª–∞–Ω—Ç–∏—á–µ—Å–∫–∏–π", "–ò–Ω–¥–∏–π—Å–∫–∏–π", "–°–µ–≤–µ—Ä–Ω—ã–π –õ–µ–¥–æ–≤–∏—Ç—ã–π", "–¢–∏—Ö–∏–π"], answer: 3 },
                { question: "–ö–∞–∫–∞—è —Å–∞–º–∞—è –≤—ã—Å–æ–∫–∞—è –≥–æ—Ä–∞ –≤ –º–∏—Ä–µ?", options: ["–ö2", "–ö–∏–ª–∏–º–∞–Ω–¥–∂–∞—Ä–æ", "–≠–≤–µ—Ä–µ—Å—Ç", "–ê–∫–æ–Ω–∫–∞–≥—É–∞"], answer: 2 },
                { question: "–°—Ç–æ–ª–∏—Ü–∞ –ê–≤—Å—Ç—Ä–∞–ª–∏–∏?", options: ["–°–∏–¥–Ω–µ–π", "–ú–µ–ª—å–±—É—Ä–Ω", "–ö–∞–Ω–±–µ—Ä—Ä–∞", "–ë—Ä–∏—Å–±–µ–Ω"], answer: 2 },
                { question: "–°–∞–º–∞—è –±–æ–ª—å—à–∞—è –ø—É—Å—Ç—ã–Ω—è –≤ –º–∏—Ä–µ?", options: ["–°–∞—Ö–∞—Ä–∞", "–ì–æ–±–∏", "–ê—Ä–∞–≤–∏–π—Å–∫–∞—è", "–ê–Ω—Ç–∞—Ä–∫—Ç–∏—á–µ—Å–∫–∞—è"], answer: 3 },
                { question: "–°–∫–æ–ª—å–∫–æ —à—Ç–∞—Ç–æ–≤ –≤ –°–®–ê?", options: ["48", "50", "52", "54"], answer: 1 },
                { question: "–°–∞–º–∞—è –¥–ª–∏–Ω–Ω–∞—è —Ä–µ–∫–∞ –ï–≤—Ä–æ–ø—ã?", options: ["–î—É–Ω–∞–π", "–í–æ–ª–≥–∞", "–î–Ω–µ–ø—Ä", "–†–µ–π–Ω"], answer: 1 },
                { question: "–ö–∞–∫–∞—è —Å—Ç—Ä–∞–Ω–∞ —Å–∞–º–∞—è –±–æ–ª—å—à–∞—è –ø–æ –ø–ª–æ—â–∞–¥–∏?", options: ["–ö–∏—Ç–∞–π", "–°–®–ê", "–†–æ—Å—Å–∏—è", "–ö–∞–Ω–∞–¥–∞"], answer: 2 },
                { question: "–°—Ç–æ–ª–∏—Ü–∞ –ë—Ä–∞–∑–∏–ª–∏–∏?", options: ["–†–∏–æ-–¥–µ-–ñ–∞–Ω–µ–π—Ä–æ", "–°–∞–Ω-–ü–∞—É–ª—É", "–ë—Ä–∞–∑–∏–ª–∏–∞", "–°–∞–ª—å–≤–∞–¥–æ—Ä"], answer: 2 },
                { question: "–°–∫–æ–ª—å–∫–æ –º–∞—Ç–µ—Ä–∏–∫–æ–≤ –Ω–∞ –ó–µ–º–ª–µ?", options: ["5", "6", "7", "8"], answer: 1 }
            ],
            entertainment: [
                { question: "–ö–∞–∫–æ–π –∞–∫—Ç–µ—Ä —Å—ã–≥—Ä–∞–ª –¢–æ–Ω–∏ –°—Ç–∞—Ä–∫–∞ –≤ —Ñ–∏–ª—å–º–∞—Ö Marvel?", options: ["–ö—Ä–∏—Å –≠–≤–∞–Ω—Å", "–†–æ–±–µ—Ä—Ç –î–∞—É–Ω–∏-–º–ª.", "–ö—Ä–∏—Å –•–µ–º—Å–≤–æ—Ä—Ç", "–ú–∞—Ä–∫ –†—É—Ñ—Ñ–∞–ª–æ"], answer: 1 },
                { question: "–ö–∞–∫–∞—è –≥—Ä—É–ø–ø–∞ –∏—Å–ø–æ–ª–Ω–∏–ª–∞ –ø–µ—Å–Ω—é 'Bohemian Rhapsody'?", options: ["The Beatles", "Queen", "Led Zeppelin", "Pink Floyd"], answer: 1 },
                { question: "–ö–∞–∫–æ–π —Ñ–∏–ª—å–º –ø–æ–ª—É—á–∏–ª –û—Å–∫–∞—Ä –∑–∞ –ª—É—á—à–∏–π —Ñ–∏–ª—å–º –≤ 2020 –≥–æ–¥—É?", options: ["–ü–∞—Ä–∞–∑–∏—Ç—ã", "1917", "–î–∂–æ–∫–µ—Ä", "–û–¥–Ω–∞–∂–¥—ã –≤ –ì–æ–ª–ª–∏–≤—É–¥–µ"], answer: 0 },
                { question: "–ö—Ç–æ –Ω–∞–ø–∏—Å–∞–ª –º—É–∑—ã–∫—É –∫ —Ñ–∏–ª—å–º—É '–¢–∏—Ç–∞–Ω–∏–∫'?", options: ["–î–∂–æ–Ω –£–∏–ª—å—è–º—Å", "–•–∞–Ω—Å –¶–∏–º–º–µ—Ä", "–î–∂–µ–π–º—Å –•–æ—Ä–Ω–µ—Ä", "–≠–Ω–Ω–∏–æ –ú–æ—Ä—Ä–∏–∫–æ–Ω–µ"], answer: 2 },
                { question: "–ö–∞–∫ –∑–æ–≤—É—Ç –≥–ª–∞–≤–Ω–æ–≥–æ –≥–µ—Ä–æ—è —Å–µ—Ä–∏–∏ –∏–≥—Ä 'The Legend of Zelda'?", options: ["–ó–µ–ª—å–¥–∞", "–õ–∏–Ω–∫", "–ì–∞–Ω–æ–Ω", "–ù–∞–≤–∏"], answer: 1 },
                { question: "–ö–∞–∫–æ–π —Å–µ—Ä–∏–∞–ª —è–≤–ª—è–µ—Ç—Å—è —Å–∞–º—ã–º –¥–æ—Ä–æ–≥–∏–º –≤ –∏—Å—Ç–æ—Ä–∏–∏?", options: ["–ò–≥—Ä–∞ –ø—Ä–µ—Å—Ç–æ–ª–æ–≤", "–í–µ–¥—å–º–∞–∫", "–ú–∞–Ω–¥–∞–ª–æ—Ä–µ—Ü", "–ö–æ—Ä–æ–Ω–∞"], answer: 1 },
                { question: "–ö—Ç–æ —Ä–µ–∂–∏—Å—Å–µ—Ä —Ñ–∏–ª—å–º–∞ '–ö—Ä–∏–º–∏–Ω–∞–ª—å–Ω–æ–µ —á—Ç–∏–≤–æ'?", options: ["–ú–∞—Ä—Ç–∏–Ω –°–∫–æ—Ä—Å–µ–∑–µ", "–ö–≤–µ–Ω—Ç–∏–Ω –¢–∞—Ä–∞–Ω—Ç–∏–Ω–æ", "–î—ç–≤–∏–¥ –§–∏–Ω—á–µ—Ä", "–ö—Ä–∏—Å—Ç–æ—Ñ–µ—Ä –ù–æ–ª–∞–Ω"], answer: 1 },
                { question: "–ö–∞–∫–æ–π —Ñ–∏–ª—å–º —Å–æ–±—Ä–∞–ª —Å–∞–º—ã–π –±–æ–ª—å—à–æ–π –∫–∞—Å—Å–æ–≤—ã–π —Å–±–æ—Ä?", options: ["–ê–≤–∞—Ç–∞—Ä", "–ú—Å—Ç–∏—Ç–µ–ª–∏: –§–∏–Ω–∞–ª", "–¢–∏—Ç–∞–Ω–∏–∫", "–ó–≤–µ–∑–¥–Ω—ã–µ –≤–æ–π–Ω—ã: –ü—Ä–æ–±—É–∂–¥–µ–Ω–∏–µ —Å–∏–ª—ã"], answer: 0 },
                { question: "–ö—Ç–æ –Ω–∞–ø–∏—Å–∞–ª '–ì–∞—Ä—Ä–∏ –ü–æ—Ç—Ç–µ—Ä–∞'?", options: ["–î–∂. –†. –†. –¢–æ–ª–∫–∏–Ω", "–î–∂. –ö. –†–æ—É–ª–∏–Ω–≥", "–ö. –°. –õ—å—é–∏—Å", "–°. –ú–∞–π–µ—Ä"], answer: 1 },
                { question: "–ö–∞–∫–æ–π –º—É–ª—å—Ç—Ñ–∏–ª—å–º —Å—Ç–∞–ª –ø–µ—Ä–≤—ã–º –ø–æ–ª–Ω–æ–º–µ—Ç—Ä–∞–∂–Ω—ã–º –æ—Ç Disney?", options: ["–ë–µ–ª–æ—Å–Ω–µ–∂–∫–∞", "–ü–∏–Ω–æ–∫–∫–∏–æ", "–ó–æ–ª—É—à–∫–∞", "–°–ø—è—â–∞—è –∫—Ä–∞—Å–∞–≤–∏—Ü–∞"], answer: 0 }
            ],
            sports: [
                { question: "–°–∫–æ–ª—å–∫–æ –∏–≥—Ä–æ–∫–æ–≤ –≤ —Ñ—É—Ç–±–æ–ª—å–Ω–æ–π –∫–æ–º–∞–Ω–¥–µ –Ω–∞ –ø–æ–ª–µ?", options: ["10", "11", "12", "9"], answer: 1 },
                { question: "–í –∫–∞–∫–æ–º –≤–∏–¥–µ —Å–ø–æ—Ä—Ç–∞ –∏—Å–ø–æ–ª—å–∑—É–µ—Ç—Å—è —à–∞–π–±–∞?", options: ["–§—É—Ç–±–æ–ª", "–ë–∞—Å–∫–µ—Ç–±–æ–ª", "–•–æ–∫–∫–µ–π", "–†–µ–≥–±–∏"], answer: 2 },
                { question: "–°–∫–æ–ª—å–∫–æ –æ—á–∫–æ–≤ –¥–∞–µ—Ç —Ç—Ä–µ—Ö–æ—á–∫–æ–≤—ã–π –±—Ä–æ—Å–æ–∫ –≤ –±–∞—Å–∫–µ—Ç–±–æ–ª–µ?", options: ["1", "2", "3", "4"], answer: 2 },
                { question: "–ö–∞–∫–∞—è —Å—Ç—Ä–∞–Ω–∞ –≤—ã–∏–≥—Ä–∞–ª–∞ –ß–µ–º–ø–∏–æ–Ω–∞—Ç –º–∏—Ä–∞ –ø–æ —Ñ—É—Ç–±–æ–ª—É 2018?", options: ["–§—Ä–∞–Ω—Ü–∏—è", "–•–æ—Ä–≤–∞—Ç–∏—è", "–ë—Ä–∞–∑–∏–ª–∏—è", "–ì–µ—Ä–º–∞–Ω–∏—è"], answer: 0 },
                { question: "–°–∫–æ–ª—å–∫–æ —Å–µ—Ç–æ–≤ –≤ —Ç–µ–Ω–Ω–∏—Å–Ω–æ–º –º–∞—Ç—á–µ —É –º—É–∂—á–∏–Ω?", options: ["3", "4", "5", "6"], answer: 2 },
                { question: "–ö–∞–∫ –Ω–∞–∑—ã–≤–∞–µ—Ç—Å—è –≥–ª–∞–≤–Ω—ã–π —Ç—É—Ä–Ω–∏—Ä –ø–æ —Ç–µ–Ω–Ω–∏—Å—É –≤ –£–∏–º–±–ª–¥–æ–Ω–µ?", options: ["–û—Ç–∫—Ä—ã—Ç—ã–π —á–µ–º–ø–∏–æ–Ω–∞—Ç", "–ö—É–±–æ–∫", "–ß–µ–º–ø–∏–æ–Ω–∞—Ç", "–¢—É—Ä–Ω–∏—Ä"], answer: 0 },
                { question: "–í –∫–∞–∫–æ–º –≥–æ–¥—É –ú–æ—Å–∫–≤–∞ –ø—Ä–∏–Ω–∏–º–∞–ª–∞ –û–ª–∏–º–ø–∏–π—Å–∫–∏–µ –∏–≥—Ä—ã?", options: ["1976", "1980", "1984", "1988"], answer: 1 },
                { question: "–°–∫–æ–ª—å–∫–æ –∫—Ä—É–≥–æ–≤ –≤ –§–æ—Ä–º—É–ª–µ-1?", options: ["44", "55", "66", "78"], answer: 1 },
                { question: "–ö–∞–∫–æ–π —Å–ø–æ—Ä—Ç—Å–º–µ–Ω –∏–º–µ–µ—Ç –±–æ–ª—å—à–µ –≤—Å–µ–≥–æ –∑–æ–ª–æ—Ç—ã—Ö –æ–ª–∏–º–ø–∏–π—Å–∫–∏—Ö –º–µ–¥–∞–ª–µ–π?", options: ["–ú–∞–π–∫–ª –§–µ–ª–ø—Å", "–õ–∞—Ä—Ä–∏—Å–∞ –õ–∞—Ç—ã–Ω–∏–Ω–∞", "–ö–∞—Ä–ª –õ—å—é–∏—Å", "–£—Å—ç–π–Ω –ë–æ–ª—Ç"], answer: 0 },
                { question: "–í –∫–∞–∫–æ–π —Å—Ç—Ä–∞–Ω–µ –∑–∞—Ä–æ–¥–∏–ª—Å—è —Ñ—É—Ç–±–æ–ª?", options: ["–ë—Ä–∞–∑–∏–ª–∏—è", "–ò—Ç–∞–ª–∏—è", "–ê–Ω–≥–ª–∏—è", "–ì–µ—Ä–º–∞–Ω–∏—è"], answer: 2 }
            ],
            games: [
                { question: "–ö–∞–∫ –∑–æ–≤—É—Ç –≥–ª–∞–≤–Ω–æ–≥–æ –≥–µ—Ä–æ—è —Å–µ—Ä–∏–∏ –∏–≥—Ä 'Super Mario'?", options: ["–õ—É–∏–¥–∂–∏", "–ú–∞—Ä–∏–æ", "–ô–æ—à–∏", "–ë–æ—É–∑–µ—Ä"], answer: 1 },
                { question: "–í –∫–∞–∫–æ–π –∏–≥—Ä–µ –µ—Å—Ç—å –∫—Ä–∞—Ñ—Ç?", options: ["Call of Duty", "Minecraft", "FIFA", "GTA V"], answer: 1 },
                { question: "–ö–∞–∫–∞—è –∏–≥—Ä–∞ —è–≤–ª—è–µ—Ç—Å—è —Å–∞–º–æ–π –ø—Ä–æ–¥–∞–≤–∞–µ–º–æ–π –≤ –∏—Å—Ç–æ—Ä–∏–∏?", options: ["Tetris", "Minecraft", "GTA V", "Wii Sports"], answer: 0 },
                { question: "–ö–∞–∫ –Ω–∞–∑—ã–≤–∞–µ—Ç—Å—è –∫–æ–º–ø–∞–Ω–∏—è, —Å–æ–∑–¥–∞–≤—à–∞—è 'World of Warcraft'?", options: ["Valve", "Blizzard", "EA", "Ubisoft"], answer: 1 },
                { question: "–°–∫–æ–ª—å–∫–æ —á–µ–º–ø–∏–æ–Ω–æ–≤ –≤ –∏–≥—Ä–µ 'League of Legends'?", options: ["100", "120", "150", "–±–æ–ª–µ–µ 150"], answer: 3 },
                { question: "–ö–∞–∫ –Ω–∞–∑—ã–≤–∞–µ—Ç—Å—è —Å–∞–º–∞—è –ø–æ–ø—É–ª—è—Ä–Ω–∞—è –∫–∞—Ä—Ç–∞ –≤ 'Counter-Strike'?", options: ["Dust II", "Inferno", "Mirage", "Nuke"], answer: 0 },
                { question: "–ö—Ç–æ –≥–ª–∞–≤–Ω—ã–π –≥–µ—Ä–æ–π —Å–µ—Ä–∏–∏ 'The Witcher'?", options: ["–ô–µ–Ω–Ω–∏—Ñ–µ—Ä", "–¢—Ä–∏—Å—Å", "–ì–µ—Ä–∞–ª—å—Ç", "–¶–∏—Ä–∏"], answer: 2 },
                { question: "–í –∫–∞–∫–æ–π –∏–≥—Ä–µ –µ—Å—Ç—å '–ë–∏—Ç–≤–∞ –∫–æ—Ä–æ–ª–µ–≤'?", options: ["Fortnite", "Overwatch", "Dota 2", "Valorant"], answer: 0 },
                { question: "–ö–∞–∫ –Ω–∞–∑—ã–≤–∞–µ—Ç—Å—è –∏–≥—Ä–æ–≤–∞—è –ø—Ä–∏—Å—Ç–∞–≤–∫–∞ –æ—Ç Sony?", options: ["Xbox", "PlayStation", "Nintendo", "Sega"], answer: 1 },
                { question: "–ö–∞–∫–æ–π –∂–∞–Ω—Ä —É –∏–≥—Ä—ã 'The Sims'?", options: ["–®—É—Ç–µ—Ä", "–°—Ç—Ä–∞—Ç–µ–≥–∏—è", "–°–∏–º—É–ª—è—Ç–æ—Ä –∂–∏–∑–Ω–∏", "–†–ü–ì"], answer: 2 }
            ]
        };

        // –ì–µ–Ω–µ—Ä–∞—Ç–æ—Ä –∫–æ–¥–æ–≤ –∫–æ–º–Ω–∞—Ç
        function generateRoomCode() {
            const chars = 'ABCDEFGHIJKLMNOPQRSTUVWXYZ0123456789';
            let code = '';
            for (let i = 0; i < 6; i++) {
                code += chars.charAt(Math.floor(Math.random() * chars.length));
            }
            return code;
        }

        // –ò–Ω–∏—Ü–∏–∞–ª–∏–∑–∞—Ü–∏—è –∏–≥—Ä—ã
        document.addEventListener('DOMContentLoaded', function() {
            // –ü–æ–∫–∞–∑—ã–≤–∞–µ–º —ç–∫—Ä–∞–Ω –∞–≤—Ç–æ—Ä–∏–∑–∞—Ü–∏–∏
            showAuthInterface();

            // –ò–Ω–∏—Ü–∏–∞–ª–∏–∑–∏—Ä—É–µ–º –∞–≤—Ç–æ—Ä–∏–∑–∞—Ü–∏—é
            initAuth();

            // –ò–Ω–∏—Ü–∏–∞–ª–∏–∑–∏—Ä—É–µ–º –æ—Å—Ç–∞–ª—å–Ω—ã–µ —ç–ª–µ–º–µ–Ω—Ç—ã
            initGameElements();
        });

        // –ò–Ω–∏—Ü–∏–∞–ª–∏–∑–∞—Ü–∏—è –∞–≤—Ç–æ—Ä–∏–∑–∞—Ü–∏–∏
        function initAuth() {
            // –ü—Ä–æ–≤–µ—Ä—è–µ–º —Ç–µ–∫—É—â–µ–≥–æ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è
            auth.onAuthStateChanged((user) => {
                if (user) {
                    gameData.user = user;
                    gameData.isGuest = false;
                    showMainInterface();
                    loadUserQuizzes();
                    loadCustomQuizzes();
                } else {
                    gameData.user = null;
                    showAuthInterface();
                }
            });

            // –û–±—Ä–∞–±–æ—Ç—á–∏–∫–∏ –∫–Ω–æ–ø–æ–∫ –∞–≤—Ç–æ—Ä–∏–∑–∞—Ü–∏–∏
            document.getElementById('emailSignInBtn').addEventListener('click', signInWithEmail);
            document.getElementById('emailSignUpBtn').addEventListener('click', signUpWithEmail);
            document.getElementById('continueAsGuest').addEventListener('click', continueAsGuest);
            document.getElementById('logoutBtn').addEventListener('click', signOut);

            // –ò–Ω–∏—Ü–∏–∞–ª–∏–∑–∞—Ü–∏—è —Å–æ–∑–¥–∞–Ω–∏—è –æ–ø—Ä–æ—Å–æ–≤
            initQuizCreator();
        }

        // –í—Ö–æ–¥ –ø–æ Email
        function signInWithEmail() {
            const email = document.getElementById('emailInput').value;
            const password = document.getElementById('passwordInput').value;

            if (!email || !password) {
                showNotification('–û—à–∏–±–∫–∞', '–ó–∞–ø–æ–ª–Ω–∏—Ç–µ –≤—Å–µ –ø–æ–ª—è', '#ff0000');
                return;
            }

            auth.signInWithEmailAndPassword(email, password)
                .then((result) => {
                    showNotification('–£—Å–ø–µ—Ö!', '–í—Ö–æ–¥ –≤—ã–ø–æ–ª–Ω–µ–Ω!', '#00ff9d');
                })
                .catch((error) => {
                    showNotification('–û—à–∏–±–∫–∞', error.message, '#ff0000');
                });
        }

        // –†–µ–≥–∏—Å—Ç—Ä–∞—Ü–∏—è –ø–æ Email
        function signUpWithEmail() {
            const email = document.getElementById('emailInput').value;
            const password = document.getElementById('passwordInput').value;

            if (!email || !password) {
                showNotification('–û—à–∏–±–∫–∞', '–ó–∞–ø–æ–ª–Ω–∏—Ç–µ –≤—Å–µ –ø–æ–ª—è', '#ff0000');
                return;
            }

            if (password.length < 6) {
                showNotification('–û—à–∏–±–∫–∞', '–ü–∞—Ä–æ–ª—å –¥–æ–ª–∂–µ–Ω –±—ã—Ç—å –Ω–µ –º–µ–Ω–µ–µ 6 —Å–∏–º–≤–æ–ª–æ–≤', '#ff0000');
                return;
            }

            auth.createUserWithEmailAndPassword(email, password)
                .then((result) => {
                    // –û–±–Ω–æ–≤–ª—è–µ–º –∏–º—è –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è
                    return result.user.updateProfile({
                        displayName: email.split('@')[0]
                    });
                })
                .then(() => {
                    showNotification('–£—Å–ø–µ—Ö!', '–†–µ–≥–∏—Å—Ç—Ä–∞—Ü–∏—è –∑–∞–≤–µ—Ä—à–µ–Ω–∞!', '#00ff9d');
                })
                .catch((error) => {
                    showNotification('–û—à–∏–±–∫–∞', error.message, '#ff0000');
                });
        }

        // –ü—Ä–æ–¥–æ–ª–∂–∏—Ç—å –∫–∞–∫ –≥–æ—Å—Ç—å
        function continueAsGuest() {
            gameData.isGuest = true;
            gameData.user = {
                uid: 'guest_' + Date.now() + '_' + Math.random().toString(36).substr(2, 9),
                displayName: '–ì–æ—Å—Ç—å_' + Math.floor(Math.random() * 1000),
                email: null,
                photoURL: null,
                isGuest: true
            };
            showMainInterface();
            showNotification('–ì–æ—Å—Ç–µ–≤–æ–π —Ä–µ–∂–∏–º', '–ù–µ–∫–æ—Ç–æ—Ä—ã–µ —Ñ—É–Ω–∫—Ü–∏–∏ –æ–≥—Ä–∞–Ω–∏—á–µ–Ω—ã', '#ffaa00');
        }

        // –í—ã—Ö–æ–¥ –∏–∑ —Å–∏—Å—Ç–µ–º—ã
        function signOut() {
            if (gameData.isGuest) {
                gameData.user = null;
                gameData.isGuest = false;
                showAuthInterface();
            } else {
                auth.signOut()
                    .then(() => {
                        showNotification('–í—ã—Ö–æ–¥', '–í—ã –≤—ã—à–ª–∏ –∏–∑ —Å–∏—Å—Ç–µ–º—ã', '#00f3ff');
                    })
                    .catch((error) => {
                        showNotification('–û—à–∏–±–∫–∞', error.message, '#ff0000');
                    });
            }
        }

        // –ü–æ–∫–∞–∑–∞—Ç—å –∏–Ω—Ç–µ—Ä—Ñ–µ–π—Å –∞–≤—Ç–æ—Ä–∏–∑–∞—Ü–∏–∏
        function showAuthInterface() {
            document.getElementById('authContainer').style.display = 'flex';
            document.querySelector('.room-controls').style.display = 'none';
            document.getElementById('gameInterface').style.display = 'none';
            document.getElementById('userProfile').style.display = 'none';
            document.getElementById('createQuizBtn').style.display = 'none';
            document.getElementById('userQuizzesContainer').style.display = 'none';
            document.getElementById('roomCodeDisplay').style.display = 'none';
            document.querySelector('.status-bar').style.display = 'none';
        }

        // –ü–æ–∫–∞–∑–∞—Ç—å –æ—Å–Ω–æ–≤–Ω–æ–π –∏–Ω—Ç–µ—Ä—Ñ–µ–π—Å
        function showMainInterface() {
            document.getElementById('authContainer').style.display = 'none';
            document.querySelector('.room-controls').style.display = 'flex';
            document.getElementById('userProfile').style.display = 'flex';

            // –û–±–Ω–æ–≤–ª—è–µ–º –ø—Ä–æ—Ñ–∏–ª—å –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è
            document.getElementById('userDisplayName').textContent =
                gameData.user.displayName || gameData.user.email || '–ü–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å';

            if (gameData.user.photoURL) {
                document.getElementById('userAvatar').src = gameData.user.photoURL;
            } else {
                document.getElementById('userAvatar').src = 'https://ui-avatars.com/api/?name=' +
                    encodeURIComponent(gameData.user.displayName || gameData.user.email || 'U') +
                    '&background=ff00ff&color=000';
            }

            // –ü–æ–∫–∞–∑—ã–≤–∞–µ–º –∫–Ω–æ–ø–∫—É —Å–æ–∑–¥–∞–Ω–∏—è –æ–ø—Ä–æ—Å–∞, –µ—Å–ª–∏ –Ω–µ –≥–æ—Å—Ç—å
            if (!gameData.isGuest) {
                document.getElementById('createQuizBtn').style.display = 'block';
                document.getElementById('userQuizzesContainer').style.display = 'block';
            }

            // –û–±–Ω–æ–≤–ª—è–µ–º –∏–º—è –∏–≥—Ä–æ–∫–∞
            document.getElementById('playerNameInput').value =
                gameData.user.displayName || gameData.user.email || '–ò–≥—Ä–æ–∫';
        }

        // –ò–Ω–∏—Ü–∏–∞–ª–∏–∑–∞—Ü–∏—è —ç–ª–µ–º–µ–Ω—Ç–æ–≤ –∏–≥—Ä—ã (–û–†–ò–ì–ò–ù–ê–õ–¨–ù–´–ô –ö–û–î –ò–ó –í–ê–®–ï–ì–û –§–ê–ô–õ–ê)
        function initGameElements() {
            // –≠–ª–µ–º–µ–Ω—Ç—ã –∏–Ω—Ç–µ—Ä—Ñ–µ–π—Å–∞
            const createRoomBtn = document.getElementById('createRoomBtn');
            const joinRoomBtn = document.getElementById('joinRoomBtn');
            const playerNameInput = document.getElementById('playerNameInput');
            const roomCodeInput = document.getElementById('roomCodeInput');
            const startGameBtn = document.getElementById('startGameBtn');
            const readyBtn = document.getElementById('readyBtn');
            const leaveRoomBtn = document.getElementById('leaveRoomBtn');
            const backToMainBtn = document.getElementById('backToMainBtn');
            const nextRoundBtn = document.getElementById('nextRoundBtn');
            const endGameBtn = document.getElementById('endGameBtn');
            const playAgainBtn = document.getElementById('playAgainBtn');
            const backToLobbyBtn = document.getElementById('backToLobbyBtn');
            const sendMessageBtn = document.getElementById('sendMessageBtn');
            const chatInput = document.getElementById('chatInput');

            // –°–æ–∑–¥–∞–Ω–∏–µ –∫–æ–º–Ω–∞—Ç—ã
            createRoomBtn.addEventListener('click', function() {
                const playerName = playerNameInput.value.trim() || "–ò–≥—Ä–æ–∫";
                const roomCode = generateRoomCode();

                gameData.playerName = playerName;
                gameData.playerId = 'player_' + Date.now() + '_' + Math.random().toString(36).substr(2, 9);
                gameData.isHost = true;

                // –°–æ–∑–¥–∞–µ–º –∫–æ–º–Ω–∞—Ç—É –≤ Firebase
                database.ref('rooms/' + roomCode).set({
                    hostId: gameData.playerId,
                    gameState: 'lobby',
                    theme: 'general',
                    currentQuestionIndex: 0,
                    currentQuestionData: null,
                    players: {
                        [gameData.playerId]: {
                            name: playerName,
                            score: 0,
                            ready: false,
                            isHost: true,
                            lastActive: Date.now()
                        }
                    },
                    createdAt: Date.now()
                }).then(() => {
                    gameData.roomId = roomCode;
                    joinRoom(roomCode, playerName);
                    showNotification('–ö–æ–º–Ω–∞—Ç–∞ —Å–æ–∑–¥–∞–Ω–∞!', `–ö–æ–¥ –∫–æ–º–Ω–∞—Ç—ã: ${roomCode}`);

                    // –ü–æ–∫–∞–∑—ã–≤–∞–µ–º –∫–æ–¥ –∫–æ–º–Ω–∞—Ç—ã
                    document.getElementById('roomCodeDisplay').style.display = 'block';
                    document.getElementById('roomCode').textContent = roomCode;

                    // –û–±–Ω–æ–≤–ª—è–µ–º –∏–Ω—Ç–µ—Ä—Ñ–µ–π—Å
                    document.getElementById('hostMessage').style.display = 'block';
                    startGameBtn.style.display = 'block';
                    document.getElementById('themeSelector').style.display = 'block';
                }).catch(error => {
                    showNotification('–û—à–∏–±–∫–∞', '–ù–µ —É–¥–∞–ª–æ—Å—å —Å–æ–∑–¥–∞—Ç—å –∫–æ–º–Ω–∞—Ç—É');
                    console.error(error);
                });
            });

            // –ü—Ä–∏—Å–æ–µ–¥–∏–Ω–µ–Ω–∏–µ –∫ –∫–æ–º–Ω–∞—Ç–µ
            joinRoomBtn.addEventListener('click', function() {
                const playerName = playerNameInput.value.trim() || "–ò–≥—Ä–æ–∫";
                const roomCode = roomCodeInput.value.trim().toUpperCase();

                if (roomCode.length !== 6) {
                    showNotification('–û—à–∏–±–∫–∞', '–ö–æ–¥ –∫–æ–º–Ω–∞—Ç—ã –¥–æ–ª–∂–µ–Ω —Å–æ–¥–µ—Ä–∂–∞—Ç—å 6 —Å–∏–º–≤–æ–ª–æ–≤');
                    return;
                }

                // –ü—Ä–æ–≤–µ—Ä—è–µ–º —Å—É—â–µ—Å—Ç–≤–æ–≤–∞–Ω–∏–µ –∫–æ–º–Ω–∞—Ç—ã
                database.ref('rooms/' + roomCode).once('value').then(snapshot => {
                    if (snapshot.exists()) {
                        gameData.playerName = playerName;
                        gameData.playerId = 'player_' + Date.now() + '_' + Math.random().toString(36).substr(2, 9);
                        gameData.isHost = false;

                        joinRoom(roomCode, playerName);
                        showNotification('–£—Å–ø–µ—Ö!', `–í—ã –ø—Ä–∏—Å–æ–µ–¥–∏–Ω–∏–ª–∏—Å—å –∫ –∫–æ–º–Ω–∞—Ç–µ ${roomCode}`);
                    } else {
                        showNotification('–û—à–∏–±–∫–∞', '–ö–æ–º–Ω–∞—Ç–∞ –Ω–µ –Ω–∞–π–¥–µ–Ω–∞');
                    }
                });
            });

            // –§—É–Ω–∫—Ü–∏—è –ø—Ä–∏—Å–æ–µ–¥–∏–Ω–µ–Ω–∏—è –∫ –∫–æ–º–Ω–∞—Ç–µ
            function joinRoom(roomCode, playerName) {
                gameData.roomId = roomCode;

                // –ü–æ–∫–∞–∑—ã–≤–∞–µ–º –∏–≥—Ä–æ–≤–æ–π –∏–Ω—Ç–µ—Ä—Ñ–µ–π—Å
                document.getElementById('gameInterface').style.display = 'flex';
                document.querySelector('.room-controls').style.display = 'none';
                document.getElementById('roomCodeDisplay').style.display = 'none';

                // –û–±–Ω–æ–≤–ª—è–µ–º –∏–Ω—Ñ–æ—Ä–º–∞—Ü–∏—é –æ –∫–æ–º–Ω–∞—Ç–µ
                document.getElementById('roomName').textContent = roomCode;

                // –ü–æ–∫–∞–∑—ã–≤–∞–µ–º —Å–æ–æ—Ç–≤–µ—Ç—Å—Ç–≤—É—é—â–µ–µ —Å–æ–æ–±—â–µ–Ω–∏–µ
                if (gameData.isHost) {
                    document.getElementById('hostMessage').style.display = 'block';
                    document.getElementById('guestMessage').style.display = 'none';
                    startGameBtn.style.display = 'block';
                    readyBtn.style.display = 'none';
                } else {
                    document.getElementById('hostMessage').style.display = 'none';
                    document.getElementById('guestMessage').style.display = 'block';
                    startGameBtn.style.display = 'none';
                    readyBtn.style.display = 'block';
                }

                // –î–æ–±–∞–≤–ª—è–µ–º –∏–≥—Ä–æ–∫–∞ –≤ –∫–æ–º–Ω–∞—Ç—É
                database.ref('rooms/' + roomCode + '/players/' + gameData.playerId).set({
                    name: playerName,
                    score: 0,
                    ready: false,
                    isHost: gameData.isHost,
                    lastActive: Date.now()
                });

                // –ü–æ–¥–ø–∏—Å—ã–≤–∞–µ–º—Å—è –Ω–∞ –∏–∑–º–µ–Ω–µ–Ω–∏—è –≤ –∫–æ–º–Ω–∞—Ç–µ
                setupRoomListeners(roomCode);
            }

            // –ù–∞—Å—Ç—Ä–æ–π–∫–∞ —Å–ª—É—à–∞—Ç–µ–ª–µ–π –∫–æ–º–Ω–∞—Ç—ã
            function setupRoomListeners(roomCode) {
                // –°–ª—É—à–∞—Ç–µ–ª—å –∏–∑–º–µ–Ω–µ–Ω–∏–π —Å–ø–∏—Å–∫–∞ –∏–≥—Ä–æ–∫–æ–≤
                database.ref('rooms/' + roomCode + '/players').on('value', snapshot => {
                    gameData.players = snapshot.val() || {};
                    updatePlayerList();

                    // –ü–æ–∫–∞–∑—ã–≤–∞–µ–º/—Å–∫—Ä—ã–≤–∞–µ–º —Å–æ–æ–±—â–µ–Ω–∏–µ –æ–± –æ–∂–∏–¥–∞–Ω–∏–∏
                    const playerCount = Object.keys(gameData.players).length;
                    document.getElementById('waitingMessage').style.display =
                        playerCount < 2 ? 'block' : 'none';
                    document.getElementById('chatContainer').style.display =
                        playerCount >= 2 ? 'block' : 'none';
                });

                // –°–ª—É—à–∞—Ç–µ–ª—å —Å–æ—Å—Ç–æ—è–Ω–∏—è –∏–≥—Ä—ã
                database.ref('rooms/' + roomCode + '/gameState').on('value', snapshot => {
                    const state = snapshot.val();
                    gameData.gameState = state;

                    document.getElementById('gameStatus').textContent =
                        state === 'lobby' ? '–õ–æ–±–±–∏' :
                        state === 'playing' ? '–ò–≥—Ä–∞ –∏–¥–µ—Ç' :
                        state === 'results' ? '–†–µ–∑—É–ª—å—Ç–∞—Ç—ã' : '–ö–æ–Ω–µ—Ü –∏–≥—Ä—ã';

                    if (state === 'playing') {
                        startGame();
                    } else if (state === 'results') {
                        // –ü–æ–ª—É—á–∞–µ–º –¥–∞–Ω–Ω—ã–µ –æ –ø—Ä–∞–≤–∏–ª—å–Ω–æ–º –æ—Ç–≤–µ—Ç–µ
                        calculateRoundResults();
                        showResults();
                    } else if (state === 'endgame') {
                        showEndGameResults();
                    }
                });

                // –°–ª—É—à–∞—Ç–µ–ª—å —Ç–µ–∫—É—â–µ–≥–æ –≤–æ–ø—Ä–æ—Å–∞
                database.ref('rooms/' + roomCode + '/currentQuestionIndex').on('value', snapshot => {
                    gameData.currentQuestion = snapshot.val() || 0;
                });

                // –°–ª—É—à–∞—Ç–µ–ª—å –¥–∞–Ω–Ω—ã—Ö —Ç–µ–∫—É—â–µ–≥–æ –≤–æ–ø—Ä–æ—Å–∞
                database.ref('rooms/' + roomCode + '/currentQuestionData').on('value', snapshot => {
                    gameData.currentQuestionData = snapshot.val();
                    if (gameData.gameState === 'playing' && gameData.currentQuestionData) {
                        loadQuestionFromData();
                    }
                });

                // –°–ª—É—à–∞—Ç–µ–ª—å —Ç–µ–º—ã
                database.ref('rooms/' + roomCode + '/theme').on('value', snapshot => {
                    gameData.selectedTheme = snapshot.val() || 'general';
                    updateThemeSelector();
                    document.getElementById('currentTopic').textContent = getThemeName(gameData.selectedTheme);
                });

                // –°–ª—É—à–∞—Ç–µ–ª—å –æ—Ç–≤–µ—Ç–æ–≤ –∏–≥—Ä–æ–∫–æ–≤
                database.ref('rooms/' + roomCode + '/answers').on('value', snapshot => {
                    gameData.playerAnswers = snapshot.val() || {};
                    // –ü—Ä–∏ –∏–∑–º–µ–Ω–µ–Ω–∏–∏ –æ—Ç–≤–µ—Ç–æ–≤ –ø–µ—Ä–µ—Å—á–∏—Ç—ã–≤–∞–µ–º —Ä–µ–∑—É–ª—å—Ç–∞—Ç—ã
                    if (gameData.gameState === 'results') {
                        calculateRoundResults();
                        updateResultsDisplay();
                    }
                });

                // –°–ª—É—à–∞—Ç–µ–ª—å —á–∞—Ç–∞
                database.ref('rooms/' + roomCode + '/chat').limitToLast(20).on('value', snapshot => {
                    const messages = snapshot.val() || {};
                    updateChat(messages);
                });
            }

            // –ù–∞—á–∞–ª–æ –∏–≥—Ä—ã (—Ç–æ–ª—å–∫–æ –¥–ª—è —Ö–æ—Å—Ç–∞)
            startGameBtn.addEventListener('click', function() {
                if (!gameData.isHost) return;

                // –ü—Ä–æ–≤–µ—Ä—è–µ–º, –µ—Å—Ç—å –ª–∏ —Ö–æ—Ç—è –±—ã 1 –≥–æ—Ç–æ–≤—ã–π –∏–≥—Ä–æ–∫ –∫—Ä–æ–º–µ —Ö–æ—Å—Ç–∞
                let readyPlayers = 0;
                Object.keys(gameData.players).forEach(playerId => {
                    if (playerId !== gameData.playerId && gameData.players[playerId].ready) {
                        readyPlayers++;
                    }
                });

                if (readyPlayers === 0) {
                    showNotification('–û—à–∏–±–∫–∞', '–î–æ–∂–¥–∏—Ç–µ—Å—å, –ø–æ–∫–∞ –¥—Ä—É–≥–∏–µ –∏–≥—Ä–æ–∫–∏ –Ω–∞–∂–º—É—Ç "–ì–æ—Ç–æ–≤"');
                    return;
                }

                // –°–±—Ä–∞—Å—ã–≤–∞–µ–º –æ—á–∫–∏ –≤—Å–µ—Ö –∏–≥—Ä–æ–∫–æ–≤
                const updates = {};
                Object.keys(gameData.players).forEach(playerId => {
                    updates['/players/' + playerId + '/score'] = 0;
                });

                database.ref('rooms/' + gameData.roomId).update(updates).then(() => {
                    // –ù–∞—á–∏–Ω–∞–µ–º –∏–≥—Ä—É —Å –ø–µ—Ä–≤–æ–≥–æ –≤–æ–ø—Ä–æ—Å–∞
                    let themeQuestions = questions[gameData.selectedTheme];

                    // –ü—Ä–æ–≤–µ—Ä—è–µ–º, –µ—Å—Ç—å –ª–∏ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å—Å–∫–∏–µ –æ–ø—Ä–æ—Å—ã –¥–ª—è —ç—Ç–æ–π —Ç–µ–º—ã
                    if (gameData.customQuizzes[gameData.selectedTheme]) {
                        themeQuestions = gameData.customQuizzes[gameData.selectedTheme];
                    }

                    const questionIndex = 0;
                    const question = themeQuestions[questionIndex];

                    database.ref('rooms/' + gameData.roomId).update({
                        gameState: 'playing',
                        currentQuestionIndex: questionIndex,
                        currentQuestionData: question,
                        answers: {},
                        questionStartTime: Date.now()
                    });
                });
            });

            // –ö–Ω–æ–ø–∫–∞ "–ì–æ—Ç–æ–≤"
            readyBtn.addEventListener('click', function() {
                database.ref('rooms/' + gameData.roomId + '/players/' + gameData.playerId).update({
                    ready: true,
                    lastActive: Date.now()
                });

                readyBtn.disabled = true;
                readyBtn.innerHTML = '<span class="loader"></span> –û–ñ–ò–î–ê–ù–ò–ï';
            });

            // –°–ª–µ–¥—É—é—â–∏–π —Ä–∞—É–Ω–¥
            nextRoundBtn.addEventListener('click', function() {
                if (!gameData.isHost) return;

                const nextQuestionIndex = gameData.currentQuestion + 1;
                let themeQuestions = questions[gameData.selectedTheme];

                // –ü—Ä–æ–≤–µ—Ä—è–µ–º, –µ—Å—Ç—å –ª–∏ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å—Å–∫–∏–µ –æ–ø—Ä–æ—Å—ã –¥–ª—è —ç—Ç–æ–π —Ç–µ–º—ã
                if (gameData.customQuizzes[gameData.selectedTheme]) {
                    themeQuestions = gameData.customQuizzes[gameData.selectedTheme];
                }

                if (nextQuestionIndex >= themeQuestions.length) {
                    // –ö–æ–Ω–µ—Ü –∏–≥—Ä—ã
                    database.ref('rooms/' + gameData.roomId).update({
                        gameState: 'endgame'
                    });
                } else {
                    // –°–ª–µ–¥—É—é—â–∏–π –≤–æ–ø—Ä–æ—Å
                    const nextQuestion = themeQuestions[nextQuestionIndex];

                    database.ref('rooms/' + gameData.roomId).update({
                        gameState: 'playing',
                        currentQuestionIndex: nextQuestionIndex,
                        currentQuestionData: nextQuestion,
                        answers: {},
                        questionStartTime: Date.now()
                    });
                }
            });

            // –ó–∞–≤–µ—Ä—à–∏—Ç—å –∏–≥—Ä—É
            endGameBtn.addEventListener('click', function() {
                if (!gameData.isHost) return;

                database.ref('rooms/' + gameData.roomId).update({
                    gameState: 'endgame'
                });
            });

            // –ò–≥—Ä–∞—Ç—å –µ—â–µ
            playAgainBtn.addEventListener('click', function() {
                if (!gameData.isHost) return;

                // –°–±—Ä–∞—Å—ã–≤–∞–µ–º –æ—á–∫–∏ –≤—Å–µ—Ö –∏–≥—Ä–æ–∫–æ–≤
                const updates = {};
                Object.keys(gameData.players).forEach(playerId => {
                    updates['/players/' + playerId + '/score'] = 0;
                    updates['/players/' + playerId + '/ready'] = false;
                });

                database.ref('rooms/' + gameData.roomId).update(updates).then(() => {
                    database.ref('rooms/' + gameData.roomId).update({
                        gameState: 'lobby',
                        currentQuestionIndex: 0,
                        currentQuestionData: null,
                        answers: {}
                    });
                });
            });

            // –í–µ—Ä–Ω—É—Ç—å—Å—è –≤ –ª–æ–±–±–∏
            backToLobbyBtn.addEventListener('click', function() {
                if (!gameData.isHost) return;

                database.ref('rooms/' + gameData.roomId).update({
                    gameState: 'lobby',
                    currentQuestionIndex: 0,
                    currentQuestionData: null,
                    answers: {}
                });
            });

            // –ü–æ–∫–∏–Ω—É—Ç—å –∫–æ–º–Ω–∞—Ç—É
            leaveRoomBtn.addEventListener('click', function() {
                if (confirm('–í—ã —É–≤–µ—Ä–µ–Ω—ã, —á—Ç–æ —Ö–æ—Ç–∏—Ç–µ –ø–æ–∫–∏–Ω—É—Ç—å –∫–æ–º–Ω–∞—Ç—É?')) {
                    leaveRoom();
                }
            });

            // –í–µ—Ä–Ω—É—Ç—å—Å—è –≤ –≥–ª–∞–≤–Ω–æ–µ –º–µ–Ω—é
            backToMainBtn.addEventListener('click', function() {
                if (confirm('–í—ã —É–≤–µ—Ä–µ–Ω—ã, —á—Ç–æ —Ö–æ—Ç–∏—Ç–µ –≤–µ—Ä–Ω—É—Ç—å—Å—è –≤ –≥–ª–∞–≤–Ω–æ–µ –º–µ–Ω—é?')) {
                    leaveRoom();
                    resetToMainMenu();
                }
            });

            function leaveRoom() {
                if (gameData.roomId && gameData.playerId) {
                    // –£–¥–∞–ª—è–µ–º –∏–≥—Ä–æ–∫–∞ –∏–∑ –∫–æ–º–Ω–∞—Ç—ã
                    database.ref('rooms/' + gameData.roomId + '/players/' + gameData.playerId).remove().then(() => {
                        // –ü—Ä–æ–≤–µ—Ä—è–µ–º, –ø—É—Å—Ç–∞—è –ª–∏ –∫–æ–º–Ω–∞—Ç–∞
                        database.ref('rooms/' + gameData.roomId + '/players').once('value').then(snapshot => {
                            const players = snapshot.val() || {};
                            if (Object.keys(players).length === 0) {
                                // –ï—Å–ª–∏ –∫–æ–º–Ω–∞—Ç–∞ –ø—É—Å—Ç–∞, —É–¥–∞–ª—è–µ–º –µ–µ
                                database.ref('rooms/' + gameData.roomId).remove();
                            } else if (gameData.isHost) {
                                // –ï—Å–ª–∏ —Ö–æ—Å—Ç —É—Ö–æ–¥–∏—Ç, –Ω–∞–∑–Ω–∞—á–∞–µ–º –Ω–æ–≤–æ–≥–æ —Ö–æ—Å—Ç–∞
                                const playerIds = Object.keys(players);
                                if (playerIds.length > 0) {
                                    const newHostId = playerIds[0];
                                    database.ref('rooms/' + gameData.roomId).update({
                                        hostId: newHostId
                                    });
                                    database.ref('rooms/' + gameData.roomId + '/players/' + newHostId).update({
                                        isHost: true
                                    });
                                }
                            }
                        });
                    });
                }

                resetToMainMenu();
            }

            // –û—Ç–ø—Ä–∞–≤–∫–∞ —Å–æ–æ–±—â–µ–Ω–∏—è –≤ —á–∞—Ç
            sendMessageBtn.addEventListener('click', sendMessage);
            chatInput.addEventListener('keypress', function(e) {
                if (e.key === 'Enter') sendMessage();
            });

            function sendMessage() {
                const message = chatInput.value.trim();
                if (!message || !gameData.roomId) return;

                const messageId = Date.now();
                database.ref('rooms/' + gameData.roomId + '/chat/' + messageId).set({
                    sender: gameData.playerName,
                    text: message,
                    timestamp: Date.now(),
                    senderId: gameData.playerId
                });

                chatInput.value = '';
            }

            // –ù–∞—á–∞–ª–æ –∏–≥—Ä—ã
            function startGame() {
                document.getElementById('lobbyView').style.display = 'none';
                document.getElementById('gameArea').style.display = 'block';
                document.getElementById('results').style.display = 'none';
                document.getElementById('endGameResults').style.display = 'none';

                loadQuestionFromData();
                startTimer();
            }

            // –ó–∞–≥—Ä—É–∑–∫–∞ –≤–æ–ø—Ä–æ—Å–∞ –∏–∑ –¥–∞–Ω–Ω—ã—Ö
            function loadQuestionFromData() {
                const question = gameData.currentQuestionData;
                if (!question) return;

                document.getElementById('questionText').textContent = question.question;
                const optionsGrid = document.getElementById('optionsGrid');
                optionsGrid.innerHTML = '';

                question.options.forEach((option, index) => {
                    const optionElement = document.createElement('div');
                    optionElement.className = 'option';
                    optionElement.textContent = option;
                    optionElement.dataset.index = index;

                    optionElement.addEventListener('click', function() {
                        if (!gameData.playerId || gameData.playerAnswers[gameData.playerId]) return;

                        const selectedIndex = parseInt(this.dataset.index);
                        submitAnswer(selectedIndex);
                    });

                    optionsGrid.appendChild(optionElement);
                });

                // –°–±—Ä–∞—Å—ã–≤–∞–µ–º –æ—Ç–≤–µ—Ç—ã –Ω–∞ –∫–ª–∏–µ–Ω—Ç–µ
                gameData.playerAnswers = {};

                // –í–∫–ª—é—á–∞–µ–º –≤–∞—Ä–∏–∞–Ω—Ç—ã –æ—Ç–≤–µ—Ç–æ–≤
                document.querySelectorAll('.option').forEach(opt => {
                    opt.classList.remove('disabled');
                    opt.style.pointerEvents = 'auto';
                });
            }

            // –û—Ç–ø—Ä–∞–≤–∫–∞ –æ—Ç–≤–µ—Ç–∞
            function submitAnswer(answerIndex) {
                if (!gameData.roomId || !gameData.playerId) return;

                database.ref('rooms/' + gameData.roomId + '/answers/' + gameData.playerId).set({
                    answer: answerIndex,
                    timestamp: Date.now(),
                    playerName: gameData.playerName
                });

                // –û—Ç–∫–ª—é—á–∞–µ–º –≤–∞—Ä–∏–∞–Ω—Ç—ã –æ—Ç–≤–µ—Ç–æ–≤ –¥–ª—è —ç—Ç–æ–≥–æ –∏–≥—Ä–æ–∫–∞
                document.querySelectorAll('.option').forEach(opt => {
                    opt.classList.add('disabled');
                    opt.style.pointerEvents = 'none';
                });
            }

            // –¢–∞–π–º–µ—Ä
            function startTimer() {
                clearInterval(gameData.timerInterval);
                gameData.timer = 30;
                updateTimerDisplay();

                gameData.timerInterval = setInterval(() => {
                    gameData.timer--;
                    updateTimerDisplay();

                    if (gameData.timer <= 0) {
                        clearInterval(gameData.timerInterval);
                        if (gameData.isHost) {
                            endQuestion();
                        }
                    }
                }, 1000);
            }

            function endQuestion() {
                if (!gameData.isHost) return;

                // –ü–æ–∫–∞–∑—ã–≤–∞–µ–º —Ä–µ–∑—É–ª—å—Ç–∞—Ç—ã
                database.ref('rooms/' + gameData.roomId).update({
                    gameState: 'results'
                });
            }

            // –†–∞—Å—á–µ—Ç —Ä–µ–∑—É–ª—å—Ç–∞—Ç–æ–≤ —Ä–∞—É–Ω–¥–∞
            function calculateRoundResults() {
                const question = gameData.currentQuestionData;
                if (!question) return;

                // –ü–æ–ª—É—á–∞–µ–º –ø—Ä–∞–≤–∏–ª—å–Ω—ã–π –æ—Ç–≤–µ—Ç
                const correctAnswerIndex = question.answer;
                const correctAnswerText = question.options[correctAnswerIndex];

                // –°–æ–±–∏—Ä–∞–µ–º —Å—Ç–∞—Ç–∏—Å—Ç–∏–∫—É
                const totalPlayers = Object.keys(gameData.players).length;
                let correctCount = 0;
                const correctPlayers = [];

                // –ü—Ä–æ–≤–µ—Ä—è–µ–º –æ—Ç–≤–µ—Ç—ã –∏–≥—Ä–æ–∫–æ–≤
                Object.keys(gameData.playerAnswers).forEach(playerId => {
                    const answer = gameData.playerAnswers[playerId];
                    const player = gameData.players[playerId];

                    if (answer && player) {
                        if (answer.answer === correctAnswerIndex) {
                            correctCount++;
                            correctPlayers.push({
                                name: player.name,
                                isHost: player.isHost
                            });

                            // –û–±–Ω–æ–≤–ª—è–µ–º –æ—á–∫–∏ –Ω–∞ —Å–µ—Ä–≤–µ—Ä–µ
                            database.ref('rooms/' + gameData.roomId + '/players/' + playerId).update({
                                score: (player.score || 0) + 10
                            });
                        }
                    }
                });

                // –°–æ—Ö—Ä–∞–Ω—è–µ–º —Ä–µ–∑—É–ª—å—Ç–∞—Ç—ã
                gameData.roundResults = {
                    correctAnswer: correctAnswerText,
                    correctPlayers: correctPlayers,
                    correctCount: correctCount,
                    totalPlayers: totalPlayers,
                    percentage: totalPlayers > 0 ? Math.round((correctCount / totalPlayers) * 100) : 0
                };
            }

            // –ü–æ–∫–∞–∑–∞—Ç—å —Ä–µ–∑—É–ª—å—Ç–∞—Ç—ã —Ä–∞—É–Ω–¥–∞
            function showResults() {
                document.getElementById('gameArea').style.display = 'none';
                document.getElementById('results').style.display = 'block';
                document.getElementById('endGameResults').style.display = 'none';

                // –†–∞—Å—Å—á–∏—Ç—ã–≤–∞–µ–º —Ä–µ–∑—É–ª—å—Ç–∞—Ç—ã
                calculateRoundResults();

                // –û–±–Ω–æ–≤–ª—è–µ–º –æ—Ç–æ–±—Ä–∞–∂–µ–Ω–∏–µ
                updateResultsDisplay();

                // –ü–æ–∫–∞–∑—ã–≤–∞–µ–º –∫–Ω–æ–ø–∫–∏ —É–ø—Ä–∞–≤–ª–µ–Ω–∏—è
                nextRoundBtn.style.display = gameData.isHost ? 'block' : 'none';
                endGameBtn.style.display = gameData.isHost ? 'block' : 'none';
            }

            // –û–±–Ω–æ–≤–∏—Ç—å –æ—Ç–æ–±—Ä–∞–∂–µ–Ω–∏–µ —Ä–µ–∑—É–ª—å—Ç–∞—Ç–æ–≤
            function updateResultsDisplay() {
                const results = gameData.roundResults;

                // –ü–æ–∫–∞–∑—ã–≤–∞–µ–º –ø—Ä–∞–≤–∏–ª—å–Ω—ã–π –æ—Ç–≤–µ—Ç
                document.getElementById('correctAnswerText').textContent = results.correctAnswer;

                // –û–±–Ω–æ–≤–ª—è–µ–º —Å—Ç–∞—Ç–∏—Å—Ç–∏–∫—É
                document.getElementById('correctCount').textContent = results.correctCount;
                document.getElementById('totalPlayersCount').textContent = results.totalPlayers;
                document.getElementById('correctPercentage').textContent = results.percentage + '%';

                // –ü–æ–∫–∞–∑—ã–≤–∞–µ–º –∏–≥—Ä–æ–∫–æ–≤, –æ—Ç–≤–µ—Ç–∏–≤—à–∏—Ö –ø—Ä–∞–≤–∏–ª—å–Ω–æ
                const correctPlayersList = document.getElementById('correctPlayersList');
                const correctPlayersContainer = document.getElementById('correctPlayersContainer');

                correctPlayersList.innerHTML = '';

                if (results.correctPlayers.length > 0) {
                    results.correctPlayers.forEach(player => {
                        const playerElement = document.createElement('div');
                        playerElement.className = 'correct-player';
                        playerElement.innerHTML = `
                            ${player.name}
                            ${player.isHost ? '<span class="host-badge" style="font-size: 0.7rem; padding: 1px 5px;">–•–û–°–¢</span>' : ''}
                            <span style="color: #00ff9d;">(+10 –æ—á–∫–æ–≤)</span>
                        `;
                        correctPlayersList.appendChild(playerElement);
                    });
                    correctPlayersContainer.style.display = 'block';
                } else {
                    correctPlayersContainer.style.display = 'none';
                    const noCorrectElement = document.createElement('div');
                    noCorrectElement.className = 'correct-player';
                    noCorrectElement.textContent = '–ù–∏–∫—Ç–æ –Ω–µ –æ—Ç–≤–µ—Ç–∏–ª –ø—Ä–∞–≤–∏–ª—å–Ω–æ üòî';
                    noCorrectElement.style.color = '#ff5555';
                    correctPlayersList.appendChild(noCorrectElement);
                    correctPlayersContainer.style.display = 'block';
                }

                // –û–±–Ω–æ–≤–ª—è–µ–º —Ç–∞–±–ª–∏—Ü—É —Ä–µ–∑—É–ª—å—Ç–∞—Ç–æ–≤
                const scoreboard = document.getElementById('scoreboard');
                scoreboard.innerHTML = '<h3 style="color: #00f3ff; margin-bottom: 10px;">–û–ë–©–ò–ô –ó–ê–ß–ï–¢:</h3>';

                const playersArray = Object.values(gameData.players);
                const sortedPlayers = [...playersArray].sort((a, b) => b.score - a.score);

                sortedPlayers.forEach((player, index) => {
                    const playerRow = document.createElement('div');
                    playerRow.className = 'player-item';

                    // –ü–æ–¥—Å–≤–µ—á–∏–≤–∞–µ–º –∏–≥—Ä–æ–∫–æ–≤, –æ—Ç–≤–µ—Ç–∏–≤—à–∏—Ö –ø—Ä–∞–≤–∏–ª—å–Ω–æ
                    const answeredCorrectly = results.correctPlayers.some(p => p.name === player.name);
                    playerRow.style.borderLeftColor = answeredCorrectly ? '#00ff9d' : '#ff00ff';
                    playerRow.style.marginBottom = '10px';

                    playerRow.innerHTML = `
                        <span style="font-weight: bold; margin-right: 10px;">${index + 1}.</span>
                        <i class="fas fa-user player-icon"></i>
                        <span>${player.name}</span>
                        ${player.isHost ? '<span class="host-badge">–•–û–°–¢</span>' : ''}
                        ${answeredCorrectly ? '<i class="fas fa-check" style="color: #00ff9d; margin-left: 5px;"></i>' : ''}
                        <span class="player-score">${player.score} pts</span>
                    `;

                    scoreboard.appendChild(playerRow);
                });
            }

            // –ü–æ–∫–∞–∑–∞—Ç—å —Ñ–∏–Ω–∞–ª—å–Ω—ã–µ —Ä–µ–∑—É–ª—å—Ç–∞—Ç—ã
            function showEndGameResults() {
                document.getElementById('gameArea').style.display = 'none';
                document.getElementById('results').style.display = 'none';
                document.getElementById('endGameResults').style.display = 'block';

                // –û–ø—Ä–µ–¥–µ–ª—è–µ–º –ø–æ–±–µ–¥–∏—Ç–µ–ª—è –∏–≥—Ä—ã
                const playersArray = Object.values(gameData.players);
                const sortedPlayers = [...playersArray].sort((a, b) => b.score - a.score);
                const winner = sortedPlayers[0];

                if (winner) {
                    document.getElementById('finalWinnerName').textContent = `üèÜ –ü–û–ë–ï–î–ò–¢–ï–õ–¨: ${winner.name} (${winner.score} –æ—á–∫–æ–≤) üèÜ`;
                }

                // –û–±–Ω–æ–≤–ª—è–µ–º —Ñ–∏–Ω–∞–ª—å–Ω—É—é —Ç–∞–±–ª–∏—Ü—É —Ä–µ–∑—É–ª—å—Ç–∞—Ç–æ–≤
                const finalScoreboard = document.getElementById('finalScoreboard');
                finalScoreboard.innerHTML = '';

                sortedPlayers.forEach((player, index) => {
                    const playerRow = document.createElement('div');
                    playerRow.className = 'player-item';

                    // –ú–µ–¥–∞–ª–∏ –¥–ª—è –ø–µ—Ä–≤—ã—Ö —Ç—Ä–µ—Ö –º–µ—Å—Ç
                    let medal = '';
                    if (index === 0) {
                        medal = 'ü•á';
                        playerRow.style.borderLeftColor = 'gold';
                    } else if (index === 1) {
                        medal = 'ü•à';
                        playerRow.style.borderLeftColor = 'silver';
                    } else if (index === 2) {
                        medal = 'ü•â';
                        playerRow.style.borderLeftColor = '#cd7f32'; // –±—Ä–æ–Ω–∑–∞
                    } else {
                        playerRow.style.borderLeftColor = '#ff00ff';
                    }

                    playerRow.style.marginBottom = '10px';

                    playerRow.innerHTML = `
                        <span style="font-weight: bold; margin-right: 10px;">${index + 1}${medal}</span>
                        <i class="fas fa-user player-icon"></i>
                        <span>${player.name}</span>
                        ${player.isHost ? '<span class="host-badge">–•–û–°–¢</span>' : ''}
                        <span class="player-score">${player.score} pts</span>
                    `;

                    finalScoreboard.appendChild(playerRow);
                });
            }

            // –û–±–Ω–æ–≤–ª–µ–Ω–∏–µ —Å–ø–∏—Å–∫–∞ –∏–≥—Ä–æ–∫–æ–≤
            function updatePlayerList() {
                const playerList = document.getElementById('playerList');
                playerList.innerHTML = '';

                Object.keys(gameData.players).forEach(playerId => {
                    const player = gameData.players[playerId];
                    const li = document.createElement('li');
                    li.className = 'player-item';
                    li.style.borderLeftColor = player.isHost ? '#00ff9d' : '#ff00ff';

                    li.innerHTML = `
                        <i class="fas fa-user player-icon"></i>
                        <span>${player.name}</span>
                        ${player.isHost ? '<span class="host-badge">–•–û–°–¢</span>' : ''}
                        ${player.ready ? '<i class="fas fa-check" style="color: #00ff9d; margin-left: 5px;"></i>' : ''}
                        <span class="player-score">${player.score} pts</span>
                    `;

                    // –î–æ–±–∞–≤–ª—è–µ–º –∫–Ω–æ–ø–∫—É –∫–∏–∫–∞ –¥–ª—è —Ö–æ—Å—Ç–∞ (—Ç–æ–ª—å–∫–æ –¥–ª—è –¥—Ä—É–≥–∏—Ö –∏–≥—Ä–æ–∫–æ–≤)
                    if (gameData.isHost && playerId !== gameData.playerId) {
                        const kickBtn = document.createElement('button');
                        kickBtn.className = 'kick-btn';
                        kickBtn.innerHTML = '<i class="fas fa-times"></i>';
                        kickBtn.title = '–ò—Å–∫–ª—é—á–∏—Ç—å –∏–≥—Ä–æ–∫–∞';
                        kickBtn.style.display = 'block';

                        kickBtn.addEventListener('click', function(e) {
                            e.stopPropagation();
                            if (confirm(`–ò—Å–∫–ª—é—á–∏—Ç—å –∏–≥—Ä–æ–∫–∞ ${player.name}?`)) {
                                database.ref('rooms/' + gameData.roomId + '/players/' + playerId).remove();
                                showNotification('–ò–≥—Ä–æ–∫ –∏—Å–∫–ª—é—á–µ–Ω', `${player.name} –±—ã–ª –∏—Å–∫–ª—é—á–µ–Ω –∏–∑ –∫–æ–º–Ω–∞—Ç—ã`);
                            }
                        });

                        li.appendChild(kickBtn);
                    }

                    playerList.appendChild(li);
                });

                // –û–±–Ω–æ–≤–ª—è–µ–º —Å—á–µ—Ç—á–∏–∫ –∏–≥—Ä–æ–∫–æ–≤
                const playerCount = Object.keys(gameData.players).length;
                document.getElementById('onlineCount').textContent = playerCount;

                // –û–±–Ω–æ–≤–ª—è–µ–º —Å—Ç–∞—Ç—É—Å –≥–æ—Ç–æ–≤–Ω–æ—Å—Ç–∏ –¥–ª—è —Ö–æ—Å—Ç–∞
                if (gameData.isHost && startGameBtn) {
                    const allReady = Object.values(gameData.players).every(p => p.ready || p.isHost);
                    startGameBtn.disabled = playerCount < 2 || !allReady;
                }
            }

            // –û–±–Ω–æ–≤–ª–µ–Ω–∏–µ —á–∞—Ç–∞
            function updateChat(messages) {
                const chatMessages = document.getElementById('chatMessages');
                chatMessages.innerHTML = '';

                // –°–æ—Ä—Ç–∏—Ä—É–µ–º —Å–æ–æ–±—â–µ–Ω–∏—è –ø–æ –≤—Ä–µ–º–µ–Ω–∏
                const sortedMessageIds = Object.keys(messages).sort((a, b) => a - b);

                sortedMessageIds.forEach(messageId => {
                    const message = messages[messageId];
                    const messageElement = document.createElement('div');
                    messageElement.className = 'message';

                    const isOwnMessage = message.senderId === gameData.playerId;

                    messageElement.innerHTML = `
                        <div class="message-sender" style="color: ${isOwnMessage ? '#00ff9d' : '#ff00ff'}">
                            ${message.sender}${isOwnMessage ? ' (–í—ã)' : ''}
                        </div>
                        <div>${message.text}</div>
                        <div style="font-size: 0.8rem; color: #aaa; text-align: right;">
                            ${new Date(message.timestamp).toLocaleTimeString([], {hour: '2-digit', minute:'2-digit'})}
                        </div>
                    `;

                    chatMessages.appendChild(messageElement);
                });

                // –ü—Ä–æ–∫—Ä—É—á–∏–≤–∞–µ–º –≤–Ω–∏–∑
                chatMessages.scrollTop = chatMessages.scrollHeight;
            }

            // –û–±–Ω–æ–≤–ª–µ–Ω–∏–µ —Å–µ–ª–µ–∫—Ç–æ—Ä–∞ —Ç–µ–º
            function updateThemeSelector() {
                document.querySelectorAll('.theme-btn').forEach(btn => {
                    btn.classList.remove('active-theme');
                    if (btn.getAttribute('data-theme') === gameData.selectedTheme) {
                        btn.classList.add('active-theme');
                    }

                    // –î–æ–±–∞–≤–ª—è–µ–º –æ–±—Ä–∞–±–æ—Ç—á–∏–∫–∏ –¥–ª—è —Ö–æ—Å—Ç–∞
                    if (gameData.isHost) {
                        btn.onclick = function() {
                            const theme = this.getAttribute('data-theme');
                            database.ref('rooms/' + gameData.roomId).update({
                                theme: theme
                            });
                            showNotification('–¢–µ–º–∞ –∏–∑–º–µ–Ω–µ–Ω–∞', `–¢–µ–º–∞ –∏–≥—Ä—ã: ${getThemeName(theme)}`);
                        };
                    } else {
                        btn.style.cursor = 'default';
                    }
                });
            }

            // –û–±–Ω–æ–≤–ª–µ–Ω–∏–µ —Ç–∞–π–º–µ—Ä–∞
            function updateTimerDisplay() {
                document.getElementById('timer').textContent = gameData.timer;

                if (gameData.timer <= 10) {
                    document.getElementById('timer').style.color = '#ff0000';
                    document.getElementById('timer').classList.add('pulse');
                } else {
                    document.getElementById('timer').style.color = '#ff00ff';
                    document.getElementById('timer').classList.remove('pulse');
                }
            }

            // –°–±—Ä–æ—Å –∫ –≥–ª–∞–≤–Ω–æ–º—É –º–µ–Ω—é
            function resetToMainMenu() {
                // –û—á–∏—â–∞–µ–º –≤—Å–µ –∏–Ω—Ç–µ—Ä–≤–∞–ª—ã
                clearInterval(gameData.timerInterval);

                // –°–∫—Ä—ã–≤–∞–µ–º –∏–≥—Ä–æ–≤–æ–π –∏–Ω—Ç–µ—Ä—Ñ–µ–π—Å
                document.getElementById('gameInterface').style.display = 'none';
                document.querySelector('.room-controls').style.display = 'flex';
                document.getElementById('roomCodeDisplay').style.display = 'none';

                // –°–±—Ä–∞—Å—ã–≤–∞–µ–º –∏–≥—Ä–æ–≤—ã–µ –¥–∞–Ω–Ω—ã–µ
                gameData.roomId = null;
                gameData.playerId = null;
                gameData.isHost = false;
                gameData.players = {};
                gameData.gameState = "lobby";

                // –û–±–Ω–æ–≤–ª—è–µ–º —Å—Ç–∞—Ç—É—Å
                document.getElementById('roomName').textContent = '–ù–µ –ø–æ–¥–∫–ª—é—á–µ–Ω–æ';
                document.getElementById('onlineCount').textContent = '0';
                document.getElementById('gameStatus').textContent = '–û–∂–∏–¥–∞–Ω–∏–µ';
            }
        }

        // –ò–Ω–∏—Ü–∏–∞–ª–∏–∑–∞—Ü–∏—è —Å–æ–∑–¥–∞–Ω–∏—è –æ–ø—Ä–æ—Å–æ–≤
        function initQuizCreator() {
            document.getElementById('createQuizBtn').addEventListener('click', showQuizCreator);
            document.getElementById('cancelQuizBtn').addEventListener('click', hideQuizCreator);
            document.getElementById('saveQuizBtn').addEventListener('click', saveQuiz);
            document.getElementById('publishQuizBtn').addEventListener('click', publishQuiz);
            document.getElementById('addQuestionBtn').addEventListener('click', addQuestion);

            // –ò–Ω–∏—Ü–∏–∞–ª–∏–∑–∏—Ä—É–µ–º –≤—ã–±–æ—Ä —Ç–µ–º—ã –≤ —Å–æ–∑–¥–∞–Ω–∏–∏ –æ–ø—Ä–æ—Å–∞
            document.querySelectorAll('.quiz-theme-btn').forEach(btn => {
                btn.addEventListener('click', function() {
                    document.querySelectorAll('.quiz-theme-btn').forEach(b => b.classList.remove('active'));
                    this.classList.add('active');
                    generateQuizPreview();
                });
            });

            // –û–±–Ω–æ–≤–ª—è–µ–º –ø—Ä–µ–≤—å—é –ø—Ä–∏ –≤–≤–æ–¥–µ
            document.getElementById('questionsContainer').addEventListener('input', generateQuizPreview);
            document.getElementById('quizTitle').addEventListener('input', generateQuizPreview);
        }

        // –ü–æ–∫–∞–∑–∞—Ç—å —Å–æ–∑–¥–∞–Ω–∏–µ –æ–ø—Ä–æ—Å–∞
        function showQuizCreator() {
            if (gameData.isGuest) {
                showNotification('–û—à–∏–±–∫–∞', '–í–æ–π–¥–∏—Ç–µ –≤ —Å–∏—Å—Ç–µ–º—É –¥–ª—è —Å–æ–∑–¥–∞–Ω–∏—è –æ–ø—Ä–æ—Å–æ–≤', '#ff0000');
                return;
            }

            document.getElementById('quizCreatorModal').style.display = 'block';
            generateQuizPreview();
        }

        // –°–∫—Ä—ã—Ç—å —Å–æ–∑–¥–∞–Ω–∏–µ –æ–ø—Ä–æ—Å–∞
        function hideQuizCreator() {
            document.getElementById('quizCreatorModal').style.display = 'none';
            resetQuizForm();
        }

        // –°–±—Ä–æ—Å —Ñ–æ—Ä–º—ã –æ–ø—Ä–æ—Å–∞
        function resetQuizForm() {
            document.getElementById('quizTitle').value = '';
            document.getElementById('quizDescription').value = '';
            document.getElementById('questionsContainer').innerHTML = `
                <div class="question-item" data-index="0">
                    <div class="form-group">
                        <label class="form-label">–í–æ–ø—Ä–æ—Å 1:</label>
                        <input type="text" class="auth-input question-text" placeholder="–í–≤–µ–¥–∏—Ç–µ —Ç–µ–∫—Å—Ç –≤–æ–ø—Ä–æ—Å–∞" maxlength="200">
                    </div>

                    <div class="options-container">
                        <div class="option-row">
                            <input type="radio" name="correct0" class="correct-option" value="0" checked>
                            <input type="text" class="auth-input option-input" placeholder="–í–∞—Ä–∏–∞–Ω—Ç –æ—Ç–≤–µ—Ç–∞ 1" maxlength="100">
                            <button class="remove-option-btn" onclick="removeOption(this)">√ó</button>
                        </div>
                        <div class="option-row">
                            <input type="radio" name="correct0" class="correct-option" value="1">
                            <input type="text" class="auth-input option-input" placeholder="–í–∞—Ä–∏–∞–Ω—Ç –æ—Ç–≤–µ—Ç–∞ 2" maxlength="100">
                            <button class="remove-option-btn" onclick="removeOption(this)">√ó</button>
                        </div>
                    </div>
                    <button class="add-option-btn" onclick="addOption(this)"><i class="fas fa-plus"></i> –î–æ–±–∞–≤–∏—Ç—å –≤–∞—Ä–∏–∞–Ω—Ç</button>
                    <button class="remove-question-btn" onclick="removeQuestion(this)"><i class="fas fa-trash"></i> –£–¥–∞–ª–∏—Ç—å –≤–æ–ø—Ä–æ—Å</button>
                </div>
            `;
        }

        // –î–æ–±–∞–≤–∏—Ç—å –≤–æ–ø—Ä–æ—Å
        function addQuestion() {
            const questionsContainer = document.getElementById('questionsContainer');
            const questionCount = questionsContainer.children.length;

            const questionHTML = `
                <div class="question-item" data-index="${questionCount}">
                    <div class="form-group">
                        <label class="form-label">–í–æ–ø—Ä–æ—Å ${questionCount + 1}:</label>
                        <input type="text" class="auth-input question-text" placeholder="–í–≤–µ–¥–∏—Ç–µ —Ç–µ–∫—Å—Ç –≤–æ–ø—Ä–æ—Å–∞" maxlength="200">
                    </div>

                    <div class="options-container">
                        <div class="option-row">
                            <input type="radio" name="correct${questionCount}" class="correct-option" value="0" checked>
                            <input type="text" class="auth-input option-input" placeholder="–í–∞—Ä–∏–∞–Ω—Ç –æ—Ç–≤–µ—Ç–∞ 1" maxlength="100">
                            <button class="remove-option-btn" onclick="removeOption(this)">√ó</button>
                        </div>
                        <div class="option-row">
                            <input type="radio" name="correct${questionCount}" class="correct-option" value="1">
                            <input type="text" class="auth-input option-input" placeholder="–í–∞—Ä–∏–∞–Ω—Ç –æ—Ç–≤–µ—Ç–∞ 2" maxlength="100">
                            <button class="remove-option-btn" onclick="removeOption(this)">√ó</button>
                        </div>
                    </div>
                    <button class="add-option-btn" onclick="addOption(this)"><i class="fas fa-plus"></i> –î–æ–±–∞–≤–∏—Ç—å –≤–∞—Ä–∏–∞–Ω—Ç</button>
                    <button class="remove-question-btn" onclick="removeQuestion(this)"><i class="fas fa-trash"></i> –£–¥–∞–ª–∏—Ç—å –≤–æ–ø—Ä–æ—Å</button>
                </div>
            `;

            questionsContainer.insertAdjacentHTML('beforeend', questionHTML);
            generateQuizPreview();
        }

        // –ì–ª–æ–±–∞–ª—å–Ω—ã–µ —Ñ—É–Ω–∫—Ü–∏–∏ –¥–ª—è –∫–Ω–æ–ø–æ–∫
        window.addOption = function(button) {
            const questionItem = button.closest('.question-item');
            const optionsContainer = questionItem.querySelector('.options-container');
            const optionCount = optionsContainer.children.length;

            const optionHTML = `
                <div class="option-row">
                    <input type="radio" name="${questionItem.dataset.index}" class="correct-option" value="${optionCount}">
                    <input type="text" class="auth-input option-input" placeholder="–í–∞—Ä–∏–∞–Ω—Ç –æ—Ç–≤–µ—Ç–∞ ${optionCount + 1}" maxlength="100">
                    <button class="remove-option-btn" onclick="removeOption(this)">√ó</button>
                </div>
            `;

            optionsContainer.insertAdjacentHTML('beforeend', optionHTML);
            generateQuizPreview();
        };

        window.removeOption = function(button) {
            const optionRow = button.closest('.option-row');
            const optionsContainer = optionRow.parentElement;

            if (optionsContainer.children.length > 2) {
                optionRow.remove();
                // –û–±–Ω–æ–≤–ª—è–µ–º –∏–Ω–¥–µ–∫—Å—ã –∏ checked —Å–æ—Å—Ç–æ—è–Ω–∏–µ
                updateOptionsIndices(optionsContainer);
                generateQuizPreview();
            } else {
                showNotification('–û—à–∏–±–∫–∞', '–î–æ–ª–∂–Ω–æ –±—ã—Ç—å –º–∏–Ω–∏–º—É–º 2 –≤–∞—Ä–∏–∞–Ω—Ç–∞ –æ—Ç–≤–µ—Ç–∞', '#ff0000');
            }
        };

        window.removeQuestion = function(button) {
            const questionItem = button.closest('.question-item');
            const questionsContainer = document.getElementById('questionsContainer');

            if (questionsContainer.children.length > 1) {
                questionItem.remove();
                // –û–±–Ω–æ–≤–ª—è–µ–º –∏–Ω–¥–µ–∫—Å—ã –≤–æ–ø—Ä–æ—Å–æ–≤
                updateQuestionIndices();
                generateQuizPreview();
            } else {
                showNotification('–û—à–∏–±–∫–∞', '–î–æ–ª–∂–µ–Ω –±—ã—Ç—å –º–∏–Ω–∏–º—É–º 1 –≤–æ–ø—Ä–æ—Å', '#ff0000');
            }
        };

        // –û–±–Ω–æ–≤–∏—Ç—å –∏–Ω–¥–µ–∫—Å—ã –≤–∞—Ä–∏–∞–Ω—Ç–æ–≤ –æ—Ç–≤–µ—Ç–∞
        function updateOptionsIndices(optionsContainer) {
            const optionRows = optionsContainer.querySelectorAll('.option-row');
            optionRows.forEach((row, index) => {
                const radio = row.querySelector('.correct-option');
                radio.value = index;
            });
        }

        // –û–±–Ω–æ–≤–∏—Ç—å –∏–Ω–¥–µ–∫—Å—ã –≤–æ–ø—Ä–æ—Å–æ–≤
        function updateQuestionIndices() {
            const questions = document.querySelectorAll('.question-item');
            questions.forEach((question, index) => {
                question.dataset.index = index;
                const questionLabel = question.querySelector('.form-label');
                questionLabel.textContent = `–í–æ–ø—Ä–æ—Å ${index + 1}:`;

                // –û–±–Ω–æ–≤–ª—è–µ–º name —É radio –∫–Ω–æ–ø–æ–∫
                const radios = question.querySelectorAll('.correct-option');
                radios.forEach(radio => {
                    radio.name = `correct${index}`;
                });
            });
        }

        // –°–≥–µ–Ω–µ—Ä–∏—Ä–æ–≤–∞—Ç—å –ø—Ä–µ–≤—å—é –æ–ø—Ä–æ—Å–∞
        function generateQuizPreview() {
            const preview = document.getElementById('quizPreview');
            let html = '<div class="question-box" style="margin-bottom: 15px;">';

            const questions = document.querySelectorAll('.question-item');
            questions.forEach((question, qIndex) => {
                const questionText = question.querySelector('.question-text').value || '–ü—Ä–∏–º–µ—Ä –≤–æ–ø—Ä–æ—Å–∞';
                const options = question.querySelectorAll('.option-input');
                const correctIndex = parseInt(question.querySelector('.correct-option:checked').value);

                html += `<div style="margin-bottom: 20px;">`;
                html += `<div class="question-text" style="font-size: 1.1rem; color: #00f3ff;">${qIndex + 1}. ${questionText}</div>`;
                html += `<div style="margin-top: 10px;">`;

                options.forEach((option, oIndex) => {
                    const optionText = option.value || `–í–∞—Ä–∏–∞–Ω—Ç ${oIndex + 1}`;
                    const isCorrect = oIndex === correctIndex;
                    html += `<div class="option" style="background: ${isCorrect ? 'rgba(0, 255, 157, 0.2)' : 'rgba(20, 20, 50, 0.8)'}; border-color: ${isCorrect ? '#00ff9d' : '#ff00ff'}; margin-bottom: 8px; padding: 10px; border-radius: 8px;">
                        ${optionText} ${isCorrect ? '<i class="fas fa-check" style="color: #00ff9d; margin-left: 10px;"></i>' : ''}
                    </div>`;
                });

                html += `</div></div>`;
            });

            html += '</div>';
            html += `<div style="color: #aaa; text-align: center;">–í—Å–µ–≥–æ –≤–æ–ø—Ä–æ—Å–æ–≤: ${questions.length}</div>`;

            preview.innerHTML = html;
        }

        // –°–æ—Ö—Ä–∞–Ω–∏—Ç—å –æ–ø—Ä–æ—Å
        async function saveQuiz() {
            if (!gameData.user || gameData.isGuest) {
                showNotification('–û—à–∏–±–∫–∞', '–í–æ–π–¥–∏—Ç–µ –≤ —Å–∏—Å—Ç–µ–º—É –¥–ª—è —Å–æ—Ö—Ä–∞–Ω–µ–Ω–∏—è –æ–ø—Ä–æ—Å–æ–≤', '#ff0000');
                return;
            }

            const quizData = collectQuizData();
            if (!validateQuiz(quizData)) return;

            try {
                const quizId = 'quiz_' + Date.now() + '_' + Math.random().toString(36).substr(2, 9);

                await database.ref('userQuizzes/' + gameData.user.uid + '/' + quizId).set({
                    ...quizData,
                    id: quizId,
                    authorId: gameData.user.uid,
                    authorName: gameData.user.displayName || gameData.user.email,
                    authorPhoto: gameData.user.photoURL,
                    createdAt: Date.now(),
                    isPublished: false,
                    playCount: 0,
                    rating: 0,
                    ratingsCount: 0
                });

                showNotification('–£—Å–ø–µ—Ö!', '–û–ø—Ä–æ—Å —Å–æ—Ö—Ä–∞–Ω–µ–Ω –≤ –≤–∞—à–µ–π –±–∏–±–ª–∏–æ—Ç–µ–∫–µ', '#00ff9d');
                hideQuizCreator();
                loadUserQuizzes();
            } catch (error) {
                showNotification('–û—à–∏–±–∫–∞', '–ù–µ —É–¥–∞–ª–æ—Å—å —Å–æ—Ö—Ä–∞–Ω–∏—Ç—å –æ–ø—Ä–æ—Å', '#ff0000');
                console.error(error);
            }
        }

        // –û–ø—É–±–ª–∏–∫–æ–≤–∞—Ç—å –æ–ø—Ä–æ—Å
        async function publishQuiz() {
            if (!gameData.user || gameData.isGuest) {
                showNotification('–û—à–∏–±–∫–∞', '–í–æ–π–¥–∏—Ç–µ –≤ —Å–∏—Å—Ç–µ–º—É –¥–ª—è –ø—É–±–ª–∏–∫–∞—Ü–∏–∏ –æ–ø—Ä–æ—Å–æ–≤', '#ff0000');
                return;
            }

            const quizData = collectQuizData();
            if (!validateQuiz(quizData)) return;

            try {
                const quizId = 'quiz_' + Date.now() + '_' + Math.random().toString(36).substr(2, 9);

                await database.ref('publishedQuizzes/' + quizId).set({
                    ...quizData,
                    id: quizId,
                    authorId: gameData.user.uid,
                    authorName: gameData.user.displayName || gameData.user.email,
                    authorPhoto: gameData.user.photoURL,
                    createdAt: Date.now(),
                    isPublished: true,
                    playCount: 0,
                    rating: 0,
                    ratingsCount: 0
                });

                // –¢–∞–∫–∂–µ —Å–æ—Ö—Ä–∞–Ω—è–µ–º –≤ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å—Å–∫–∏–µ
                await database.ref('userQuizzes/' + gameData.user.uid + '/' + quizId).set({
                    ...quizData,
                    id: quizId,
                    authorId: gameData.user.uid,
                    authorName: gameData.user.displayName || gameData.user.email,
                    authorPhoto: gameData.user.photoURL,
                    createdAt: Date.now(),
                    isPublished: true,
                    playCount: 0,
                    rating: 0,
                    ratingsCount: 0
                });

                showNotification('–£—Å–ø–µ—Ö!', '–û–ø—Ä–æ—Å –æ–ø—É–±–ª–∏–∫–æ–≤–∞–Ω –∏ –¥–æ—Å—Ç—É–ø–µ–Ω –≤—Å–µ–º!', '#00ff9d');
                hideQuizCreator();
                loadUserQuizzes();
                loadCustomQuizzes();
            } catch (error) {
                showNotification('–û—à–∏–±–∫–∞', '–ù–µ —É–¥–∞–ª–æ—Å—å –æ–ø—É–±–ª–∏–∫–æ–≤–∞—Ç—å –æ–ø—Ä–æ—Å', '#ff0000');
                console.error(error);
            }
        }

        // –°–æ–±—Ä–∞—Ç—å –¥–∞–Ω–Ω—ã–µ –æ–ø—Ä–æ—Å–∞
        function collectQuizData() {
            const title = document.getElementById('quizTitle').value.trim();
            const description = document.getElementById('quizDescription').value.trim();
            const theme = document.querySelector('.quiz-theme-btn.active').dataset.theme;

            const questions = [];
            const questionItems = document.querySelectorAll('.question-item');

            questionItems.forEach((item, qIndex) => {
                const questionText = item.querySelector('.question-text').value.trim();
                const options = [];
                const optionInputs = item.querySelectorAll('.option-input');
                const correctIndex = parseInt(item.querySelector('.correct-option:checked').value);

                optionInputs.forEach((input, oIndex) => {
                    options.push(input.value.trim());
                });

                questions.push({
                    question: questionText,
                    options: options,
                    answer: correctIndex
                });
            });

            return {
                title: title || '–ë–µ–∑ –Ω–∞–∑–≤–∞–Ω–∏—è',
                description: description,
                theme: theme,
                questions: questions
            };
        }

        // –í–∞–ª–∏–¥–∞—Ü–∏—è –æ–ø—Ä–æ—Å–∞
        function validateQuiz(quizData) {
            if (!quizData.title || quizData.title.length < 3) {
                showNotification('–û—à–∏–±–∫–∞', '–í–≤–µ–¥–∏—Ç–µ –Ω–∞–∑–≤–∞–Ω–∏–µ –æ–ø—Ä–æ—Å–∞ (–º–∏–Ω–∏–º—É–º 3 —Å–∏–º–≤–æ–ª–∞)', '#ff0000');
                return false;
            }

            if (quizData.questions.length === 0) {
                showNotification('–û—à–∏–±–∫–∞', '–î–æ–±–∞–≤—å—Ç–µ —Ö–æ—Ç—è –±—ã –æ–¥–∏–Ω –≤–æ–ø—Ä–æ—Å', '#ff0000');
                return false;
            }

            for (const question of quizData.questions) {
                if (!question.question || question.question.length < 5) {
                    showNotification('–û—à–∏–±–∫–∞', '–í—Å–µ –≤–æ–ø—Ä–æ—Å—ã –¥–æ–ª–∂–Ω—ã —Å–æ–¥–µ—Ä–∂–∞—Ç—å —Ç–µ–∫—Å—Ç (–º–∏–Ω–∏–º—É–º 5 —Å–∏–º–≤–æ–ª–æ–≤)', '#ff0000');
                    return false;
                }

                if (question.options.length < 2) {
                    showNotification('–û—à–∏–±–∫–∞', '–í –∫–∞–∂–¥–æ–º –≤–æ–ø—Ä–æ—Å–µ –¥–æ–ª–∂–Ω–æ –±—ã—Ç—å –º–∏–Ω–∏–º—É–º 2 –≤–∞—Ä–∏–∞–Ω—Ç–∞ –æ—Ç–≤–µ—Ç–∞', '#ff0000');
                    return false;
                }

                for (const option of question.options) {
                    if (!option || option.length === 0) {
                        showNotification('–û—à–∏–±–∫–∞', '–í—Å–µ –≤–∞—Ä–∏–∞–Ω—Ç—ã –æ—Ç–≤–µ—Ç–æ–≤ –¥–æ–ª–∂–Ω—ã –±—ã—Ç—å –∑–∞–ø–æ–ª–Ω–µ–Ω—ã', '#ff0000');
                        return false;
                    }
                }

                if (question.answer < 0 || question.answer >= question.options.length) {
                    showNotification('–û—à–∏–±–∫–∞', '–£–∫–∞–∂–∏—Ç–µ –ø—Ä–∞–≤–∏–ª—å–Ω—ã–π –≤–∞—Ä–∏–∞–Ω—Ç –æ—Ç–≤–µ—Ç–∞', '#ff0000');
                    return false;
                }
            }

            return true;
        }

        // –ó–∞–≥—Ä—É–∑–∏—Ç—å –æ–ø—Ä–æ—Å—ã –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è
        async function loadUserQuizzes() {
            if (!gameData.user || gameData.isGuest) return;

            try {
                const snapshot = await database.ref('userQuizzes/' + gameData.user.uid).once('value');
                const quizzes = snapshot.val() || {};
                gameData.userQuizzes = Object.values(quizzes);

                displayUserQuizzes(gameData.userQuizzes);
            } catch (error) {
                console.error('–û—à–∏–±–∫–∞ –∑–∞–≥—Ä—É–∑–∫–∏ –æ–ø—Ä–æ—Å–æ–≤:', error);
            }
        }

        // –ó–∞–≥—Ä—É–∑–∏—Ç—å –æ–ø—É–±–ª–∏–∫–æ–≤–∞–Ω–Ω—ã–µ –æ–ø—Ä–æ—Å—ã
        async function loadCustomQuizzes() {
            try {
                const snapshot = await database.ref('publishedQuizzes').once('value');
                const quizzes = snapshot.val() || {};
                gameData.customQuizzes = {};

                // –û—Ä–≥–∞–Ω–∏–∑—É–µ–º –æ–ø—Ä–æ—Å—ã –ø–æ —Ç–µ–º–∞–º
                Object.values(quizzes).forEach(quiz => {
                    if (!gameData.customQuizzes[quiz.theme]) {
                        gameData.customQuizzes[quiz.theme] = [];
                    }
                    gameData.customQuizzes[quiz.theme] = gameData.customQuizzes[quiz.theme].concat(quiz.questions);
                });

                showNotification('–ó–∞–≥—Ä—É–∂–µ–Ω–æ', '–î–æ—Å—Ç—É–ø–Ω—ã –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å—Å–∫–∏–µ –æ–ø—Ä–æ—Å—ã', '#00ff9d');
            } catch (error) {
                console.error('–û—à–∏–±–∫–∞ –∑–∞–≥—Ä—É–∑–∫–∏ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å—Å–∫–∏—Ö –æ–ø—Ä–æ—Å–æ–≤:', error);
            }
        }

        // –û—Ç–æ–±—Ä–∞–∑–∏—Ç—å –æ–ø—Ä–æ—Å—ã –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è
        function displayUserQuizzes(quizzes) {
            const container = document.getElementById('userQuizzesList');

            if (quizzes.length === 0) {
                container.innerHTML = `
                    <div style="text-align: center; color: #aaa; padding: 40px; grid-column: 1 / -1;">
                        <i class="fas fa-book" style="font-size: 3rem; margin-bottom: 15px; opacity: 0.5;"></i>
                        <p>–£ –≤–∞—Å –ø–æ–∫–∞ –Ω–µ—Ç —Å–æ—Ö—Ä–∞–Ω–µ–Ω–Ω—ã—Ö –æ–ø—Ä–æ—Å–æ–≤</p>
                        <p style="font-size: 0.9rem; margin-top: 10px;">–°–æ–∑–¥–∞–π—Ç–µ —Å–≤–æ–π –ø–µ—Ä–≤—ã–π –æ–ø—Ä–æ—Å!</p>
                    </div>
                `;
                return;
            }

            container.innerHTML = quizzes.map(quiz => `
                <div class="quiz-card">
                    <div class="quiz-title">${quiz.title}</div>
                    <div style="color: #aaa; font-size: 0.9rem;">
                        ${quiz.description || '–ë–µ–∑ –æ–ø–∏—Å–∞–Ω–∏—è'}
                    </div>
                    <div class="quiz-stats">
                        <span><i class="fas fa-question-circle"></i> ${quiz.questions.length} –≤–æ–ø—Ä–æ—Å–æ–≤</span>
                        <span><i class="fas fa-play-circle"></i> ${quiz.playCount || 0} –∏–≥—Ä</span>
                        <span><i class="fas fa-star"></i> ${quiz.rating || 0}/5</span>
                        <span><i class="fas fa-globe"></i> ${quiz.isPublished ? '–û–ø—É–±–ª–∏–∫–æ–≤–∞–Ω' : '–õ–∏—á–Ω—ã–π'}</span>
                    </div>
                    <div class="quiz-actions">
                        <button class="quiz-action-btn" onclick="useQuizInGame('${quiz.theme}', '${quiz.id}')">
                            <i class="fas fa-play"></i> –ò—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å
                        </button>
                        <button class="quiz-action-btn" onclick="deleteQuiz('${quiz.id}')" style="border-color: #ff0000;">
                            <i class="fas fa-trash"></i> –£–¥–∞–ª–∏—Ç—å
                        </button>
                    </div>
                </div>
            `).join('');
        }

        // –ò—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å –æ–ø—Ä–æ—Å –≤ –∏–≥—Ä–µ (–≥–ª–æ–±–∞–ª—å–Ω–∞—è —Ñ—É–Ω–∫—Ü–∏—è)
        window.useQuizInGame = function(theme, quizId) {
            if (!gameData.roomId || !gameData.isHost) {
                showNotification('–û—à–∏–±–∫–∞', '–í—ã –¥–æ–ª–∂–Ω—ã –±—ã—Ç—å —Ö–æ—Å—Ç–æ–º –∫–æ–º–Ω–∞—Ç—ã', '#ff0000');
                return;
            }

            // –ó–∞–≥—Ä—É–∂–∞–µ–º –æ–ø—Ä–æ—Å –∏–∑ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å—Å–∫–∏—Ö
            const quiz = gameData.userQuizzes.find(q => q.id === quizId);
            if (quiz) {
                // –î–æ–±–∞–≤–ª—è–µ–º –≤–æ–ø—Ä–æ—Å—ã –≤ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å—Å–∫–∏–µ –æ–ø—Ä–æ—Å—ã –¥–ª—è —Ç–µ–∫—É—â–µ–π —Ç–µ–º—ã
                if (!gameData.customQuizzes[theme]) {
                    gameData.customQuizzes[theme] = [];
                }
                gameData.customQuizzes[theme] = quiz.questions;

                // –ú–µ–Ω—è–µ–º —Ç–µ–º—É –Ω–∞ –Ω—É–∂–Ω—É—é
                database.ref('rooms/' + gameData.roomId).update({
                    theme: theme
                });

                showNotification('–£—Å–ø–µ—Ö!', `–û–ø—Ä–æ—Å "${quiz.title}" –±—É–¥–µ—Ç –∏—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å—Å—è –≤ –∏–≥—Ä–µ`, '#00ff9d');
            }
        };

        // –£–¥–∞–ª–∏—Ç—å –æ–ø—Ä–æ—Å (–≥–ª–æ–±–∞–ª—å–Ω–∞—è —Ñ—É–Ω–∫—Ü–∏—è)
        window.deleteQuiz = function(quizId) {
            if (confirm('–í—ã —É–≤–µ—Ä–µ–Ω—ã, —á—Ç–æ —Ö–æ—Ç–∏—Ç–µ —É–¥–∞–ª–∏—Ç—å —ç—Ç–æ—Ç –æ–ø—Ä–æ—Å?')) {
                database.ref('userQuizzes/' + gameData.user.uid + '/' + quizId).remove()
                    .then(() => {
                        showNotification('–£—Å–ø–µ—Ö', '–û–ø—Ä–æ—Å —É–¥–∞–ª–µ–Ω', '#00ff9d');
                        loadUserQuizzes();
                    })
                    .catch(error => {
                        showNotification('–û—à–∏–±–∫–∞', '–ù–µ —É–¥–∞–ª–æ—Å—å —É–¥–∞–ª–∏—Ç—å –æ–ø—Ä–æ—Å', '#ff0000');
                    });
            }
        };

        // –£–≤–µ–¥–æ–º–ª–µ–Ω–∏—è
        function showNotification(title, text, color = '#00f3ff') {
            const notification = document.getElementById('notification');
            document.getElementById('notificationTitle').textContent = title;
            document.getElementById('notificationText').textContent = text;
            notification.style.borderColor = color;

            notification.style.display = 'block';

            setTimeout(() => {
                notification.style.display = 'none';
            }, 3000);
        }

        // –ü–æ–ª—É—á–∏—Ç—å –Ω–∞–∑–≤–∞–Ω–∏–µ —Ç–µ–º—ã
        function getThemeName(themeKey) {
            const themeNames = {
                'general': '–û–±—â–∞—è',
                'science': '–ù–∞—É–∫–∞',
                'history': '–ò—Å—Ç–æ—Ä–∏—è',
                'geography': '–ì–µ–æ–≥—Ä–∞—Ñ–∏—è',
                'entertainment': '–ö–∏–Ω–æ –∏ –º—É–∑—ã–∫–∞',
                'sports': '–°–ø–æ—Ä—Ç',
                'games': '–ò–≥—Ä—ã',
                'custom': '–°–≤–æ—è —Ç–µ–º–∞'
            };

            return themeNames[themeKey] || '–û–±—â–∞—è';
        }

        // –§—É–Ω–∫—Ü–∏–∏ –¥–ª—è –∫–æ–ø–∏—Ä–æ–≤–∞–Ω–∏—è –∏ —à–∞—Ä–∏–Ω–≥–∞ –∫–æ–¥–∞ –∫–æ–º–Ω–∞—Ç—ã
        window.copyRoomCode = function() {
            const code = document.getElementById('roomCode').textContent;
            navigator.clipboard.writeText(code).then(() => {
                showNotification('–°–∫–æ–ø–∏—Ä–æ–≤–∞–Ω–æ!', '–ö–æ–¥ –∫–æ–º–Ω–∞—Ç—ã —Å–∫–æ–ø–∏—Ä–æ–≤–∞–Ω –≤ –±—É—Ñ–µ—Ä –æ–±–º–µ–Ω–∞', '#00ff9d');
            });
        };

        window.shareRoomCode = function() {
            const code = document.getElementById('roomCode').textContent;
            if (navigator.share) {
                navigator.share({
                    title: '–ü—Ä–∏—Å–æ–µ–¥–∏–Ω—è–π—Ç–µ—Å—å –∫ Neon Quiz Battle!',
                    text: `–ò–≥—Ä–∞–π—Ç–µ —Å–æ –º–Ω–æ–π –≤ Neon Quiz Battle! –ö–æ–¥ –∫–æ–º–Ω–∞—Ç—ã: ${code}`,
                    url: window.location.href
                });
            } else {
                copyRoomCode();
            }
        };

        // –û—á–∏—Å—Ç–∫–∞ —Å—Ç–∞—Ä—ã—Ö –∫–æ–º–Ω–∞—Ç
        setInterval(() => {
            if (!gameData.isHost) return;

            database.ref('rooms').once('value').then(snapshot => {
                const rooms = snapshot.val() || {};
                const now = Date.now();

                Object.keys(rooms).forEach(roomId => {
                    if (now - rooms[roomId].createdAt > 3600000) { // 1 —á–∞—Å
                        database.ref('rooms/' + roomId).remove();
                    }
                });
            });
        }, 600000);

        // –ü—Ä–æ–≤–µ—Ä–∫–∞ –∞–∫—Ç–∏–≤–Ω–æ—Å—Ç–∏ –∏–≥—Ä–æ–∫–æ–≤
        setInterval(() => {
            if (!gameData.roomId || !gameData.playerId) return;

            // –û–±–Ω–æ–≤–ª—è–µ–º –≤—Ä–µ–º—è –∞–∫—Ç–∏–≤–Ω–æ—Å—Ç–∏
            database.ref('rooms/' + gameData.roomId + '/players/' + gameData.playerId).update({
                lastActive: Date.now()
            });

            // –ï—Å–ª–∏ —Ö–æ—Å—Ç, –ø—Ä–æ–≤–µ—Ä—è–µ–º –Ω–µ–∞–∫—Ç–∏–≤–Ω—ã—Ö –∏–≥—Ä–æ–∫–æ–≤
            if (gameData.isHost) {
                const now = Date.now();
                Object.keys(gameData.players).forEach(playerId => {
                    const player = gameData.players[playerId];
                    if (playerId !== gameData.playerId && now - player.lastActive > 30000) { // 30 —Å–µ–∫—É–Ω–¥
                        // –£–¥–∞–ª—è–µ–º –Ω–µ–∞–∫—Ç–∏–≤–Ω–æ–≥–æ –∏–≥—Ä–æ–∫–∞
                        database.ref('rooms/' + gameData.roomId + '/players/' + playerId).remove();
                        showNotification('–ò–≥—Ä–æ–∫ –æ—Ç–∫–ª—é—á–µ–Ω', `${player.name} –±—ã–ª –æ—Ç–∫–ª—é—á–µ–Ω –∑–∞ –Ω–µ–∞–∫—Ç–∏–≤–Ω–æ—Å—Ç—å`);
                    }
                });
            }
        }, 10000);
    </script>
</body>
</html>